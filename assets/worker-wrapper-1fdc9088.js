class ls{constructor(){this._listeners={}}addEventListener(e,r){const n=this._listeners;return n[e]===void 0&&(n[e]=[]),n[e].indexOf(r)===-1&&n[e].push(r),this}removeEventListener(e,r){if(this._listeners===void 0)return this;const s=this._listeners[e];if(s!==void 0){const i=s.indexOf(r);i!==-1&&s.splice(i,1)}return this}dispatchEvent(e){if(this._listeners===void 0)return this;const n=this._listeners[e.type];if(n!==void 0){const s=n.slice(0);for(let i=0,a=s.length;i<a;i++)s[i].call(this,e)}return this}dispose(){for(const e in this._listeners)delete this._listeners[e]}}class rr extends ls{constructor(e,r,n,s={}){if(super(),this._name=void 0,this._parent=void 0,this._child=void 0,this._attributes=void 0,this._disposed=!1,this._name=e,this._parent=r,this._child=n,this._attributes=s,!r.isOnGraph(n))throw new Error("Cannot connect disconnected graphs.")}getName(){return this._name}getParent(){return this._parent}getChild(){return this._child}setChild(e){return this._child=e,this}getAttributes(){return this._attributes}dispose(){this._disposed||(this._disposed=!0,this.dispatchEvent({type:"dispose",target:this}),super.dispose())}isDisposed(){return this._disposed}}class pf extends ls{constructor(...e){super(...e),this._emptySet=new Set,this._edges=new Set,this._parentEdges=new Map,this._childEdges=new Map}listEdges(){return Array.from(this._edges)}listParentEdges(e){return Array.from(this._childEdges.get(e)||this._emptySet)}listParents(e){return this.listParentEdges(e).map(r=>r.getParent())}listChildEdges(e){return Array.from(this._parentEdges.get(e)||this._emptySet)}listChildren(e){return this.listChildEdges(e).map(r=>r.getChild())}disconnectParents(e,r){let n=this.listParentEdges(e);return r&&(n=n.filter(s=>r(s.getParent()))),n.forEach(s=>s.dispose()),this}createEdge(e,r,n,s){return this._registerEdge(new rr(e,r,n,s))}_registerEdge(e){this._edges.add(e);const r=e.getParent();this._parentEdges.has(r)||this._parentEdges.set(r,new Set),this._parentEdges.get(r).add(e);const n=e.getChild();return this._childEdges.has(n)||this._childEdges.set(n,new Set),this._childEdges.get(n).add(e),e.addEventListener("dispose",()=>this._removeEdge(e)),e}_removeEdge(e){return this._edges.delete(e),this._parentEdges.get(e.getParent()).delete(e),this._childEdges.get(e.getChild()).delete(e),this}}function Ir(){return Ir=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ir.apply(this,arguments)}function Hn(t){return t instanceof rr}function yr(t){return Array.isArray(t)&&t[0]instanceof rr}function Tr(t){return!!(df(t)&&gf(t)instanceof rr)}function gf(t){for(const e in t)return t[e]}function df(t){return!!t&&Object.getPrototypeOf(t)===Object.prototype}const ce=Symbol("attributes"),Zt=Symbol("immutableKeys");class fs extends ls{constructor(e){super(),this._disposed=!1,this.graph=void 0,this[ce]=void 0,this[Zt]=void 0,this.graph=e,this[Zt]=new Set,this[ce]=this._createAttributes()}getDefaults(){return{}}_createAttributes(){const e=this.getDefaults(),r={};for(const n in e){const s=e[n];if(s instanceof fs){const i=this.graph.createEdge(n,this,s);i.addEventListener("dispose",()=>s.dispose()),this[Zt].add(n),r[n]=i}else r[n]=s}return r}isOnGraph(e){return this.graph===e.graph}isDisposed(){return this._disposed}dispose(){this._disposed||(this.graph.listChildEdges(this).forEach(e=>e.dispose()),this.graph.disconnectParents(this),this._disposed=!0,this.dispatchEvent({type:"dispose"}))}detach(){return this.graph.disconnectParents(this),this}swap(e,r){for(const n in this[ce]){const s=this[ce][n];if(Hn(s)){const i=s;i.getChild()===e&&this.setRef(n,r,i.getAttributes())}else if(yr(s)){const a=s.find(o=>o.getChild()===e);if(a){const o=a.getAttributes();this.removeRef(n,e).addRef(n,r,o)}}else if(Tr(s)){const i=s;for(const a in i){const o=i[a];o.getChild()===e&&this.setRefMap(n,a,r,o.getAttributes())}}}return this}get(e){return this[ce][e]}set(e,r){return this[ce][e]=r,this.dispatchEvent({type:"change",attribute:e})}getRef(e){const r=this[ce][e];return r?r.getChild():null}setRef(e,r,n){if(this[Zt].has(e))throw new Error(`Cannot overwrite immutable attribute, "${e}".`);const s=this[ce][e];if(s&&s.dispose(),!r)return this;const i=this.graph.createEdge(e,this,r,n);return i.addEventListener("dispose",()=>{delete this[ce][e],this.dispatchEvent({type:"change",attribute:e})}),this[ce][e]=i,this.dispatchEvent({type:"change",attribute:e})}listRefs(e){return this[ce][e].map(n=>n.getChild())}addRef(e,r,n){const s=this.graph.createEdge(e,this,r,n),i=this[ce][e];return i.push(s),s.addEventListener("dispose",()=>{let a;for(;(a=i.indexOf(s))!==-1;)i.splice(a,1);this.dispatchEvent({type:"change",attribute:e})}),this.dispatchEvent({type:"change",attribute:e})}removeRef(e,r){return this[ce][e].filter(i=>i.getChild()===r).forEach(i=>i.dispose()),this}listRefMapKeys(e){return Object.keys(this[ce][e])}listRefMapValues(e){return Object.values(this[ce][e]).map(r=>r.getChild())}getRefMap(e,r){const n=this[ce][e];return n[r]?n[r].getChild():null}setRefMap(e,r,n,s){const i=this[ce][e],a=i[r];if(a&&a.dispose(),!n)return this;s=Object.assign(s||{},{key:r});const o=this.graph.createEdge(e,this,n,Ir({},s,{key:r}));return o.addEventListener("dispose",()=>{delete i[r],this.dispatchEvent({type:"change",attribute:e,key:r})}),i[r]=o,this.dispatchEvent({type:"change",attribute:e,key:r})}dispatchEvent(e){return super.dispatchEvent(Ir({},e,{target:this})),this.graph.dispatchEvent(Ir({},e,{target:this,type:`node:${e.type}`})),this}}const qi="v3.8.0",nr="@glb.bin";var G,sn,Ge,tt,Lt;(function(t){t.ACCESSOR="Accessor",t.ANIMATION="Animation",t.ANIMATION_CHANNEL="AnimationChannel",t.ANIMATION_SAMPLER="AnimationSampler",t.BUFFER="Buffer",t.CAMERA="Camera",t.MATERIAL="Material",t.MESH="Mesh",t.PRIMITIVE="Primitive",t.PRIMITIVE_TARGET="PrimitiveTarget",t.NODE="Node",t.ROOT="Root",t.SCENE="Scene",t.SKIN="Skin",t.TEXTURE="Texture",t.TEXTURE_INFO="TextureInfo"})(G||(G={})),function(t){t.INTERLEAVED="interleaved",t.SEPARATE="separate"}(sn||(sn={})),function(t){t.ARRAY_BUFFER="ARRAY_BUFFER",t.ELEMENT_ARRAY_BUFFER="ELEMENT_ARRAY_BUFFER",t.INVERSE_BIND_MATRICES="INVERSE_BIND_MATRICES",t.OTHER="OTHER",t.SPARSE="SPARSE"}(Ge||(Ge={})),function(t){t[t.R=4096]="R",t[t.G=256]="G",t[t.B=16]="B",t[t.A=1]="A"}(tt||(tt={})),function(t){t.GLTF="GLTF",t.GLB="GLB"}(Lt||(Lt={}));const an={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};var Wr,Wn=typeof Float32Array<"u"?Float32Array:Array;function Ln(t){return Math.hypot(t[0],t[1],t[2])}function mf(t,e,r){var n=e[0],s=e[1],i=e[2],a=r[3]*n+r[7]*s+r[11]*i+r[15];return t[0]=(r[0]*n+r[4]*s+r[8]*i+r[12])/(a=a||1),t[1]=(r[1]*n+r[5]*s+r[9]*i+r[13])/a,t[2]=(r[2]*n+r[6]*s+r[10]*i+r[14])/a,t}function vf(t){const e={min:[1/0,1/0,1/0],max:[-1/0,-1/0,-1/0]},r=t.propertyType===G.NODE?[t]:t.listChildren();for(const n of r)n.traverse(s=>{const i=s.getMesh();if(!i)return;const a=xf(i,s.getWorldMatrix());Xn(a.min,e),Xn(a.max,e)});return e}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),Wr=new Wn(3),Wn!=Float32Array&&(Wr[0]=0,Wr[1]=0,Wr[2]=0);function xf(t,e){const r={min:[1/0,1/0,1/0],max:[-1/0,-1/0,-1/0]};for(const n of t.listPrimitives()){const s=n.getAttribute("POSITION");if(!s)continue;let i=[0,0,0],a=[0,0,0];for(let o=0;o<s.getCount();o++)i=s.getElement(o,i),a=mf(a,i,e),Xn(a,r)}return r}function Xn(t,e){for(let r=0;r<3;r++)e.min[r]=Math.min(t[r],e.min[r]),e.max[r]=Math.max(t[r],e.max[r])}class Q{static createBufferFromDataURI(e){if(typeof Buffer>"u"){const r=atob(e.split(",")[1]),n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}{const r=e.split(",")[1],n=e.indexOf("base64")>=0;return Buffer.from(r,n?"base64":"utf8")}}static encodeText(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Buffer.from(e)}static decodeText(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Buffer.from(e).toString("utf8")}static concat(e){let r=0;for(const i of e)r+=i.byteLength;const n=new Uint8Array(r);let s=0;for(const i of e)n.set(i,s),s+=i.byteLength;return n}static pad(e,r=0){const n=this.padNumber(e.byteLength);if(n===e.byteLength)return e;const s=new Uint8Array(n);if(s.set(e),r!==0)for(let i=e.byteLength;i<n;i++)s[i]=r;return s}static padNumber(e){return 4*Math.ceil(e/4)}static equals(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;let n=e.byteLength;for(;n--;)if(e[n]!==r[n])return!1;return!0}static toView(e,r=0,n=1/0){return new Uint8Array(e.buffer,e.byteOffset+r,Math.min(e.byteLength,n))}static assertView(e){if(e&&!ArrayBuffer.isView(e))throw new Error(`Method requires Uint8Array parameter; received "${typeof e}".`);return e}}let Ve=class{static hexToFactor(e,r){e=Math.floor(e);const n=r;return n[0]=(e>>16&255)/255,n[1]=(e>>8&255)/255,n[2]=(255&e)/255,this.convertSRGBToLinear(r,r)}static factorToHex(e){const r=[...e],[n,s,i]=this.convertLinearToSRGB(e,r);return 255*n<<16^255*s<<8^255*i<<0}static convertSRGBToLinear(e,r){const n=e,s=r;for(let i=0;i<3;i++)s[i]=n[i]<.04045?.0773993808*n[i]:Math.pow(.9478672986*n[i]+.0521327014,2.4);return r}static convertLinearToSRGB(e,r){const n=e,s=r;for(let i=0;i<3;i++)s[i]=n[i]<.0031308?12.92*n[i]:1.055*Math.pow(n[i],.41666)-.055;return r}},Hi=class Wi{match(e){return e.length>=8&&e[0]===137&&e[1]===80&&e[2]===78&&e[3]===71&&e[4]===13&&e[5]===10&&e[6]===26&&e[7]===10}getSize(e){const r=new DataView(e.buffer,e.byteOffset);return Q.decodeText(e.slice(12,16))===Wi.PNG_FRIED_CHUNK_NAME?[r.getUint32(32,!1),r.getUint32(36,!1)]:[r.getUint32(16,!1),r.getUint32(20,!1)]}getChannels(e){return 4}};Hi.PNG_FRIED_CHUNK_NAME="CgBI";let ct=class{static registerFormat(e,r){this.impls[e]=r}static getMimeType(e){for(const r in this.impls)if(this.impls[r].match(e))return r;return null}static getSize(e,r){return this.impls[r]?this.impls[r].getSize(e):null}static getChannels(e,r){return this.impls[r]?this.impls[r].getChannels(e):null}static getVRAMByteLength(e,r){if(!this.impls[r])return null;if(this.impls[r].getVRAMByteLength)return this.impls[r].getVRAMByteLength(e);let n=0;const s=this.getSize(e,r);if(!s)return null;for(;s[0]>1||s[1]>1;)n+=s[0]*s[1]*4,s[0]=Math.max(Math.floor(s[0]/2),1),s[1]=Math.max(Math.floor(s[1]/2),1);return n+=4,n}static mimeTypeToExtension(e){return e==="image/jpeg"?"jpg":e.split("/").pop()}static extensionToMimeType(e){return e==="jpg"?"image/jpeg":e?`image/${e}`:""}};function yf(t,e){if(e>t.byteLength)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(t.getUint8(e)!==255)throw new TypeError("Invalid JPG, marker table corrupted");return t}ct.impls={"image/jpeg":new class{match(t){return t.length>=3&&t[0]===255&&t[1]===216&&t[2]===255}getSize(t){let e,r,n=new DataView(t.buffer,t.byteOffset+4);for(;n.byteLength;){if(e=n.getUint16(0,!1),yf(n,e),r=n.getUint8(e+1),r===192||r===193||r===194)return[n.getUint16(e+7,!1),n.getUint16(e+5,!1)];n=new DataView(t.buffer,n.byteOffset+e+2)}throw new TypeError("Invalid JPG, no size found")}getChannels(t){return 3}},"image/png":new Hi};let sr=class{static basename(e){const r=e.split(/[\\/]/).pop();return r.substring(0,r.lastIndexOf("."))}static extension(e){if(e.startsWith("data:image/")){const r=e.match(/data:(image\/\w+)/)[1];return ct.mimeTypeToExtension(r)}return e.startsWith("data:model/gltf+json")?"gltf":e.startsWith("data:model/gltf-binary")?"glb":e.startsWith("data:application/")?"bin":e.split(/[\\/]/).pop().split(/[.]/).pop()}};function di(t){return Object.prototype.toString.call(t)==="[object Object]"}function Pt(t){if(di(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return di(r)!==!1&&Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")!==!1}var Bn,Yn;(function(t){t[t.SILENT=4]="SILENT",t[t.ERROR=3]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=1]="INFO",t[t.DEBUG=0]="DEBUG"})(Yn||(Yn={}));let Bt=class Mr{constructor(e){this.verbosity=void 0,this.verbosity=e}debug(e){this.verbosity<=Mr.Verbosity.DEBUG&&console.debug(e)}info(e){this.verbosity<=Mr.Verbosity.INFO&&console.info(e)}warn(e){this.verbosity<=Mr.Verbosity.WARN&&console.warn(e)}error(e){this.verbosity<=Mr.Verbosity.ERROR&&console.error(e)}};function Tf(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],d=e[8],m=e[9],x=e[10],M=e[11],w=e[12],p=e[13],R=e[14],g=e[15],y=r[0],T=r[1],I=r[2],_=r[3];return t[0]=y*n+T*o+I*d+_*w,t[1]=y*s+T*c+I*m+_*p,t[2]=y*i+T*u+I*x+_*R,t[3]=y*a+T*h+I*M+_*g,t[4]=(y=r[4])*n+(T=r[5])*o+(I=r[6])*d+(_=r[7])*w,t[5]=y*s+T*c+I*m+_*p,t[6]=y*i+T*u+I*x+_*R,t[7]=y*a+T*h+I*M+_*g,t[8]=(y=r[8])*n+(T=r[9])*o+(I=r[10])*d+(_=r[11])*w,t[9]=y*s+T*c+I*m+_*p,t[10]=y*i+T*u+I*x+_*R,t[11]=y*a+T*h+I*M+_*g,t[12]=(y=r[12])*n+(T=r[13])*o+(I=r[14])*d+(_=r[15])*w,t[13]=y*s+T*c+I*m+_*p,t[14]=y*i+T*u+I*x+_*R,t[15]=y*a+T*h+I*M+_*g,t}Bn=Bt,Bt.Verbosity=Yn,Bt.DEFAULT_INSTANCE=new Bn(Bn.Verbosity.INFO);let ve=class Kn{static identity(e){return e}static eq(e,r,n=1e-5){if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(Math.abs(e[s]-r[s])>n)return!1;return!0}static decodeNormalizedInt(e,r){switch(r){case 5126:return e;case 5123:return e/65535;case 5121:return e/255;case 5122:return Math.max(e/32767,-1);case 5120:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}static denormalize(e,r){return Kn.decodeNormalizedInt(e,r)}static encodeNormalizedInt(e,r){switch(r){case 5126:return e;case 5123:return Math.round(65535*e);case 5121:return Math.round(255*e);case 5122:return Math.round(32767*e);case 5120:return Math.round(127*e);default:throw new Error("Invalid component type.")}}static normalize(e,r){return Kn.encodeNormalizedInt(e,r)}static decompose(e,r,n,s){let i=Ln([e[0],e[1],e[2]]);const a=Ln([e[4],e[5],e[6]]),o=Ln([e[8],e[9],e[10]]);var c,u,h,d,m,x,M,w,p,R,g,y,T,I,_,U,$;((u=(c=e)[0])*(M=c[5])-(h=c[1])*(x=c[4]))*((y=c[10])*($=c[15])-(T=c[11])*(U=c[14]))-(u*(w=c[6])-(d=c[2])*x)*((g=c[9])*$-T*(_=c[13]))+(u*(p=c[7])-(m=c[3])*x)*(g*U-y*_)+(h*w-d*M)*((R=c[8])*$-T*(I=c[12]))-(h*p-m*M)*(R*U-y*I)+(d*p-m*w)*(R*_-g*I)<0&&(i=-i),r[0]=e[12],r[1]=e[13],r[2]=e[14];const C=e.slice(),j=1/i,V=1/a,q=1/o;C[0]*=j,C[1]*=j,C[2]*=j,C[4]*=V,C[5]*=V,C[6]*=V,C[8]*=q,C[9]*=q,C[10]*=q,function(L,D){var X=new Wn(3);(function(je,Be){var vt=Be[4],rt=Be[5],xt=Be[6],Gt=Be[8],Pr=Be[9],Mn=Be[10];je[0]=Math.hypot(Be[0],Be[1],Be[2]),je[1]=Math.hypot(vt,rt,xt),je[2]=Math.hypot(Gt,Pr,Mn)})(X,D);var te=1/X[0],J=1/X[1],ie=1/X[2],re=D[0]*te,ae=D[1]*J,oe=D[2]*ie,le=D[4]*te,Ae=D[5]*J,ue=D[6]*ie,de=D[8]*te,be=D[9]*J,Fe=D[10]*ie,dt=re+Ae+Fe,he=0;dt>0?(he=2*Math.sqrt(dt+1),L[3]=.25*he,L[0]=(ue-be)/he,L[1]=(de-oe)/he,L[2]=(ae-le)/he):re>Ae&&re>Fe?(he=2*Math.sqrt(1+re-Ae-Fe),L[3]=(ue-be)/he,L[0]=.25*he,L[1]=(ae+le)/he,L[2]=(de+oe)/he):Ae>Fe?(he=2*Math.sqrt(1+Ae-re-Fe),L[3]=(de-oe)/he,L[0]=(ae+le)/he,L[1]=.25*he,L[2]=(ue+be)/he):(he=2*Math.sqrt(1+Fe-re-Ae),L[3]=(ae-le)/he,L[0]=(de+oe)/he,L[1]=(ue+be)/he,L[2]=.25*he)}(n,C),s[0]=i,s[1]=a,s[2]=o}static compose(e,r,n,s){const i=s,a=r[0],o=r[1],c=r[2],u=r[3],h=a+a,d=o+o,m=c+c,x=a*h,M=a*d,w=a*m,p=o*d,R=o*m,g=c*m,y=u*h,T=u*d,I=u*m,_=n[0],U=n[1],$=n[2];return i[0]=(1-(p+g))*_,i[1]=(M+I)*_,i[2]=(w-T)*_,i[3]=0,i[4]=(M-I)*U,i[5]=(1-(x+g))*U,i[6]=(R+y)*U,i[7]=0,i[8]=(w+T)*$,i[9]=(R-y)*$,i[10]=(1-(x+p))*$,i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i}};function Mf(t,e){if(!!t!=!!e)return!1;const r=t.getChild(),n=e.getChild();return r===n||r.equals(n)}function Ef(t,e){if(!!t!=!!e||t.length!==e.length)return!1;for(let r=0;r<t.length;r++){const n=t[r],s=e[r];if(n.getChild()!==s.getChild()&&!n.getChild().equals(s.getChild()))return!1}return!0}function Rf(t,e){if(!!t!=!!e)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(const s in t){const i=t[s],a=e[s];if(!!i!=!!a)return!1;const o=i.getChild(),c=a.getChild();if(o!==c&&!o.equals(c))return!1}return!0}function Xi(t,e){if(t===e)return!0;if(!!t!=!!e||!t||!e||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Yi(t,e){if(t===e)return!0;if(!!t!=!!e)return!1;if(!Pt(t)||!Pt(e))return t===e;const r=t,n=e;let s,i=0,a=0;for(s in r)i++;for(s in n)a++;if(i!==a)return!1;for(s in r){const o=r[s],c=n[s];if(on(o)&&on(c)){if(!Xi(o,c))return!1}else if(Pt(o)&&Pt(c)){if(!Yi(o,c))return!1}else if(o!==c)return!1}return!0}function on(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const mi=new Set,wf=function(){let t="";for(let e=0;e<6;e++)t+="23456789abdegjkmnpqrvwxyzABDEGJKMNPQRVWXYZ".charAt(Math.floor(42*Math.random()));return t},If=function(){for(let t=0;t<999;t++){const e=wf();if(!mi.has(e))return mi.add(e),e}return""},vi="https://null.example";let Ar=class{static dirname(e){const r=e.lastIndexOf("/");return r===-1?"./":e.substring(0,r+1)}static basename(e){return sr.basename(new URL(e,vi).pathname)}static extension(e){return sr.extension(new URL(e,vi).pathname)}static resolve(e,r){if(!this.isRelativePath(r))return r;const n=e.split("/"),s=r.split("/");n.pop();for(let i=0;i<s.length;i++)s[i]!=="."&&(s[i]===".."?n.pop():n.push(s[i]));return n.join("/")}static isAbsoluteURL(e){return this.PROTOCOL_REGEXP.test(e)}static isRelativePath(e){return!/^(?:[a-zA-Z]+:)?\//.test(e)}};Ar.DEFAULT_INIT={},Ar.PROTOCOL_REGEXP=/^[a-zA-Z]+:\/\//;const gt=t=>t,Af=new Set;let us=class extends fs{constructor(e,r=""){super(e),this[ce].name=r,this.init(),this.dispatchEvent({type:"create"})}getGraph(){return this.graph}getDefaults(){return Object.assign(super.getDefaults(),{name:"",extras:{}})}set(e,r){return Array.isArray(r)&&(r=r.slice()),super.set(e,r)}getName(){return this.get("name")}setName(e){return this.set("name",e)}getExtras(){return this.get("extras")}setExtras(e){return this.set("extras",e)}clone(){return new this.constructor(this.graph).copy(this,gt)}copy(e,r=gt){for(const n in this[ce]){const s=this[ce][n];if(s instanceof rr)this[Zt].has(n)||s.dispose();else if(yr(s))for(const i of s)i.dispose();else if(Tr(s))for(const i in s)s[i].dispose()}for(const n in e[ce]){const s=this[ce][n],i=e[ce][n];if(i instanceof rr)this[Zt].has(n)?s.getChild().copy(r(i.getChild()),r):this.setRef(n,r(i.getChild()),i.getAttributes());else if(yr(i))for(const a of i)this.addRef(n,r(a.getChild()),a.getAttributes());else if(Tr(i))for(const a in i){const o=i[a];this.setRefMap(n,a,r(o.getChild()),o.getAttributes())}else this[ce][n]=Pt(i)?JSON.parse(JSON.stringify(i)):Array.isArray(i)||i instanceof ArrayBuffer||ArrayBuffer.isView(i)?i.slice():i}return this}equals(e,r=Af){if(this===e)return!0;if(this.propertyType!==e.propertyType)return!1;for(const n in this[ce]){if(r.has(n))continue;const s=this[ce][n],i=e[ce][n];if(Hn(s)||Hn(i)){if(!Mf(s,i))return!1}else if(yr(s)||yr(i)){if(!Ef(s,i))return!1}else if(Tr(s)||Tr(i)){if(!Rf(s,i))return!1}else if(Pt(s)||Pt(i)){if(!Yi(s,i))return!1}else if(on(s)||on(i)){if(!Xi(s,i))return!1}else if(s!==i)return!1}return!0}detach(){return this.graph.disconnectParents(this,e=>e.propertyType!=="Root"),this}listParents(){return this.graph.listParents(this)}},Le=class extends us{getDefaults(){return Object.assign(super.getDefaults(),{extensions:{}})}getExtension(e){return this.getRefMap("extensions",e)}setExtension(e,r){return r&&r.t(this),this.setRefMap("extensions",e,r)}listExtensions(){return this.listRefMapValues("extensions")}},Y=class pe extends Le{constructor(...e){super(...e),this.i=ve.identity,this.o=ve.identity}init(){this.propertyType=G.ACCESSOR}getDefaults(){return Object.assign(super.getDefaults(),{array:null,type:pe.Type.SCALAR,componentType:pe.ComponentType.FLOAT,normalized:!1,sparse:!1,buffer:null})}copy(e,r=gt){return super.copy(e,r),this.i=e.i,this.o=e.o,this}static getElementSize(e){switch(e){case pe.Type.SCALAR:return 1;case pe.Type.VEC2:return 2;case pe.Type.VEC3:return 3;case pe.Type.VEC4:case pe.Type.MAT2:return 4;case pe.Type.MAT3:return 9;case pe.Type.MAT4:return 16;default:throw new Error("Unexpected type: "+e)}}static getComponentSize(e){switch(e){case pe.ComponentType.BYTE:case pe.ComponentType.UNSIGNED_BYTE:return 1;case pe.ComponentType.SHORT:case pe.ComponentType.UNSIGNED_SHORT:return 2;case pe.ComponentType.UNSIGNED_INT:case pe.ComponentType.FLOAT:return 4;default:throw new Error("Unexpected component type: "+e)}}getMinNormalized(e){const r=this.getElementSize();this.getMin(e);for(let n=0;n<r;n++)e[n]=this.o(e[n]);return e}getMin(e){const r=this.get("array"),n=this.getCount(),s=this.getElementSize();for(let i=0;i<s;i++)e[i]=1/0;for(let i=0;i<n*s;i+=s)for(let a=0;a<s;a++){const o=r[i+a];Number.isFinite(o)&&(e[a]=Math.min(e[a],o))}return e}getMaxNormalized(e){const r=this.getElementSize();this.getMax(e);for(let n=0;n<r;n++)e[n]=this.o(e[n]);return e}getMax(e){const r=this.get("array"),n=this.getCount(),s=this.getElementSize();for(let i=0;i<s;i++)e[i]=-1/0;for(let i=0;i<n*s;i+=s)for(let a=0;a<s;a++){const o=r[i+a];Number.isFinite(o)&&(e[a]=Math.max(e[a],o))}return e}getCount(){const e=this.get("array");return e?e.length/this.getElementSize():0}getType(){return this.get("type")}setType(e){return this.set("type",e)}getElementSize(){return pe.getElementSize(this.get("type"))}getComponentSize(){return this.get("array").BYTES_PER_ELEMENT}getComponentType(){return this.get("componentType")}getNormalized(){return this.get("normalized")}setNormalized(e){return this.set("normalized",e),e?(this.o=r=>ve.decodeNormalizedInt(r,this.get("componentType")),this.i=r=>ve.encodeNormalizedInt(r,this.get("componentType"))):(this.o=ve.identity,this.i=ve.identity),this}getScalar(e){const r=this.getElementSize();return this.o(this.get("array")[e*r])}setScalar(e,r){return this.get("array")[e*this.getElementSize()]=this.i(r),this}getElement(e,r){const n=this.getElementSize(),s=this.get("array");for(let i=0;i<n;i++)r[i]=this.o(s[e*n+i]);return r}setElement(e,r){const n=this.getElementSize(),s=this.get("array");for(let i=0;i<n;i++)s[e*n+i]=this.i(r[i]);return this}getSparse(){return this.get("sparse")}setSparse(e){return this.set("sparse",e)}getBuffer(){return this.getRef("buffer")}setBuffer(e){return this.setRef("buffer",e)}getArray(){return this.get("array")}setArray(e){return this.set("componentType",e?function(r){switch(r.constructor){case Float32Array:return pe.ComponentType.FLOAT;case Uint32Array:return pe.ComponentType.UNSIGNED_INT;case Uint16Array:return pe.ComponentType.UNSIGNED_SHORT;case Uint8Array:return pe.ComponentType.UNSIGNED_BYTE;case Int16Array:return pe.ComponentType.SHORT;case Int8Array:return pe.ComponentType.BYTE;default:throw new Error("Unknown accessor componentType.")}}(e):pe.ComponentType.FLOAT),this.set("array",e),this}getByteLength(){const e=this.get("array");return e?e.byteLength:0}};Y.Type={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"},Y.ComponentType={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126};let Ki=class extends Le{init(){this.propertyType=G.ANIMATION}getDefaults(){return Object.assign(super.getDefaults(),{channels:[],samplers:[]})}addChannel(e){return this.addRef("channels",e)}removeChannel(e){return this.removeRef("channels",e)}listChannels(){return this.listRefs("channels")}addSampler(e){return this.addRef("samplers",e)}removeSampler(e){return this.removeRef("samplers",e)}listSamplers(){return this.listRefs("samplers")}},hs=class extends Le{init(){this.propertyType=G.ANIMATION_CHANNEL}getDefaults(){return Object.assign(super.getDefaults(),{targetPath:null,targetNode:null,sampler:null})}getTargetPath(){return this.get("targetPath")}setTargetPath(e){return this.set("targetPath",e)}getTargetNode(){return this.getRef("targetNode")}setTargetNode(e){return this.setRef("targetNode",e)}getSampler(){return this.getRef("sampler")}setSampler(e){return this.setRef("sampler",e)}};hs.TargetPath={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"};let vn=class Ji extends Le{init(){this.propertyType=G.ANIMATION_SAMPLER}getDefaultAttributes(){return Object.assign(super.getDefaults(),{interpolation:Ji.Interpolation.LINEAR,input:null,output:null})}getInterpolation(){return this.get("interpolation")}setInterpolation(e){return this.set("interpolation",e)}getInput(){return this.getRef("input")}setInput(e){return this.setRef("input",e,{usage:Ge.OTHER})}getOutput(){return this.getRef("output")}setOutput(e){return this.setRef("output",e,{usage:Ge.OTHER})}};vn.Interpolation={LINEAR:"LINEAR",STEP:"STEP",CUBICSPLINE:"CUBICSPLINE"};let Zi=class extends Le{init(){this.propertyType=G.BUFFER}getDefaults(){return Object.assign(super.getDefaults(),{uri:""})}getURI(){return this.get("uri")}setURI(e){return this.set("uri",e)}},Dr=class Qi extends Le{init(){this.propertyType=G.CAMERA}getDefaults(){return Object.assign(super.getDefaults(),{type:Qi.Type.PERSPECTIVE,znear:.1,zfar:100,aspectRatio:null,yfov:2*Math.PI*50/360,xmag:1,ymag:1})}getType(){return this.get("type")}setType(e){return this.set("type",e)}getZNear(){return this.get("znear")}setZNear(e){return this.set("znear",e)}getZFar(){return this.get("zfar")}setZFar(e){return this.set("zfar",e)}getAspectRatio(){return this.get("aspectRatio")}setAspectRatio(e){return this.set("aspectRatio",e)}getYFov(){return this.get("yfov")}setYFov(e){return this.set("yfov",e)}getXMag(){return this.get("xmag")}setXMag(e){return this.set("xmag",e)}getYMag(){return this.get("ymag")}setYMag(e){return this.set("ymag",e)}};Dr.Type={PERSPECTIVE:"perspective",ORTHOGRAPHIC:"orthographic"};let we=class extends us{t(e){if(!this.parentTypes.includes(e.propertyType))throw new Error(`Parent "${e.propertyType}" invalid for child "${this.propertyType}".`)}};we.EXTENSION_NAME=void 0;let ye=class Jn extends Le{init(){this.propertyType=G.TEXTURE_INFO}getDefaults(){return Object.assign(super.getDefaults(),{texCoord:0,magFilter:null,minFilter:null,wrapS:Jn.WrapMode.REPEAT,wrapT:Jn.WrapMode.REPEAT})}getTexCoord(){return this.get("texCoord")}setTexCoord(e){return this.set("texCoord",e)}getMagFilter(){return this.get("magFilter")}setMagFilter(e){return this.set("magFilter",e)}getMinFilter(){return this.get("minFilter")}setMinFilter(e){return this.set("minFilter",e)}getWrapS(){return this.get("wrapS")}setWrapS(e){return this.set("wrapS",e)}getWrapT(){return this.get("wrapT")}setWrapT(e){return this.set("wrapT",e)}};ye.WrapMode={CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},ye.MagFilter={NEAREST:9728,LINEAR:9729},ye.MinFilter={NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987};const{R:Xr,G:Yr,B:Kr,A:bf}=tt;let ir=class ea extends Le{init(){this.propertyType=G.MATERIAL}getDefaults(){return Object.assign(super.getDefaults(),{alphaMode:ea.AlphaMode.OPAQUE,alphaCutoff:.5,doubleSided:!1,baseColorFactor:[1,1,1,1],baseColorTexture:null,baseColorTextureInfo:new ye(this.graph,"baseColorTextureInfo"),emissiveFactor:[0,0,0],emissiveTexture:null,emissiveTextureInfo:new ye(this.graph,"emissiveTextureInfo"),normalScale:1,normalTexture:null,normalTextureInfo:new ye(this.graph,"normalTextureInfo"),occlusionStrength:1,occlusionTexture:null,occlusionTextureInfo:new ye(this.graph,"occlusionTextureInfo"),roughnessFactor:1,metallicFactor:1,metallicRoughnessTexture:null,metallicRoughnessTextureInfo:new ye(this.graph,"metallicRoughnessTextureInfo")})}getDoubleSided(){return this.get("doubleSided")}setDoubleSided(e){return this.set("doubleSided",e)}getAlpha(){return this.get("baseColorFactor")[3]}setAlpha(e){const r=this.get("baseColorFactor").slice();return r[3]=e,this.set("baseColorFactor",r)}getAlphaMode(){return this.get("alphaMode")}setAlphaMode(e){return this.set("alphaMode",e)}getAlphaCutoff(){return this.get("alphaCutoff")}setAlphaCutoff(e){return this.set("alphaCutoff",e)}getBaseColorFactor(){return this.get("baseColorFactor")}setBaseColorFactor(e){return this.set("baseColorFactor",e)}getBaseColorHex(){return Ve.factorToHex(this.get("baseColorFactor"))}setBaseColorHex(e){const r=this.get("baseColorFactor").slice();return this.set("baseColorFactor",Ve.hexToFactor(e,r))}getBaseColorTexture(){return this.getRef("baseColorTexture")}getBaseColorTextureInfo(){return this.getRef("baseColorTexture")?this.getRef("baseColorTextureInfo"):null}setBaseColorTexture(e){return this.setRef("baseColorTexture",e,{channels:Xr|Yr|Kr|bf,isColor:!0})}getEmissiveFactor(){return this.get("emissiveFactor")}setEmissiveFactor(e){return this.set("emissiveFactor",e)}getEmissiveHex(){return Ve.factorToHex(this.get("emissiveFactor"))}setEmissiveHex(e){const r=this.get("emissiveFactor").slice();return this.set("emissiveFactor",Ve.hexToFactor(e,r))}getEmissiveTexture(){return this.getRef("emissiveTexture")}getEmissiveTextureInfo(){return this.getRef("emissiveTexture")?this.getRef("emissiveTextureInfo"):null}setEmissiveTexture(e){return this.setRef("emissiveTexture",e,{channels:Xr|Yr|Kr,isColor:!0})}getNormalScale(){return this.get("normalScale")}setNormalScale(e){return this.set("normalScale",e)}getNormalTexture(){return this.getRef("normalTexture")}getNormalTextureInfo(){return this.getRef("normalTexture")?this.getRef("normalTextureInfo"):null}setNormalTexture(e){return this.setRef("normalTexture",e,{channels:Xr|Yr|Kr})}getOcclusionStrength(){return this.get("occlusionStrength")}setOcclusionStrength(e){return this.set("occlusionStrength",e)}getOcclusionTexture(){return this.getRef("occlusionTexture")}getOcclusionTextureInfo(){return this.getRef("occlusionTexture")?this.getRef("occlusionTextureInfo"):null}setOcclusionTexture(e){return this.setRef("occlusionTexture",e,{channels:Xr})}getRoughnessFactor(){return this.get("roughnessFactor")}setRoughnessFactor(e){return this.set("roughnessFactor",e)}getMetallicFactor(){return this.get("metallicFactor")}setMetallicFactor(e){return this.set("metallicFactor",e)}getMetallicRoughnessTexture(){return this.getRef("metallicRoughnessTexture")}getMetallicRoughnessTextureInfo(){return this.getRef("metallicRoughnessTexture")?this.getRef("metallicRoughnessTextureInfo"):null}setMetallicRoughnessTexture(e){return this.setRef("metallicRoughnessTexture",e,{channels:Yr|Kr})}};ir.AlphaMode={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};let ta=class extends Le{init(){this.propertyType=G.MESH}getDefaults(){return Object.assign(super.getDefaults(),{weights:[],primitives:[]})}addPrimitive(e){return this.addRef("primitives",e)}removePrimitive(e){return this.removeRef("primitives",e)}listPrimitives(){return this.listRefs("primitives")}getWeights(){return this.get("weights")}setWeights(e){return this.set("weights",e)}},ra=class extends Le{constructor(...e){super(...e),this.u=null,this.h=new Set}init(){this.propertyType=G.NODE}getDefaults(){return Object.assign(super.getDefaults(),{translation:[0,0,0],rotation:[0,0,0,1],scale:[1,1,1],weights:[],camera:null,mesh:null,skin:null,children:[]})}copy(e,r=gt){if(r===gt)throw new Error("Node cannot be copied.");return super.copy(e,r)}getTranslation(){return this.get("translation")}getRotation(){return this.get("rotation")}getScale(){return this.get("scale")}setTranslation(e){return this.set("translation",e)}setRotation(e){return this.set("rotation",e)}setScale(e){return this.set("scale",e)}getMatrix(){return ve.compose(this.get("translation"),this.get("rotation"),this.get("scale"),[])}setMatrix(e){const r=this.get("translation").slice(),n=this.get("rotation").slice(),s=this.get("scale").slice();return ve.decompose(e,r,n,s),this.set("translation",r).set("rotation",n).set("scale",s)}getWorldTranslation(){const e=[0,0,0];return ve.decompose(this.getWorldMatrix(),e,[0,0,0,1],[1,1,1]),e}getWorldRotation(){const e=[0,0,0,1];return ve.decompose(this.getWorldMatrix(),[0,0,0],e,[1,1,1]),e}getWorldScale(){const e=[1,1,1];return ve.decompose(this.getWorldMatrix(),[0,0,0],[0,0,0,1],e),e}getWorldMatrix(){const e=[];for(let s=this;s!=null;s=s.u)e.push(s);let r;const n=e.pop().getMatrix();for(;r=e.pop();)Tf(n,n,r.getMatrix());return n}addChild(e){if(e.u&&e.u.removeChild(e),e.h.size)for(const n of e.h)n.removeChild(e);this.addRef("children",e),e.u=this;const r=this[ce].children;return r[r.length-1].addEventListener("dispose",()=>e.u=null),this}removeChild(e){return this.removeRef("children",e)}listChildren(){return this.listRefs("children")}getParent(){return this.u?this.u:this.listParents().find(e=>e.propertyType===G.SCENE)||null}getParentNode(){return this.u}getMesh(){return this.getRef("mesh")}setMesh(e){return this.setRef("mesh",e)}getCamera(){return this.getRef("camera")}setCamera(e){return this.setRef("camera",e)}getSkin(){return this.getRef("skin")}setSkin(e){return this.setRef("skin",e)}getWeights(){return this.get("weights")}setWeights(e){return this.set("weights",e)}traverse(e){e(this);for(const r of this.listChildren())r.traverse(e);return this}},Nr=class na extends Le{init(){this.propertyType=G.PRIMITIVE}getDefaults(){return Object.assign(super.getDefaults(),{mode:na.Mode.TRIANGLES,material:null,indices:null,attributes:{},targets:[]})}getIndices(){return this.getRef("indices")}setIndices(e){return this.setRef("indices",e,{usage:Ge.ELEMENT_ARRAY_BUFFER})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,r){return this.setRefMap("attributes",e,r,{usage:Ge.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}getMaterial(){return this.getRef("material")}setMaterial(e){return this.setRef("material",e)}getMode(){return this.get("mode")}setMode(e){return this.set("mode",e)}listTargets(){return this.listRefs("targets")}addTarget(e){return this.addRef("targets",e)}removeTarget(e){return this.removeRef("targets",e)}};Nr.Mode={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};let _f=class extends us{init(){this.propertyType=G.PRIMITIVE_TARGET}getDefaults(){return Object.assign(super.getDefaults(),{attributes:{}})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,r){return this.setRefMap("attributes",e,r,{usage:Ge.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}};function Ue(){return Ue=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ue.apply(this,arguments)}let sa=class extends Le{init(){this.propertyType=G.SCENE}getDefaults(){return Object.assign(super.getDefaults(),{children:[]})}copy(e,r=gt){if(r===gt)throw new Error("Scene cannot be copied.");return super.copy(e,r)}addChild(e){e.u&&e.u.removeChild(e),this.addRef("children",e),e.h.add(this);const r=this[ce].children;return r[r.length-1].addEventListener("dispose",()=>e.h.delete(this)),this}removeChild(e){return this.removeRef("children",e)}listChildren(){return this.listRefs("children")}traverse(e){for(const r of this.listChildren())r.traverse(e);return this}},ia=class extends Le{init(){this.propertyType=G.SKIN}getDefaults(){return Object.assign(super.getDefaults(),{skeleton:null,inverseBindMatrices:null,joints:[]})}getSkeleton(){return this.getRef("skeleton")}setSkeleton(e){return this.setRef("skeleton",e)}getInverseBindMatrices(){return this.getRef("inverseBindMatrices")}setInverseBindMatrices(e){return this.setRef("inverseBindMatrices",e,{usage:Ge.INVERSE_BIND_MATRICES})}addJoint(e){return this.addRef("joints",e)}removeJoint(e){return this.removeRef("joints",e)}listJoints(){return this.listRefs("joints")}},aa=class extends Le{init(){this.propertyType=G.TEXTURE}getDefaults(){return Object.assign(super.getDefaults(),{image:null,mimeType:"",uri:""})}getMimeType(){return this.get("mimeType")||ct.extensionToMimeType(sr.extension(this.get("uri")))}setMimeType(e){return this.set("mimeType",e)}getURI(){return this.get("uri")}setURI(e){this.set("uri",e);const r=ct.extensionToMimeType(sr.extension(e));return r&&this.set("mimeType",r),this}getImage(){return this.get("image")}setImage(e){return this.set("image",Q.assertView(e))}getSize(){const e=this.get("image");return e?ct.getSize(e,this.getMimeType()):null}},oa=class extends Le{init(){this.propertyType=G.ROOT}getDefaults(){return Object.assign(super.getDefaults(),{asset:{generator:`glTF-Transform ${qi}`,version:"2.0"},defaultScene:null,accessors:[],animations:[],buffers:[],cameras:[],materials:[],meshes:[],nodes:[],scenes:[],skins:[],textures:[]})}constructor(e){super(e),this.l=new Set,e.addEventListener("node:create",r=>{this.g(r.target)})}clone(){throw new Error("Root cannot be cloned.")}copy(e,r=gt){if(r===gt)throw new Error("Root cannot be copied.");this.set("asset",Ue({},e.get("asset"))),this.setName(e.getName()),this.setExtras(Ue({},e.getExtras())),this.setDefaultScene(e.getDefaultScene()?r(e.getDefaultScene()):null);for(const n of e.listRefMapKeys("extensions")){const s=e.getExtension(n);this.setExtension(n,r(s))}return this}g(e){return e instanceof sa?this.addRef("scenes",e):e instanceof ra?this.addRef("nodes",e):e instanceof Dr?this.addRef("cameras",e):e instanceof ia?this.addRef("skins",e):e instanceof ta?this.addRef("meshes",e):e instanceof ir?this.addRef("materials",e):e instanceof aa?this.addRef("textures",e):e instanceof Ki?this.addRef("animations",e):e instanceof Y?this.addRef("accessors",e):e instanceof Zi&&this.addRef("buffers",e),this}getAsset(){return this.get("asset")}listExtensionsUsed(){return Array.from(this.l)}listExtensionsRequired(){return this.listExtensionsUsed().filter(e=>e.isRequired())}p(e){return this.l.add(e),this}m(e){return this.l.delete(e),this}listScenes(){return this.listRefs("scenes")}setDefaultScene(e){return this.setRef("defaultScene",e)}getDefaultScene(){return this.getRef("defaultScene")}listNodes(){return this.listRefs("nodes")}listCameras(){return this.listRefs("cameras")}listSkins(){return this.listRefs("skins")}listMeshes(){return this.listRefs("meshes")}listMaterials(){return this.listRefs("materials")}listTextures(){return this.listRefs("textures")}listAnimations(){return this.listRefs("animations")}listAccessors(){return this.listRefs("accessors")}listBuffers(){return this.listRefs("buffers")}},ps=class Qr{static fromGraph(e){return Qr.v.get(e)||null}constructor(){this.T=new pf,this.S=new oa(this.T),this.M=Bt.DEFAULT_INSTANCE,Qr.v.set(this.T,this)}getRoot(){return this.S}getGraph(){return this.T}getLogger(){return this.M}setLogger(e){return this.M=e,this}clone(){return new Qr().setLogger(this.M).merge(this)}merge(e){for(const i of e.getRoot().listExtensionsUsed()){const a=this.createExtension(i.constructor);i.isRequired()&&a.setRequired(!0)}const r=new Set,n=new Map;r.add(e.S),n.set(e.S,this.S);for(const i of e.T.listEdges())for(const a of[i.getParent(),i.getChild()]){if(r.has(a))continue;let o;o=a.propertyType===G.TEXTURE_INFO?a:new a.constructor(this.T),n.set(a,o),r.add(a)}const s=i=>{const a=n.get(i);if(!a)throw new Error("Could resolve property.");return a};for(const i of r){const a=n.get(i);if(!a)throw new Error("Could resolve property.");a.propertyType!==G.TEXTURE_INFO&&a.copy(i,s)}return this}async transform(...e){const r=e.map(n=>n.name);for(const n of e)await n(this,{stack:r});return this}createExtension(e){const r=e.EXTENSION_NAME;return this.getRoot().listExtensionsUsed().find(n=>n.extensionName===r)||new e(this)}createScene(e=""){return new sa(this.T,e)}createNode(e=""){return new ra(this.T,e)}createCamera(e=""){return new Dr(this.T,e)}createSkin(e=""){return new ia(this.T,e)}createMesh(e=""){return new ta(this.T,e)}createPrimitive(){return new Nr(this.T)}createPrimitiveTarget(e=""){return new _f(this.T,e)}createMaterial(e=""){return new ir(this.T,e)}createTexture(e=""){return new aa(this.T,e)}createAnimation(e=""){return new Ki(this.T,e)}createAnimationChannel(e=""){return new hs(this.T,e)}createAnimationSampler(e=""){return new vn(this.T,e)}createAccessor(e="",r=null){return r||(r=this.getRoot().listBuffers()[0]),new Y(this.T,e).setBuffer(r)}createBuffer(e=""){return new Zi(this.T,e)}};ps.v=new WeakMap;let ge=class{constructor(e){this.extensionName="",this.prereadTypes=[],this.prewriteTypes=[],this.readDependencies=[],this.writeDependencies=[],this.document=void 0,this.required=!1,this.properties=new Set,this.I=void 0,this.document=e,e.getRoot().p(this),this.I=n=>{const s=n,i=s.target;i instanceof we&&i.extensionName===this.extensionName&&(s.type==="node:create"&&this.N(i),s.type==="node:dispose"&&this.O(i))};const r=e.getGraph();r.addEventListener("node:create",this.I),r.addEventListener("node:dispose",this.I)}dispose(){this.document.getRoot().m(this);const e=this.document.getGraph();e.removeEventListener("node:create",this.I),e.removeEventListener("node:dispose",this.I);for(const r of this.properties)r.dispose()}static register(){}isRequired(){return this.required}setRequired(e){return this.required=e,this}listProperties(){return Array.from(this.properties)}N(e){return this.properties.add(e),this}O(e){return this.properties.delete(e),this}install(e,r){return this}preread(e,r){return this}prewrite(e,r){return this}};ge.EXTENSION_NAME=void 0;let Sf=class{constructor(e){this.jsonDoc=void 0,this.buffers=[],this.bufferViews=[],this.bufferViewBuffers=[],this.accessors=[],this.textures=[],this.textureInfos=new Map,this.materials=[],this.meshes=[],this.cameras=[],this.nodes=[],this.skins=[],this.animations=[],this.scenes=[],this.jsonDoc=e}setTextureInfo(e,r){this.textureInfos.set(e,r),r.texCoord!==void 0&&e.setTexCoord(r.texCoord),r.extras!==void 0&&e.setExtras(r.extras);const n=this.jsonDoc.json.textures[r.index];if(n.sampler===void 0)return;const s=this.jsonDoc.json.samplers[n.sampler];s.magFilter!==void 0&&e.setMagFilter(s.magFilter),s.minFilter!==void 0&&e.setMinFilter(s.minFilter),s.wrapS!==void 0&&e.setWrapS(s.wrapS),s.wrapT!==void 0&&e.setWrapT(s.wrapT)}};const xi={logger:Bt.DEFAULT_INSTANCE,extensions:[],dependencies:{}};let Cf=class{static read(e,r=xi){const n=Ue({},xi,r),{json:s}=e,i=new ps().setLogger(n.logger);this.validate(e,n);const a=new Sf(e),o=s.asset,c=i.getRoot().getAsset();o.copyright&&(c.copyright=o.copyright),o.extras&&(c.extras=o.extras),s.extras!==void 0&&i.getRoot().setExtras(Ue({},s.extras));const u=s.extensionsUsed||[],h=s.extensionsRequired||[];for(const g of n.extensions)if(u.includes(g.EXTENSION_NAME)){const y=i.createExtension(g).setRequired(h.includes(g.EXTENSION_NAME));for(const T of y.readDependencies)y.install(T,n.dependencies[T])}const d=s.buffers||[];i.getRoot().listExtensionsUsed().filter(g=>g.prereadTypes.includes(G.BUFFER)).forEach(g=>g.preread(a,G.BUFFER)),a.buffers=d.map(g=>{const y=i.createBuffer(g.name);return g.extras&&y.setExtras(g.extras),g.uri&&g.uri.indexOf("__")!==0&&y.setURI(g.uri),y}),a.bufferViewBuffers=(s.bufferViews||[]).map((g,y)=>{if(!a.bufferViews[y]){const T=e.json.buffers[g.buffer];a.bufferViews[y]=Q.toView(T.uri?e.resources[T.uri]:e.resources[nr],g.byteOffset||0,g.byteLength)}return a.buffers[g.buffer]});const m=s.accessors||[];a.accessors=m.map(g=>{const y=i.createAccessor(g.name,a.bufferViewBuffers[g.bufferView]).setType(g.type);return g.extras&&y.setExtras(g.extras),g.normalized!==void 0&&y.setNormalized(g.normalized),g.bufferView===void 0||y.setArray(Jr(g,a)),y});const x=s.images||[],M=s.textures||[];i.getRoot().listExtensionsUsed().filter(g=>g.prereadTypes.includes(G.TEXTURE)).forEach(g=>g.preread(a,G.TEXTURE)),a.textures=x.map(g=>{const y=i.createTexture(g.name);if(g.extras&&y.setExtras(g.extras),g.bufferView!==void 0){const T=s.bufferViews[g.bufferView],I=e.json.buffers[T.buffer],_=T.byteOffset||0,U=(I.uri?e.resources[I.uri]:e.resources[nr]).slice(_,_+T.byteLength);y.setImage(U)}else g.uri!==void 0&&(y.setImage(e.resources[g.uri]),g.uri.indexOf("__")!==0&&y.setURI(g.uri));if(g.mimeType!==void 0)y.setMimeType(g.mimeType);else if(g.uri){const T=sr.extension(g.uri);y.setMimeType(ct.extensionToMimeType(T))}return y}),a.materials=(s.materials||[]).map(g=>{const y=i.createMaterial(g.name);g.extras&&y.setExtras(g.extras),g.alphaMode!==void 0&&y.setAlphaMode(g.alphaMode),g.alphaCutoff!==void 0&&y.setAlphaCutoff(g.alphaCutoff),g.doubleSided!==void 0&&y.setDoubleSided(g.doubleSided);const T=g.pbrMetallicRoughness||{};if(T.baseColorFactor!==void 0&&y.setBaseColorFactor(T.baseColorFactor),g.emissiveFactor!==void 0&&y.setEmissiveFactor(g.emissiveFactor),T.metallicFactor!==void 0&&y.setMetallicFactor(T.metallicFactor),T.roughnessFactor!==void 0&&y.setRoughnessFactor(T.roughnessFactor),T.baseColorTexture!==void 0){const I=T.baseColorTexture;y.setBaseColorTexture(a.textures[M[I.index].source]),a.setTextureInfo(y.getBaseColorTextureInfo(),I)}if(g.emissiveTexture!==void 0){const I=g.emissiveTexture;y.setEmissiveTexture(a.textures[M[I.index].source]),a.setTextureInfo(y.getEmissiveTextureInfo(),I)}if(g.normalTexture!==void 0){const I=g.normalTexture;y.setNormalTexture(a.textures[M[I.index].source]),a.setTextureInfo(y.getNormalTextureInfo(),I),g.normalTexture.scale!==void 0&&y.setNormalScale(g.normalTexture.scale)}if(g.occlusionTexture!==void 0){const I=g.occlusionTexture;y.setOcclusionTexture(a.textures[M[I.index].source]),a.setTextureInfo(y.getOcclusionTextureInfo(),I),g.occlusionTexture.strength!==void 0&&y.setOcclusionStrength(g.occlusionTexture.strength)}if(T.metallicRoughnessTexture!==void 0){const I=T.metallicRoughnessTexture;y.setMetallicRoughnessTexture(a.textures[M[I.index].source]),a.setTextureInfo(y.getMetallicRoughnessTextureInfo(),I)}return y});const w=s.meshes||[];i.getRoot().listExtensionsUsed().filter(g=>g.prereadTypes.includes(G.PRIMITIVE)).forEach(g=>g.preread(a,G.PRIMITIVE)),a.meshes=w.map(g=>{const y=i.createMesh(g.name);return g.extras&&y.setExtras(g.extras),g.weights!==void 0&&y.setWeights(g.weights),(g.primitives||[]).forEach(T=>{const I=i.createPrimitive();T.extras&&I.setExtras(T.extras),T.material!==void 0&&I.setMaterial(a.materials[T.material]),T.mode!==void 0&&I.setMode(T.mode);for(const[U,$]of Object.entries(T.attributes||{}))I.setAttribute(U,a.accessors[$]);T.indices!==void 0&&I.setIndices(a.accessors[T.indices]);const _=g.extras&&g.extras.targetNames||[];(T.targets||[]).forEach((U,$)=>{const C=_[$]||$.toString(),j=i.createPrimitiveTarget(C);for(const[V,q]of Object.entries(U))j.setAttribute(V,a.accessors[q]);I.addTarget(j)}),y.addPrimitive(I)}),y}),a.cameras=(s.cameras||[]).map(g=>{const y=i.createCamera(g.name).setType(g.type);if(g.extras&&y.setExtras(g.extras),g.type===Dr.Type.PERSPECTIVE){const T=g.perspective;y.setYFov(T.yfov),y.setZNear(T.znear),T.zfar!==void 0&&y.setZFar(T.zfar),T.aspectRatio!==void 0&&y.setAspectRatio(T.aspectRatio)}else{const T=g.orthographic;y.setZNear(T.znear).setZFar(T.zfar).setXMag(T.xmag).setYMag(T.ymag)}return y});const p=s.nodes||[];i.getRoot().listExtensionsUsed().filter(g=>g.prereadTypes.includes(G.NODE)).forEach(g=>g.preread(a,G.NODE)),a.nodes=p.map(g=>{const y=i.createNode(g.name);if(g.extras&&y.setExtras(g.extras),g.translation!==void 0&&y.setTranslation(g.translation),g.rotation!==void 0&&y.setRotation(g.rotation),g.scale!==void 0&&y.setScale(g.scale),g.matrix!==void 0){const T=[0,0,0],I=[0,0,0,1],_=[1,1,1];ve.decompose(g.matrix,T,I,_),y.setTranslation(T),y.setRotation(I),y.setScale(_)}return g.weights!==void 0&&y.setWeights(g.weights),y}),a.skins=(s.skins||[]).map(g=>{const y=i.createSkin(g.name);g.extras&&y.setExtras(g.extras),g.inverseBindMatrices!==void 0&&y.setInverseBindMatrices(a.accessors[g.inverseBindMatrices]),g.skeleton!==void 0&&y.setSkeleton(a.nodes[g.skeleton]);for(const T of g.joints)y.addJoint(a.nodes[T]);return y}),p.map((g,y)=>{const T=a.nodes[y];(g.children||[]).forEach(I=>T.addChild(a.nodes[I])),g.mesh!==void 0&&T.setMesh(a.meshes[g.mesh]),g.camera!==void 0&&T.setCamera(a.cameras[g.camera]),g.skin!==void 0&&T.setSkin(a.skins[g.skin])}),a.animations=(s.animations||[]).map(g=>{const y=i.createAnimation(g.name);g.extras&&y.setExtras(g.extras);const T=(g.samplers||[]).map(I=>{const _=i.createAnimationSampler().setInput(a.accessors[I.input]).setOutput(a.accessors[I.output]).setInterpolation(I.interpolation||vn.Interpolation.LINEAR);return I.extras&&_.setExtras(I.extras),y.addSampler(_),_});return(g.channels||[]).forEach(I=>{const _=i.createAnimationChannel().setSampler(T[I.sampler]).setTargetPath(I.target.path);I.target.node!==void 0&&_.setTargetNode(a.nodes[I.target.node]),I.extras&&_.setExtras(I.extras),y.addChannel(_)}),y});const R=s.scenes||[];return i.getRoot().listExtensionsUsed().filter(g=>g.prereadTypes.includes(G.SCENE)).forEach(g=>g.preread(a,G.SCENE)),a.scenes=R.map(g=>{const y=i.createScene(g.name);return g.extras&&y.setExtras(g.extras),(g.nodes||[]).map(T=>a.nodes[T]).forEach(T=>y.addChild(T)),y}),s.scene!==void 0&&i.getRoot().setDefaultScene(a.scenes[s.scene]),i.getRoot().listExtensionsUsed().forEach(g=>g.read(a)),m.forEach((g,y)=>{const T=a.accessors[y],I=!!g.sparse,_=!g.bufferView&&!T.getArray();(I||_)&&T.setSparse(!0).setArray(function(U,$){const C=an[U.componentType],j=Y.getElementSize(U.type);let V;V=U.bufferView!==void 0?Jr(U,$):new C(U.count*j);const q=U.sparse;if(!q)return V;const L=q.count,D=Ue({},U,q.indices,{count:L,type:"SCALAR"}),X=Ue({},U,q.values,{count:L}),te=Jr(D,$),J=Jr(X,$);for(let ie=0;ie<D.count;ie++)for(let re=0;re<j;re++)V[te[ie]*j+re]=J[ie*j+re];return V}(g,a))}),i}static validate(e,r){const n=e.json;if(n.asset.version!=="2.0")throw new Error(`Unsupported glTF version, "${n.asset.version}".`);if(n.extensionsRequired){for(const s of n.extensionsRequired)if(!r.extensions.find(i=>i.EXTENSION_NAME===s))throw new Error(`Missing required extension, "${s}".`)}if(n.extensionsUsed)for(const s of n.extensionsUsed)r.extensions.find(i=>i.EXTENSION_NAME===s)||r.logger.warn(`Missing optional extension, "${s}".`)}};function Jr(t,e){const r=e.bufferViews[t.bufferView],n=e.jsonDoc.json.bufferViews[t.bufferView],s=an[t.componentType],i=Y.getElementSize(t.type),a=s.BYTES_PER_ELEMENT;if(n.byteStride!==void 0&&n.byteStride!==i*a)return function(c,u){const h=u.bufferViews[c.bufferView],d=u.jsonDoc.json.bufferViews[c.bufferView],m=an[c.componentType],x=Y.getElementSize(c.type),M=m.BYTES_PER_ELEMENT,w=c.byteOffset||0,p=new m(c.count*x),R=new DataView(h.buffer,h.byteOffset,h.byteLength),g=d.byteStride;for(let y=0;y<c.count;y++)for(let T=0;T<x;T++){const I=w+y*g+T*M;let _;switch(c.componentType){case Y.ComponentType.FLOAT:_=R.getFloat32(I,!0);break;case Y.ComponentType.UNSIGNED_INT:_=R.getUint32(I,!0);break;case Y.ComponentType.UNSIGNED_SHORT:_=R.getUint16(I,!0);break;case Y.ComponentType.UNSIGNED_BYTE:_=R.getUint8(I);break;case Y.ComponentType.SHORT:_=R.getInt16(I,!0);break;case Y.ComponentType.BYTE:_=R.getInt8(I);break;default:throw new Error(`Unexpected componentType "${c.componentType}".`)}p[y*x+T]=_}return p}(t,e);const o=r.byteOffset+(t.byteOffset||0);return new s(r.buffer.slice(o,o+t.count*i*a))}var br;(function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"})(br||(br={}));let et=class{constructor(e,r,n){this.C=void 0,this.jsonDoc=void 0,this.options=void 0,this.accessorIndexMap=new Map,this.animationIndexMap=new Map,this.bufferIndexMap=new Map,this.cameraIndexMap=new Map,this.skinIndexMap=new Map,this.materialIndexMap=new Map,this.meshIndexMap=new Map,this.nodeIndexMap=new Map,this.imageIndexMap=new Map,this.textureDefIndexMap=new Map,this.textureInfoDefMap=new Map,this.samplerDefIndexMap=new Map,this.sceneIndexMap=new Map,this.imageBufferViews=[],this.otherBufferViews=new Map,this.otherBufferViewsIndexMap=new Map,this.extensionData={},this.bufferURIGenerator=void 0,this.imageURIGenerator=void 0,this.logger=void 0,this.F=new Map,this.accessorUsageGroupedByParent=new Set(["ARRAY_BUFFER"]),this.accessorParents=new Map,this.C=e,this.jsonDoc=r,this.options=n;const s=e.getRoot(),i=s.listBuffers().length,a=s.listTextures().length;this.bufferURIGenerator=new yi(i>1,()=>n.basename||"buffer"),this.imageURIGenerator=new yi(a>1,o=>function(c,u){const h=c.getGraph().listParentEdges(u).find(d=>d.getParent()!==c.getRoot());return h?h.getName().replace(/texture$/i,""):""}(e,o)||n.basename||"texture"),this.logger=e.getLogger()}createTextureInfoDef(e,r){const n={magFilter:r.getMagFilter()||void 0,minFilter:r.getMinFilter()||void 0,wrapS:r.getWrapS(),wrapT:r.getWrapT()},s=JSON.stringify(n);this.samplerDefIndexMap.has(s)||(this.samplerDefIndexMap.set(s,this.jsonDoc.json.samplers.length),this.jsonDoc.json.samplers.push(n));const i={source:this.imageIndexMap.get(e),sampler:this.samplerDefIndexMap.get(s)},a=JSON.stringify(i);this.textureDefIndexMap.has(a)||(this.textureDefIndexMap.set(a,this.jsonDoc.json.textures.length),this.jsonDoc.json.textures.push(i));const o={index:this.textureDefIndexMap.get(a)};return r.getTexCoord()!==0&&(o.texCoord=r.getTexCoord()),Object.keys(r.getExtras()).length>0&&(o.extras=r.getExtras()),this.textureInfoDefMap.set(r,o),o}createPropertyDef(e){const r={};return e.getName()&&(r.name=e.getName()),Object.keys(e.getExtras()).length>0&&(r.extras=e.getExtras()),r}createAccessorDef(e){const r=this.createPropertyDef(e);return r.type=e.getType(),r.componentType=e.getComponentType(),r.count=e.getCount(),this.C.getGraph().listParentEdges(e).some(n=>n.getName()==="attributes"&&n.getAttributes().key==="POSITION"||n.getName()==="input")&&(r.max=e.getMax([]).map(Math.fround),r.min=e.getMin([]).map(Math.fround)),e.getNormalized()&&(r.normalized=e.getNormalized()),r}createImageData(e,r,n){if(this.options.format===Lt.GLB)this.imageBufferViews.push(r),e.bufferView=this.jsonDoc.json.bufferViews.length,this.jsonDoc.json.bufferViews.push({buffer:0,byteOffset:-1,byteLength:r.byteLength});else{const s=ct.mimeTypeToExtension(n.getMimeType());e.uri=this.imageURIGenerator.createURI(n,s),this.jsonDoc.resources[e.uri]=r}}getAccessorUsage(e){const r=this.F.get(e);if(r)return r;if(e.getSparse())return Ge.SPARSE;for(const n of this.C.getGraph().listParentEdges(e)){const{usage:s}=n.getAttributes();if(s)return s;n.getParent().propertyType!==G.ROOT&&this.logger.warn(`Missing attribute ".usage" on edge, "${n.getName()}".`)}return Ge.OTHER}addAccessorToUsageGroup(e,r){const n=this.F.get(e);if(n&&n!==r)throw new Error(`Accessor with usage "${n}" cannot be reused as "${r}".`);return this.F.set(e,r),this}listAccessorUsageGroups(){const e={};for(const[r,n]of Array.from(this.F.entries()))e[n]=e[n]||[],e[n].push(r);return e}};et.BufferViewTarget=br,et.BufferViewUsage=Ge,et.USAGE_TO_TARGET={[Ge.ARRAY_BUFFER]:br.ARRAY_BUFFER,[Ge.ELEMENT_ARRAY_BUFFER]:br.ELEMENT_ARRAY_BUFFER};let yi=class{constructor(e,r){this.multiple=void 0,this.basename=void 0,this.counter={},this.multiple=e,this.basename=r}createURI(e,r){if(e.getURI())return e.getURI();if(this.multiple){const n=this.basename(e);return this.counter[n]=this.counter[n]||1,`${n}_${this.counter[n]++}.${r}`}return`${this.basename(e)}.${r}`}};const{BufferViewUsage:Zr}=et,{UNSIGNED_INT:Nf,UNSIGNED_SHORT:Of,UNSIGNED_BYTE:$f}=Y.ComponentType;let Ff=class{static write(e,r){const n=e.getRoot(),s={asset:Ue({generator:`glTF-Transform ${qi}`},n.getAsset()),extras:Ue({},n.getExtras())},i={json:s,resources:{}},a=new et(e,i,r),o=r.logger||Bt.DEFAULT_INSTANCE,c=new Set(r.extensions.map(p=>p.EXTENSION_NAME)),u=e.getRoot().listExtensionsUsed().filter(p=>c.has(p.extensionName)),h=e.getRoot().listExtensionsRequired().filter(p=>c.has(p.extensionName));u.length<e.getRoot().listExtensionsUsed().length&&o.warn("Some extensions were not registered for I/O, and will not be written.");for(const p of u)for(const R of p.writeDependencies)p.install(R,r.dependencies[R]);function d(p,R,g,y){const T=[];let I=0;for(const U of p){const $=a.createAccessorDef(U);$.bufferView=s.bufferViews.length;const C=U.getArray(),j=Q.pad(Q.toView(C));$.byteOffset=I,I+=j.byteLength,T.push(j),a.accessorIndexMap.set(U,s.accessors.length),s.accessors.push($)}const _={buffer:R,byteOffset:g,byteLength:Q.concat(T).byteLength};return y&&(_.target=y),s.bufferViews.push(_),{buffers:T,byteLength:I}}function m(p,R,g){const y=p[0].getCount();let T=0;for(const $ of p){const C=a.createAccessorDef($);C.bufferView=s.bufferViews.length,C.byteOffset=T;const j=$.getElementSize(),V=$.getComponentSize();T+=Q.padNumber(j*V),a.accessorIndexMap.set($,s.accessors.length),s.accessors.push(C)}const I=y*T,_=new ArrayBuffer(I),U=new DataView(_);for(let $=0;$<y;$++){let C=0;for(const j of p){const V=j.getElementSize(),q=j.getComponentSize(),L=j.getComponentType(),D=j.getArray();for(let X=0;X<V;X++){const te=$*T+C+X*q,J=D[$*V+X];switch(L){case Y.ComponentType.FLOAT:U.setFloat32(te,J,!0);break;case Y.ComponentType.BYTE:U.setInt8(te,J);break;case Y.ComponentType.SHORT:U.setInt16(te,J,!0);break;case Y.ComponentType.UNSIGNED_BYTE:U.setUint8(te,J);break;case Y.ComponentType.UNSIGNED_SHORT:U.setUint16(te,J,!0);break;case Y.ComponentType.UNSIGNED_INT:U.setUint32(te,J,!0);break;default:throw new Error("Unexpected component type: "+L)}}C+=Q.padNumber(V*q)}}return s.bufferViews.push({buffer:R,byteOffset:g,byteLength:I,byteStride:T,target:et.BufferViewTarget.ARRAY_BUFFER}),{byteLength:I,buffers:[new Uint8Array(_)]}}function x(p,R,g){const y=[];let T=0;const I=new Map;let _=-1/0;for(const L of p){const D=a.createAccessorDef(L);s.accessors.push(D),a.accessorIndexMap.set(L,s.accessors.length-1);const X=[],te=[],J=[],ie=new Array(L.getElementSize()).fill(0);for(let le=0,Ae=L.getCount();le<Ae;le++)if(L.getElement(le,J),!ve.eq(J,ie,0)){_=Math.max(le,_),X.push(le);for(let ue=0;ue<J.length;ue++)te.push(J[ue])}const re=X.length,ae={accessorDef:D,count:re};if(I.set(L,ae),re===0)continue;if(re>L.getCount()/3){const le=(100*X.length/L.getCount()).toFixed(1);o.warn(`Sparse accessor with many non-zero elements (${le}%) may increase file size.`)}const oe=an[L.getComponentType()];ae.indices=X,ae.values=new oe(te)}if(!Number.isFinite(_))return{buffers:y,byteLength:T};const U=_<255?Uint8Array:_<65535?Uint16Array:Uint32Array,$=_<255?$f:_<65535?Of:Nf,C={buffer:R,byteOffset:g+T,byteLength:0};for(const L of p){const D=I.get(L);if(D.count===0)continue;D.indicesByteOffset=C.byteLength;const X=Q.pad(Q.toView(new U(D.indices)));y.push(X),T+=X.byteLength,C.byteLength+=X.byteLength}s.bufferViews.push(C);const j=s.bufferViews.length-1,V={buffer:R,byteOffset:g+T,byteLength:0};for(const L of p){const D=I.get(L);if(D.count===0)continue;D.valuesByteOffset=V.byteLength;const X=Q.pad(Q.toView(D.values));y.push(X),T+=X.byteLength,V.byteLength+=X.byteLength}s.bufferViews.push(V);const q=s.bufferViews.length-1;for(const L of p){const D=I.get(L);D.count!==0&&(D.accessorDef.sparse={count:D.count,indices:{bufferView:j,byteOffset:D.indicesByteOffset,componentType:$},values:{bufferView:q,byteOffset:D.valuesByteOffset}})}return{buffers:y,byteLength:T}}const M=new Map;for(const p of e.getGraph().listEdges()){if(p.getParent()===n)continue;const R=p.getChild();if(R instanceof Y){const g=M.get(R)||[];g.push(p),M.set(R,g)}}if(s.accessors=[],s.bufferViews=[],s.samplers=[],s.textures=[],s.images=n.listTextures().map((p,R)=>{const g=a.createPropertyDef(p);p.getMimeType()&&(g.mimeType=p.getMimeType());const y=p.getImage();return y&&a.createImageData(g,y,p),a.imageIndexMap.set(p,R),g}),u.filter(p=>p.prewriteTypes.includes(G.ACCESSOR)).forEach(p=>p.prewrite(a,G.ACCESSOR)),n.listAccessors().forEach(p=>{const R=a.accessorUsageGroupedByParent,g=a.accessorParents;if(a.accessorIndexMap.has(p))return;const y=M.get(p)||[],T=a.getAccessorUsage(p);if(a.addAccessorToUsageGroup(p,T),R.has(T)){const I=y[0].getParent(),_=g.get(I)||new Set;_.add(p),g.set(I,_)}}),u.filter(p=>p.prewriteTypes.includes(G.BUFFER)).forEach(p=>p.prewrite(a,G.BUFFER)),(n.listAccessors().length>0||n.listTextures().length>0||a.otherBufferViews.size>0)&&n.listBuffers().length===0)throw new Error("Buffer required for Document resources, but none was found.");s.buffers=[],n.listBuffers().forEach((p,R)=>{const g=a.createPropertyDef(p),y=a.accessorUsageGroupedByParent,T=a.accessorParents,I=p.listParents().filter(V=>V instanceof Y),_=new Set(I),U=[],$=s.buffers.length;let C=0;const j=a.listAccessorUsageGroups();for(const V in j)if(y.has(V))for(const q of Array.from(T.values())){const L=Array.from(q).filter(D=>_.has(D)).filter(D=>a.getAccessorUsage(D)===V);if(L.length)if(V!==Zr.ARRAY_BUFFER||r.vertexLayout===sn.INTERLEAVED){const D=V===Zr.ARRAY_BUFFER?m(L,$,C):d(L,$,C);C+=D.byteLength,U.push(...D.buffers)}else for(const D of L){const X=m([D],$,C);C+=X.byteLength,U.push(...X.buffers)}}else{const q=j[V].filter(X=>_.has(X));if(!q.length)continue;const L=V===Zr.ELEMENT_ARRAY_BUFFER?et.BufferViewTarget.ELEMENT_ARRAY_BUFFER:void 0,D=V===Zr.SPARSE?x(q,$,C):d(q,$,C,L);C+=D.byteLength,U.push(...D.buffers)}if(a.imageBufferViews.length&&R===0){for(let V=0;V<a.imageBufferViews.length;V++)if(s.bufferViews[s.images[V].bufferView].byteOffset=C,C+=a.imageBufferViews[V].byteLength,U.push(a.imageBufferViews[V]),C%8){const q=8-C%8;C+=q,U.push(new Uint8Array(q))}}if(a.otherBufferViews.has(p))for(const V of a.otherBufferViews.get(p))s.bufferViews.push({buffer:$,byteOffset:C,byteLength:V.byteLength}),a.otherBufferViewsIndexMap.set(V,s.bufferViews.length-1),C+=V.byteLength,U.push(V);if(C){let V;r.format===Lt.GLB?V=nr:(V=a.bufferURIGenerator.createURI(p,"bin"),g.uri=V),g.byteLength=C,i.resources[V]=Q.concat(U)}s.buffers.push(g),a.bufferIndexMap.set(p,R)}),n.listAccessors().find(p=>!p.getBuffer())&&o.warn("Skipped writing one or more Accessors: no Buffer assigned."),s.materials=n.listMaterials().map((p,R)=>{const g=a.createPropertyDef(p);if(p.getAlphaMode()!==ir.AlphaMode.OPAQUE&&(g.alphaMode=p.getAlphaMode()),p.getAlphaMode()===ir.AlphaMode.MASK&&(g.alphaCutoff=p.getAlphaCutoff()),p.getDoubleSided()&&(g.doubleSided=!0),g.pbrMetallicRoughness={},ve.eq(p.getBaseColorFactor(),[1,1,1,1])||(g.pbrMetallicRoughness.baseColorFactor=p.getBaseColorFactor()),ve.eq(p.getEmissiveFactor(),[0,0,0])||(g.emissiveFactor=p.getEmissiveFactor()),p.getRoughnessFactor()!==1&&(g.pbrMetallicRoughness.roughnessFactor=p.getRoughnessFactor()),p.getMetallicFactor()!==1&&(g.pbrMetallicRoughness.metallicFactor=p.getMetallicFactor()),p.getBaseColorTexture()){const y=p.getBaseColorTexture(),T=p.getBaseColorTextureInfo();g.pbrMetallicRoughness.baseColorTexture=a.createTextureInfoDef(y,T)}if(p.getEmissiveTexture()){const y=p.getEmissiveTexture(),T=p.getEmissiveTextureInfo();g.emissiveTexture=a.createTextureInfoDef(y,T)}if(p.getNormalTexture()){const y=p.getNormalTexture(),T=p.getNormalTextureInfo(),I=a.createTextureInfoDef(y,T);p.getNormalScale()!==1&&(I.scale=p.getNormalScale()),g.normalTexture=I}if(p.getOcclusionTexture()){const y=p.getOcclusionTexture(),T=p.getOcclusionTextureInfo(),I=a.createTextureInfoDef(y,T);p.getOcclusionStrength()!==1&&(I.strength=p.getOcclusionStrength()),g.occlusionTexture=I}if(p.getMetallicRoughnessTexture()){const y=p.getMetallicRoughnessTexture(),T=p.getMetallicRoughnessTextureInfo();g.pbrMetallicRoughness.metallicRoughnessTexture=a.createTextureInfoDef(y,T)}return a.materialIndexMap.set(p,R),g}),s.meshes=n.listMeshes().map((p,R)=>{const g=a.createPropertyDef(p);let y=null;return g.primitives=p.listPrimitives().map(T=>{const I={attributes:{}};I.mode=T.getMode();const _=T.getMaterial();_&&(I.material=a.materialIndexMap.get(_)),Object.keys(T.getExtras()).length&&(I.extras=T.getExtras());const U=T.getIndices();U&&(I.indices=a.accessorIndexMap.get(U));for(const $ of T.listSemantics())I.attributes[$]=a.accessorIndexMap.get(T.getAttribute($));for(const $ of T.listTargets()){const C={};for(const j of $.listSemantics())C[j]=a.accessorIndexMap.get($.getAttribute(j));I.targets=I.targets||[],I.targets.push(C)}return T.listTargets().length&&!y&&(y=T.listTargets().map($=>$.getName())),I}),p.getWeights().length&&(g.weights=p.getWeights()),y&&(g.extras=g.extras||{},g.extras.targetNames=y),a.meshIndexMap.set(p,R),g}),s.cameras=n.listCameras().map((p,R)=>{const g=a.createPropertyDef(p);if(g.type=p.getType(),g.type===Dr.Type.PERSPECTIVE){g.perspective={znear:p.getZNear(),zfar:p.getZFar(),yfov:p.getYFov()};const y=p.getAspectRatio();y!==null&&(g.perspective.aspectRatio=y)}else g.orthographic={znear:p.getZNear(),zfar:p.getZFar(),xmag:p.getXMag(),ymag:p.getYMag()};return a.cameraIndexMap.set(p,R),g}),s.nodes=n.listNodes().map((p,R)=>{const g=a.createPropertyDef(p);return ve.eq(p.getTranslation(),[0,0,0])||(g.translation=p.getTranslation()),ve.eq(p.getRotation(),[0,0,0,1])||(g.rotation=p.getRotation()),ve.eq(p.getScale(),[1,1,1])||(g.scale=p.getScale()),p.getWeights().length&&(g.weights=p.getWeights()),a.nodeIndexMap.set(p,R),g}),s.skins=n.listSkins().map((p,R)=>{const g=a.createPropertyDef(p),y=p.getInverseBindMatrices();y&&(g.inverseBindMatrices=a.accessorIndexMap.get(y));const T=p.getSkeleton();return T&&(g.skeleton=a.nodeIndexMap.get(T)),g.joints=p.listJoints().map(I=>a.nodeIndexMap.get(I)),a.skinIndexMap.set(p,R),g}),n.listNodes().forEach((p,R)=>{const g=s.nodes[R],y=p.getMesh();y&&(g.mesh=a.meshIndexMap.get(y));const T=p.getCamera();T&&(g.camera=a.cameraIndexMap.get(T));const I=p.getSkin();I&&(g.skin=a.skinIndexMap.get(I)),p.listChildren().length>0&&(g.children=p.listChildren().map(_=>a.nodeIndexMap.get(_)))}),s.animations=n.listAnimations().map((p,R)=>{const g=a.createPropertyDef(p),y=new Map;return g.samplers=p.listSamplers().map((T,I)=>{const _=a.createPropertyDef(T);return _.input=a.accessorIndexMap.get(T.getInput()),_.output=a.accessorIndexMap.get(T.getOutput()),_.interpolation=T.getInterpolation(),y.set(T,I),_}),g.channels=p.listChannels().map(T=>{const I=a.createPropertyDef(T);return I.sampler=y.get(T.getSampler()),I.target={node:a.nodeIndexMap.get(T.getTargetNode()),path:T.getTargetPath()},I}),a.animationIndexMap.set(p,R),g}),s.scenes=n.listScenes().map((p,R)=>{const g=a.createPropertyDef(p);return g.nodes=p.listChildren().map(y=>a.nodeIndexMap.get(y)),a.sceneIndexMap.set(p,R),g});const w=n.getDefaultScene();return w&&(s.scene=n.listScenes().indexOf(w)),s.extensionsUsed=u.map(p=>p.extensionName),s.extensionsRequired=h.map(p=>p.extensionName),u.forEach(p=>p.write(a)),function(p){const R=[];for(const g in p){const y=p[g];(Array.isArray(y)&&y.length===0||y===null||y===""||y&&typeof y=="object"&&Object.keys(y).length===0)&&R.push(g)}for(const g of R)delete p[g]}(s),i}};var cn;(function(t){t[t.JSON=1313821514]="JSON",t[t.BIN=5130562]="BIN"})(cn||(cn={}));let Df=class{constructor(){this.M=Bt.DEFAULT_INSTANCE,this.l=new Set,this.U={},this.P=sn.INTERLEAVED,this.lastReadBytes=0,this.lastWriteBytes=0}setLogger(e){return this.M=e,this}registerExtensions(e){for(const r of e)this.l.add(r),r.register();return this}registerDependencies(e){return Object.assign(this.U,e),this}setVertexLayout(e){return this.P=e,this}async read(e){return await this.readJSON(await this.readAsJSON(e))}async readAsJSON(e){const r=await this.readURI(e,"view");this.lastReadBytes=r.byteLength;const n=Ti(r)?this.L(r):{json:JSON.parse(Q.decodeText(r)),resources:{}};return await this.j(n,this.dirname(e)),this.D(n),n}async readJSON(e){return e=this._(e),this.D(e),Cf.read(e,{extensions:Array.from(this.l),dependencies:this.U,logger:this.M})}async binaryToJSON(e){const r=this.L(Q.assertView(e));this.D(r);const n=r.json;if(n.buffers&&n.buffers.some(s=>function(i,a){return a.uri!==void 0&&!(a.uri in i.resources)}(r,s)))throw new Error("Cannot resolve external buffers with binaryToJSON().");if(n.images&&n.images.some(s=>function(i,a){return a.uri!==void 0&&!(a.uri in i.resources)&&a.bufferView===void 0}(r,s)))throw new Error("Cannot resolve external images with binaryToJSON().");return r}async readBinary(e){return this.readJSON(await this.binaryToJSON(Q.assertView(e)))}async writeJSON(e,r={}){if(r.format===Lt.GLB&&e.getRoot().listBuffers().length>1)throw new Error("GLB must have 01 buffers.");return Ff.write(e,{format:r.format||Lt.GLTF,basename:r.basename||"",logger:this.M,vertexLayout:this.P,dependencies:Ue({},this.U),extensions:Array.from(this.l)})}async writeBinary(e){const{json:r,resources:n}=await this.writeJSON(e,{format:Lt.GLB}),s=new Uint32Array([1179937895,2,12]),i=JSON.stringify(r),a=Q.pad(Q.encodeText(i),32),o=Q.toView(new Uint32Array([a.byteLength,1313821514])),c=Q.concat([o,a]);s[s.length-1]+=c.byteLength;const u=Object.values(n)[0];if(!u||!u.byteLength)return Q.concat([Q.toView(s),c]);const h=Q.pad(u,0),d=Q.toView(new Uint32Array([h.byteLength,5130562])),m=Q.concat([d,h]);return s[s.length-1]+=m.byteLength,Q.concat([Q.toView(s),c,m])}async j(e,r){var n=this;const s=[...e.json.images||[],...e.json.buffers||[]].map(async function(i){const a=i.uri;if(!a||a.match(/data:/))return Promise.resolve();e.resources[a]=await n.readURI(n.resolve(r,a),"view"),n.lastReadBytes+=e.resources[a].byteLength});await Promise.all(s)}D(e){function r(n){if(n.uri){if(n.uri in e.resources)Q.assertView(e.resources[n.uri]);else if(n.uri.match(/data:/)){const s=`__${If()}.${sr.extension(n.uri)}`;e.resources[s]=Q.createBufferFromDataURI(n.uri),n.uri=s}}}(e.json.images||[]).forEach(n=>{if(n.bufferView===void 0&&n.uri===void 0)throw new Error("Missing resource URI or buffer view.");r(n)}),(e.json.buffers||[]).forEach(r)}_(e){const{images:r,buffers:n}=e.json;return e={json:Ue({},e.json),resources:Ue({},e.resources)},r&&(e.json.images=r.map(s=>Ue({},s))),n&&(e.json.buffers=n.map(s=>Ue({},s))),e}L(e){if(!Ti(e))throw new Error("Invalid glTF 2.0 binary.");const r=new Uint32Array(e.buffer,e.byteOffset+12,2);if(r[1]!==cn.JSON)throw new Error("Missing required GLB JSON chunk.");const n=r[0],s=Q.decodeText(Q.toView(e,20,n)),i=JSON.parse(s),a=20+n;if(e.byteLength<=a)return{json:i,resources:{}};const o=new Uint32Array(e.buffer,e.byteOffset+a,2);if(o[1]!==cn.BIN)throw new Error("Expected GLB BIN in second chunk.");const c=Q.toView(e,a+8,o[0]);return{json:i,resources:{[nr]:c}}}};function Ti(t){if(t.byteLength<3*Uint32Array.BYTES_PER_ELEMENT)return!1;const e=new Uint32Array(t.buffer,t.byteOffset,3);return e[0]===1179937895&&e[1]===2}let Pf=class extends Df{constructor(e=Ar.DEFAULT_INIT){super(),this.J=void 0,this.J=e}async readURI(e,r){const n=await fetch(e,this.J);switch(r){case"view":return new Uint8Array(await n.arrayBuffer());case"text":return n.text()}}resolve(e,r){return Ar.resolve(e,r)}dirname(e){return Ar.dirname(e)}};const Uf=0,Lf=0,Bf=0,Vf=2,jf=0,zf=163,kf=166,Gf=0,qf=2,Hf=1,Wf=64,Xf=0;class Yf{constructor(){this.vkFormat=Xf,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=Uf,this.levels=[],this.dataFormatDescriptor=[{vendorId:Bf,descriptorType:Lf,descriptorBlockSize:0,versionNumber:Vf,colorModel:jf,colorPrimaries:Hf,transferFunction:qf,flags:Gf,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class dr{constructor(e,r,n,s){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+r,n),this._littleEndian=s,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian),r=this._dataView.getUint32(this._offset+4,this._littleEndian),n=e+2**32*r;return this._offset+=8,n}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){const r=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,r}_skip(e){return this._offset+=e,this}_scan(e,r=0){const n=this._offset;let s=0;for(;this._dataView.getUint8(this._offset)!==r&&s<e;)s++,this._offset++;return s<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+n,s)}}const De=[171,75,84,88,32,50,48,187,13,10,26,10];function Mi(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Buffer.from(t).toString("utf8")}function Vn(t){const e=new Uint8Array(t.buffer,t.byteOffset,De.length);if(e[0]!==De[0]||e[1]!==De[1]||e[2]!==De[2]||e[3]!==De[3]||e[4]!==De[4]||e[5]!==De[5]||e[6]!==De[6]||e[7]!==De[7]||e[8]!==De[8]||e[9]!==De[9]||e[10]!==De[10]||e[11]!==De[11])throw new Error("Missing KTX 2.0 identifier.");const r=new Yf,n=17*Uint32Array.BYTES_PER_ELEMENT,s=new dr(t,De.length,n,!0);r.vkFormat=s._nextUint32(),r.typeSize=s._nextUint32(),r.pixelWidth=s._nextUint32(),r.pixelHeight=s._nextUint32(),r.pixelDepth=s._nextUint32(),r.layerCount=s._nextUint32(),r.faceCount=s._nextUint32();const i=s._nextUint32();r.supercompressionScheme=s._nextUint32();const a=s._nextUint32(),o=s._nextUint32(),c=s._nextUint32(),u=s._nextUint32(),h=s._nextUint64(),d=s._nextUint64(),m=i*3*8,x=new dr(t,De.length+n,m,!0);for(let ae=0;ae<i;ae++)r.levels.push({levelData:new Uint8Array(t.buffer,t.byteOffset+x._nextUint64(),x._nextUint64()),uncompressedByteLength:x._nextUint64()});const M=new dr(t,a,o,!0),w={vendorId:M._skip(4)._nextUint16(),descriptorType:M._nextUint16(),versionNumber:M._nextUint16(),descriptorBlockSize:M._nextUint16(),colorModel:M._nextUint8(),colorPrimaries:M._nextUint8(),transferFunction:M._nextUint8(),flags:M._nextUint8(),texelBlockDimension:[M._nextUint8(),M._nextUint8(),M._nextUint8(),M._nextUint8()],bytesPlane:[M._nextUint8(),M._nextUint8(),M._nextUint8(),M._nextUint8(),M._nextUint8(),M._nextUint8(),M._nextUint8(),M._nextUint8()],samples:[]},p=6,R=4,g=(w.descriptorBlockSize/4-p)/R;for(let ae=0;ae<g;ae++){const oe={bitOffset:M._nextUint16(),bitLength:M._nextUint8(),channelType:M._nextUint8(),samplePosition:[M._nextUint8(),M._nextUint8(),M._nextUint8(),M._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};oe.channelType&Wf?(oe.sampleLower=M._nextInt32(),oe.sampleUpper=M._nextInt32()):(oe.sampleLower=M._nextUint32(),oe.sampleUpper=M._nextUint32()),w.samples[ae]=oe}r.dataFormatDescriptor.length=0,r.dataFormatDescriptor.push(w);const y=new dr(t,c,u,!0);for(;y._offset<u;){const ae=y._nextUint32(),oe=y._scan(ae),le=Mi(oe);if(r.keyValue[le]=y._nextUint8Array(ae-oe.byteLength-1),le.match(/^ktx/i)){const ue=Mi(r.keyValue[le]);r.keyValue[le]=ue.substring(0,ue.lastIndexOf("\0"))}const Ae=ae%4?4-ae%4:0;y._skip(Ae)}if(d<=0)return r;const T=new dr(t,h,d,!0),I=T._nextUint16(),_=T._nextUint16(),U=T._nextUint32(),$=T._nextUint32(),C=T._nextUint32(),j=T._nextUint32(),V=[];for(let ae=0;ae<i;ae++)V.push({imageFlags:T._nextUint32(),rgbSliceByteOffset:T._nextUint32(),rgbSliceByteLength:T._nextUint32(),alphaSliceByteOffset:T._nextUint32(),alphaSliceByteLength:T._nextUint32()});const q=h+T._offset,L=q+U,D=L+$,X=D+C,te=new Uint8Array(t.buffer,t.byteOffset+q,U),J=new Uint8Array(t.buffer,t.byteOffset+L,$),ie=new Uint8Array(t.buffer,t.byteOffset+D,C),re=new Uint8Array(t.buffer,t.byteOffset+X,j);return r.globalData={endpointCount:I,selectorCount:_,imageDescs:V,endpointsData:te,selectorsData:J,tablesData:ie,extendedData:re},r}const gs="EXT_mesh_gpu_instancing",Zn="EXT_meshopt_compression",ca="KHR_draco_mesh_compression",ds="KHR_lights_punctual",ms="KHR_materials_anisotropy",vs="KHR_materials_clearcoat",xs="KHR_materials_emissive_strength",ys="KHR_materials_ior",Ts="KHR_materials_iridescence",Ms="KHR_materials_pbrSpecularGlossiness",Es="KHR_materials_sheen",Rs="KHR_materials_specular",ws="KHR_materials_transmission",Is="KHR_materials_unlit",As="KHR_materials_volume",kt="KHR_materials_variants",bs="KHR_texture_transform",ln="KHR_xmp_json_ld",Qn="INSTANCE_ATTRIBUTE";class la extends we{init(){this.extensionName=gs,this.propertyType="InstancedMesh",this.parentTypes=[G.NODE]}getDefaults(){return Object.assign(super.getDefaults(),{attributes:{}})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,r){return this.setRefMap("attributes",e,r,{usage:Qn})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}}la.EXTENSION_NAME=gs;const Rt=gs;class fa extends ge{constructor(...e){super(...e),this.extensionName=Rt,this.provideTypes=[G.NODE],this.prewriteTypes=[G.ACCESSOR]}createInstancedMesh(){return new la(this.document.getGraph())}read(e){return(e.jsonDoc.json.nodes||[]).forEach((r,n)=>{if(!r.extensions||!r.extensions[Rt])return;const s=r.extensions[Rt],i=this.createInstancedMesh();for(const a in s.attributes)i.setAttribute(a,e.accessors[s.attributes[a]]);e.nodes[n].setExtension(Rt,i)}),this}prewrite(e){e.accessorUsageGroupedByParent.add(Qn);for(const r of this.properties)for(const n of r.listAttributes())e.addAccessorToUsageGroup(n,Qn);return this}write(e){const r=e.jsonDoc;return this.document.getRoot().listNodes().forEach(n=>{const s=n.getExtension(Rt);if(s){const i=e.nodeIndexMap.get(n),a=r.json.nodes[i],o={attributes:{}};s.listSemantics().forEach(c=>{const u=s.getAttribute(c);o.attributes[c]=e.accessorIndexMap.get(u)}),a.extensions=a.extensions||{},a.extensions[Rt]=o}}),this}}function pt(){return pt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pt.apply(this,arguments)}var Or,er,Re;fa.EXTENSION_NAME=Rt,function(t){t.QUANTIZE="quantize",t.FILTER="filter"}(Or||(Or={})),function(t){t.ATTRIBUTES="ATTRIBUTES",t.TRIANGLES="TRIANGLES",t.INDICES="INDICES"}(er||(er={})),function(t){t.NONE="NONE",t.OCTAHEDRAL="OCTAHEDRAL",t.QUATERNION="QUATERNION",t.EXPONENTIAL="EXPONENTIAL"}(Re||(Re={}));const{BYTE:Kf,SHORT:Ei,FLOAT:Jf}=Y.ComponentType,{encodeNormalizedInt:Ri,decodeNormalizedInt:jn}=ve;function Zf(t,e,r,n){const{filter:s,bits:i}=n,a={array:t.getArray(),byteStride:t.getElementSize()*t.getComponentSize(),componentType:t.getComponentType(),normalized:t.getNormalized()};if(r!==er.ATTRIBUTES)return a;if(s!==Re.NONE){let o=t.getNormalized()?function(c){const u=c.getComponentType(),h=c.getArray(),d=new Float32Array(h.length);for(let m=0;m<h.length;m++)d[m]=jn(h[m],u);return d}(t):new Float32Array(a.array);switch(s){case Re.EXPONENTIAL:a.byteStride=4*t.getElementSize(),a.componentType=Jf,a.normalized=!1,a.array=e.encodeFilterExp(o,t.getCount(),a.byteStride,i);break;case Re.OCTAHEDRAL:a.byteStride=i>8?8:4,a.componentType=i>8?Ei:Kf,a.normalized=!0,o=t.getElementSize()===3?function(c){const u=new Float32Array(4*c.length/3);for(let h=0,d=c.length/3;h<d;h++)u[4*h]=c[3*h],u[4*h+1]=c[3*h+1],u[4*h+2]=c[3*h+2];return u}(o):o,a.array=e.encodeFilterOct(o,t.getCount(),a.byteStride,i);break;case Re.QUATERNION:a.byteStride=8,a.componentType=Ei,a.normalized=!0,a.array=e.encodeFilterQuat(o,t.getCount(),a.byteStride,i);break;default:throw new Error("Invalid filter.")}a.min=t.getMin([]),a.max=t.getMax([]),t.getNormalized()&&(a.min=a.min.map(c=>jn(c,t.getComponentType())),a.max=a.max.map(c=>jn(c,t.getComponentType()))),a.normalized&&(a.min=a.min.map(c=>Ri(c,a.componentType)),a.max=a.max.map(c=>Ri(c,a.componentType)))}else a.byteStride%4&&(a.array=function(o,c){const u=Q.padNumber(o.BYTES_PER_ELEMENT*c)/o.BYTES_PER_ELEMENT,h=new o.constructor(o.length/c*u);for(let d=0;d*c<o.length;d++)for(let m=0;m<c;m++)h[d*u+m]=o[d*c+m];return h}(a.array,t.getElementSize()),a.byteStride=a.array.byteLength/t.getCount());return a}function Qf(t,e){return e===et.BufferViewUsage.ELEMENT_ARRAY_BUFFER?t.listParents().some(r=>r instanceof Nr&&r.getMode()===Nr.Mode.TRIANGLES)?er.TRIANGLES:er.INDICES:er.ATTRIBUTES}function eu(t,e){const r=e.getGraph().listParentEdges(t).filter(n=>!(n.getParent()instanceof oa));for(const n of r){const s=n.getName(),i=n.getAttributes().key||"",a=n.getParent().propertyType===G.PRIMITIVE_TARGET;if(s==="indices")return{filter:Re.NONE};if(s==="attributes"){if(i==="POSITION")return{filter:Re.NONE};if(i==="TEXCOORD_0")return{filter:Re.NONE};if(i.startsWith("JOINTS_"))return{filter:Re.NONE};if(i.startsWith("WEIGHTS_"))return{filter:Re.NONE};if(i==="NORMAL"||i==="TANGENT")return a?{filter:Re.NONE}:{filter:Re.OCTAHEDRAL,bits:8}}if(s==="output"){const o=ua(t);return o==="rotation"?{filter:Re.QUATERNION,bits:16}:o==="translation"||o==="scale"?{filter:Re.EXPONENTIAL,bits:12}:{filter:Re.NONE}}if(s==="input")return{filter:Re.NONE};if(s==="inverseBindMatrices")return{filter:Re.NONE}}return{filter:Re.NONE}}function ua(t){for(const e of t.listParents())if(e instanceof vn){for(const r of e.listParents())if(r instanceof hs)return r.getTargetPath()}return null}const Pe=Zn,wi={method:Or.QUANTIZE};class es extends ge{constructor(...e){super(...e),this.extensionName=Pe,this.prereadTypes=[G.BUFFER,G.PRIMITIVE],this.prewriteTypes=[G.BUFFER,G.ACCESSOR],this.readDependencies=["meshopt.decoder"],this.writeDependencies=["meshopt.encoder"],this._decoder=null,this._decoderFallbackBufferMap=new Map,this._encoder=null,this._encoderOptions=wi,this._encoderFallbackBuffer=null,this._encoderBufferViews={},this._encoderBufferViewData={},this._encoderBufferViewAccessors={}}install(e,r){return e==="meshopt.decoder"&&(this._decoder=r),e==="meshopt.encoder"&&(this._encoder=r),this}setEncoderOptions(e){return this._encoderOptions=pt({},wi,e),this}preread(e,r){if(!this._decoder){if(!this.isRequired())return this;throw new Error(`[${Pe}] Please install extension dependency, "meshopt.decoder".`)}if(!this._decoder.supported){if(!this.isRequired())return this;throw new Error(`[${Pe}]: Missing WASM support.`)}return r===G.BUFFER?this._prereadBuffers(e):r===G.PRIMITIVE&&this._prereadPrimitives(e),this}_prereadBuffers(e){const r=e.jsonDoc;(r.json.bufferViews||[]).forEach((n,s)=>{if(!n.extensions||!n.extensions[Pe])return;const i=n.extensions[Pe],a=i.byteOffset||0,o=i.byteLength||0,c=i.count,u=i.byteStride,h=new Uint8Array(c*u),d=r.json.buffers[i.buffer],m=Q.toView(d.uri?r.resources[d.uri]:r.resources[nr],a,o);this._decoder.decodeGltfBuffer(h,c,u,m,i.mode,i.filter),e.bufferViews[s]=h})}_prereadPrimitives(e){const r=e.jsonDoc;(r.json.bufferViews||[]).forEach(n=>{var s;n.extensions&&n.extensions[Pe]&&(s=r.json.buffers[n.buffer]).extensions&&s.extensions[Zn]&&s.extensions[Zn].fallback&&this._decoderFallbackBufferMap.set(e.buffers[n.buffer],e.buffers[n.extensions[Pe].buffer])})}read(e){if(!this.isRequired())return this;for(const[r,n]of this._decoderFallbackBufferMap){for(const s of r.listParents())s instanceof Y&&s.swap(r,n);r.dispose()}return this}prewrite(e,r){return r===G.ACCESSOR?this._prewriteAccessors(e):r===G.BUFFER&&this._prewriteBuffers(e),this}_prewriteAccessors(e){const r=e.jsonDoc.json,n=this._encoder,s=this._encoderOptions,i=this.document.createBuffer(),a=this.document.getRoot().listBuffers().indexOf(i);this._encoderFallbackBuffer=i,this._encoderBufferViews={},this._encoderBufferViewData={},this._encoderBufferViewAccessors={};for(const o of this.document.getRoot().listAccessors()){if(ua(o)==="weights"||o.getSparse())continue;const c=e.getAccessorUsage(o),u=Qf(o,c),h=s.method===Or.FILTER?eu(o,this.document):{filter:Re.NONE},d=Zf(o,n,u,h),{array:m,byteStride:x}=d,M=o.getBuffer();if(!M)throw new Error(`${Pe}: Missing buffer for accessor.`);const w=this.document.getRoot().listBuffers().indexOf(M),p=[c,u,h.filter,x,w].join(":");let R=this._encoderBufferViews[p],g=this._encoderBufferViewData[p],y=this._encoderBufferViewAccessors[p];R&&g||(y=this._encoderBufferViewAccessors[p]=[],g=this._encoderBufferViewData[p]=[],R=this._encoderBufferViews[p]={buffer:a,target:et.USAGE_TO_TARGET[c],byteOffset:0,byteLength:0,byteStride:c===et.BufferViewUsage.ARRAY_BUFFER?x:void 0,extensions:{[Pe]:{buffer:w,byteOffset:0,byteLength:0,mode:u,filter:h.filter!==Re.NONE?h.filter:void 0,byteStride:x,count:0}}});const T=e.createAccessorDef(o);T.componentType=d.componentType,T.normalized=d.normalized,T.byteOffset=R.byteLength,T.min&&d.min&&(T.min=d.min),T.max&&d.max&&(T.max=d.max),e.accessorIndexMap.set(o,r.accessors.length),r.accessors.push(T),y.push(T),g.push(new Uint8Array(m.buffer,m.byteOffset,m.byteLength)),R.byteLength+=m.byteLength,R.extensions.EXT_meshopt_compression.count+=o.getCount()}}_prewriteBuffers(e){const r=this._encoder;for(const n in this._encoderBufferViews){const s=this._encoderBufferViews[n],i=this._encoderBufferViewData[n],a=this.document.getRoot().listBuffers()[s.extensions[Pe].buffer],o=e.otherBufferViews.get(a)||[],{count:c,byteStride:u,mode:h}=s.extensions[Pe],d=Q.concat(i),m=r.encodeGltfBuffer(d,c,u,h),x=Q.pad(m);s.extensions[Pe].byteLength=m.byteLength,i.length=0,i.push(x),o.push(x),e.otherBufferViews.set(a,o)}}write(e){let r=0;for(const a in this._encoderBufferViews){const o=this._encoderBufferViews[a],c=e.otherBufferViewsIndexMap.get(this._encoderBufferViewData[a][0]),u=this._encoderBufferViewAccessors[a];for(const m of u)m.bufferView=c;const h=e.jsonDoc.json.bufferViews[c],d=h.byteOffset||0;Object.assign(h,o),h.byteOffset=r,h.extensions[Pe].byteOffset=d,r+=Q.padNumber(o.byteLength)}const n=this._encoderFallbackBuffer,s=e.bufferIndexMap.get(n),i=e.jsonDoc.json.buffers[s];return i.byteLength=r,i.extensions={[Pe]:{fallback:!0}},n.dispose(),this}}es.EXTENSION_NAME=Pe,es.EncoderMethod=Or;const Er="EXT_texture_avif";class tu{match(e){return e.length>=12&&Q.decodeText(e.slice(4,12))==="ftypavif"}getSize(e){if(!this.match(e))return null;const r=new DataView(e.buffer,e.byteOffset,e.byteLength);let n=Ii(r,0);if(!n)return null;let s=n.end;for(;n=Ii(r,s);)if(n.type==="meta")s=n.start+4;else if(n.type==="iprp"||n.type==="ipco")s=n.start;else{if(n.type==="ispe")return[r.getUint32(n.start+4),r.getUint32(n.start+8)];if(n.type==="mdat")break;s=n.end}return null}getChannels(e){return 4}}class ha extends ge{constructor(...e){super(...e),this.extensionName=Er,this.prereadTypes=[G.TEXTURE]}static register(){ct.registerFormat("image/avif",new tu)}preread(e){return(e.jsonDoc.json.textures||[]).forEach(r=>{r.extensions&&r.extensions[Er]&&(r.source=r.extensions[Er].source)}),this}read(e){return this}write(e){const r=e.jsonDoc;return this.document.getRoot().listTextures().forEach(n=>{if(n.getMimeType()==="image/avif"){const s=e.imageIndexMap.get(n);(r.json.textures||[]).forEach(i=>{i.source===s&&(i.extensions=i.extensions||{},i.extensions[Er]={source:i.source},delete i.source)})}}),this}}function Ii(t,e){if(t.byteLength<4+e)return null;const r=t.getUint32(e);return t.byteLength<r+e||r<8?null:{type:Q.decodeText(new Uint8Array(t.buffer,t.byteOffset+e+4,4)),start:e+8,end:e+r}}ha.EXTENSION_NAME=Er;const Rr="EXT_texture_webp";class ru{match(e){return e.length>=12&&e[8]===87&&e[9]===69&&e[10]===66&&e[11]===80}getSize(e){const r=Q.decodeText(e.slice(0,4)),n=Q.decodeText(e.slice(8,12));if(r!=="RIFF"||n!=="WEBP")return null;const s=new DataView(e.buffer,e.byteOffset);let i=12;for(;i<s.byteLength;){const a=Q.decodeText(new Uint8Array([s.getUint8(i),s.getUint8(i+1),s.getUint8(i+2),s.getUint8(i+3)])),o=s.getUint32(i+4,!0);if(a==="VP8 ")return[16383&s.getInt16(i+14,!0),16383&s.getInt16(i+16,!0)];if(a==="VP8L"){const c=s.getUint8(i+9),u=s.getUint8(i+10),h=s.getUint8(i+11);return[1+((63&u)<<8|c),1+((15&s.getUint8(i+12))<<10|h<<2|(192&u)>>6)]}i+=8+o+o%2}return null}getChannels(e){return 4}}class pa extends ge{constructor(...e){super(...e),this.extensionName=Rr,this.prereadTypes=[G.TEXTURE]}static register(){ct.registerFormat("image/webp",new ru)}preread(e){return(e.jsonDoc.json.textures||[]).forEach(r=>{r.extensions&&r.extensions[Rr]&&(r.source=r.extensions[Rr].source)}),this}read(e){return this}write(e){const r=e.jsonDoc;return this.document.getRoot().listTextures().forEach(n=>{if(n.getMimeType()==="image/webp"){const s=e.imageIndexMap.get(n);(r.json.textures||[]).forEach(i=>{i.source===s&&(i.extensions=i.extensions||{},i.extensions[Rr]={source:i.source},delete i.source)})}}),this}}pa.EXTENSION_NAME=Rr;const Ai=ca;let _e,ga,da,qe;function nu(t,e){const r=new _e.DecoderBuffer;try{if(r.Init(e,e.length),t.GetEncodedGeometryType(r)!==_e.TRIANGULAR_MESH)throw new Error(`[${Ai}] Unknown geometry type.`);const n=new _e.Mesh;if(!t.DecodeBufferToMesh(r,n).ok()||n.ptr===0)throw new Error(`[${Ai}] Decoding failure.`);return n}finally{_e.destroy(r)}}function su(t,e){const r=3*e.num_faces();let n,s;if(e.num_points()<=65534){const i=r*Uint16Array.BYTES_PER_ELEMENT;n=_e._malloc(i),t.GetTrianglesUInt16Array(e,i,n),s=new Uint16Array(_e.HEAPU16.buffer,n,r).slice()}else{const i=r*Uint32Array.BYTES_PER_ELEMENT;n=_e._malloc(i),t.GetTrianglesUInt32Array(e,i,n),s=new Uint32Array(_e.HEAPU32.buffer,n,r).slice()}return _e._free(n),s}function iu(t,e,r,n){const s=da[n.componentType],i=ga[n.componentType],a=r.num_components(),o=e.num_points()*a,c=o*i.BYTES_PER_ELEMENT,u=_e._malloc(c);t.GetAttributeDataArrayForAllPoints(e,r,s,c,u);const h=new i(_e.HEAPF32.buffer,u,o).slice();return _e._free(u),h}var $r,He;(function(t){t[t.EDGEBREAKER=1]="EDGEBREAKER",t[t.SEQUENTIAL=0]="SEQUENTIAL"})($r||($r={})),function(t){t.POSITION="POSITION",t.NORMAL="NORMAL",t.COLOR="COLOR",t.TEX_COORD="TEX_COORD",t.GENERIC="GENERIC"}(He||(He={}));const ma={[He.POSITION]:14,[He.NORMAL]:10,[He.COLOR]:8,[He.TEX_COORD]:12,[He.GENERIC]:12},bi={decodeSpeed:5,encodeSpeed:5,method:$r.EDGEBREAKER,quantizationBits:ma,quantizationVolume:"mesh"};function au(t,e=bi){const r=pt({},bi,e);r.quantizationBits=pt({},ma,e.quantizationBits);const n=new qe.MeshBuilder,s=new qe.Mesh,i=new qe.ExpertEncoder(s),a={},o=new qe.DracoInt8Array,c=t.listTargets().length>0;let u=!1;for(const w of t.listSemantics()){const p=t.getAttribute(w);if(p.getSparse()){u=!0;continue}const R=ou(w),g=cu(n,p.getComponentType(),s,qe[R],p.getCount(),p.getElementSize(),p.getArray());if(g===-1)throw new Error(`Error compressing "${w}" attribute.`);if(a[w]=g,r.quantizationVolume==="mesh"||w!=="POSITION")i.SetAttributeQuantization(g,r.quantizationBits[R]);else{if(typeof r.quantizationVolume!="object")throw new Error("Invalid quantization volume state.");{const{quantizationVolume:y}=r,T=Math.max(y.max[0]-y.min[0],y.max[1]-y.min[1],y.max[2]-y.min[2]);i.SetAttributeExplicitQuantization(g,r.quantizationBits[R],p.getElementSize(),y.min,T)}}}const h=t.getIndices();if(!h)throw new ts("Primitive must have indices.");n.AddFacesToMesh(s,h.getCount()/3,h.getArray()),i.SetSpeedOptions(r.encodeSpeed,r.decodeSpeed),i.SetTrackEncodedProperties(!0),i.SetEncodingMethod(r.method===$r.SEQUENTIAL||c||u?qe.MESH_SEQUENTIAL_ENCODING:qe.MESH_EDGEBREAKER_ENCODING);const d=i.EncodeToDracoBuffer(!(c||u),o);if(d<=0)throw new ts("Error applying Draco compression.");const m=new Uint8Array(d);for(let w=0;w<d;++w)m[w]=o.GetValue(w);const x=i.GetNumberOfEncodedPoints(),M=3*i.GetNumberOfEncodedFaces();return qe.destroy(o),qe.destroy(s),qe.destroy(n),qe.destroy(i),{numVertices:x,numIndices:M,data:m,attributeIDs:a}}function ou(t){return t==="POSITION"?He.POSITION:t==="NORMAL"?He.NORMAL:t.startsWith("COLOR_")?He.COLOR:t.startsWith("TEXCOORD_")?He.TEX_COORD:He.GENERIC}function cu(t,e,r,n,s,i,a){switch(e){case Y.ComponentType.UNSIGNED_BYTE:return t.AddUInt8Attribute(r,n,s,i,a);case Y.ComponentType.BYTE:return t.AddInt8Attribute(r,n,s,i,a);case Y.ComponentType.UNSIGNED_SHORT:return t.AddUInt16Attribute(r,n,s,i,a);case Y.ComponentType.SHORT:return t.AddInt16Attribute(r,n,s,i,a);case Y.ComponentType.UNSIGNED_INT:return t.AddUInt32Attribute(r,n,s,i,a);case Y.ComponentType.FLOAT:return t.AddFloatAttribute(r,n,s,i,a);default:throw new Error(`Unexpected component type, "${e}".`)}}class ts extends Error{}const Ee=ca;class rs extends ge{constructor(...e){super(...e),this.extensionName=Ee,this.prereadTypes=[G.PRIMITIVE],this.prewriteTypes=[G.ACCESSOR],this.readDependencies=["draco3d.decoder"],this.writeDependencies=["draco3d.encoder"],this._decoderModule=null,this._encoderModule=null,this._encoderOptions={}}install(e,r){return e==="draco3d.decoder"&&(this._decoderModule=r,_e=this._decoderModule,ga={[Y.ComponentType.FLOAT]:Float32Array,[Y.ComponentType.UNSIGNED_INT]:Uint32Array,[Y.ComponentType.UNSIGNED_SHORT]:Uint16Array,[Y.ComponentType.UNSIGNED_BYTE]:Uint8Array,[Y.ComponentType.SHORT]:Int16Array,[Y.ComponentType.BYTE]:Int8Array},da={[Y.ComponentType.FLOAT]:_e.DT_FLOAT32,[Y.ComponentType.UNSIGNED_INT]:_e.DT_UINT32,[Y.ComponentType.UNSIGNED_SHORT]:_e.DT_UINT16,[Y.ComponentType.UNSIGNED_BYTE]:_e.DT_UINT8,[Y.ComponentType.SHORT]:_e.DT_INT16,[Y.ComponentType.BYTE]:_e.DT_INT8}),e==="draco3d.encoder"&&(this._encoderModule=r,qe=this._encoderModule),this}setEncoderOptions(e){return this._encoderOptions=e,this}preread(e){if(!this._decoderModule)throw new Error(`[${Ee}] Please install extension dependency, "draco3d.decoder".`);const r=this.document.getLogger(),n=e.jsonDoc,s=new Map;try{const i=n.json.meshes||[];for(const a of i)for(const o of a.primitives){if(!o.extensions||!o.extensions[Ee])continue;const c=o.extensions[Ee];let[u,h]=s.get(c.bufferView)||[];if(!h||!u){const d=n.json.bufferViews[c.bufferView],m=n.json.buffers[d.buffer],x=Q.toView(m.uri?n.resources[m.uri]:n.resources[nr],d.byteOffset||0,d.byteLength);u=new this._decoderModule.Decoder,h=nu(u,x),s.set(c.bufferView,[u,h]),r.debug(`[${Ee}] Decompressed ${x.byteLength} bytes.`)}for(const d in o.attributes){const m=e.jsonDoc.json.accessors[o.attributes[d]],x=u.GetAttributeByUniqueId(h,c.attributes[d]),M=iu(u,h,x,m);e.accessors[o.attributes[d]].setArray(M)}o.indices!==void 0&&e.accessors[o.indices].setArray(su(u,h))}}finally{for(const[i,a]of Array.from(s.values()))this._decoderModule.destroy(i),this._decoderModule.destroy(a)}return this}read(e){return this}prewrite(e,r){if(!this._encoderModule)throw new Error(`[${Ee}] Please install extension dependency, "draco3d.encoder".`);const n=this.document.getLogger();n.debug(`[${Ee}] Compression options: ${JSON.stringify(this._encoderOptions)}`);const s=function(o){const c=o.getLogger(),u=new Set,h=new Set;for(const p of o.getRoot().listMeshes())for(const R of p.listPrimitives())R.getIndices()?R.getMode()!==Nr.Mode.TRIANGLES?(h.add(R),c.warn(`[${Ee}] Skipping Draco compression on non-TRIANGLES primitive.`)):u.add(R):(h.add(R),c.warn(`[${Ee}] Skipping Draco compression on non-indexed primitive.`));const d=o.getRoot().listAccessors(),m=new Map;for(let p=0;p<d.length;p++)m.set(d[p],p);const x=new Map,M=new Set,w=new Map;for(const p of Array.from(u)){let R=_i(p,m);if(M.has(R))w.set(p,R);else{if(x.has(p.getIndices())){const g=p.getIndices(),y=g.clone();m.set(y,o.getRoot().listAccessors().length-1),p.swap(g,y)}for(const g of p.listAttributes())if(x.has(g)){const y=g.clone();m.set(y,o.getRoot().listAccessors().length-1),p.swap(g,y)}R=_i(p,m),M.add(R),w.set(p,R),x.set(p.getIndices(),R);for(const g of p.listAttributes())x.set(g,R)}}for(const p of Array.from(x.keys())){const R=new Set(p.listParents().map(g=>g.propertyType));if(R.size!==2||!R.has(G.PRIMITIVE)||!R.has(G.ROOT))throw new Error(`[${Ee}] Compressed accessors must only be used as indices or vertex attributes.`)}for(const p of Array.from(u)){const R=w.get(p),g=p.getIndices();if(x.get(g)!==R||p.listAttributes().some(y=>x.get(y)!==R))throw new Error(`[${Ee}] Draco primitives must share all, or no, accessors.`)}for(const p of Array.from(h)){const R=p.getIndices();if(x.has(R)||p.listAttributes().some(g=>x.has(g)))throw new Error(`[${Ee}] Accessor cannot be shared by compressed and uncompressed primitives.`)}return w}(this.document),i=new Map;let a="mesh";this._encoderOptions.quantizationVolume==="scene"&&(this.document.getRoot().listScenes().length!==1?n.warn(`[${Ee}]: quantizationVolume=scene requires exactly 1 scene.`):a=vf(this.document.getRoot().listScenes().pop()));for(const o of Array.from(s.keys())){const c=s.get(o);if(!c)throw new Error("Unexpected primitive.");if(i.has(c)){i.set(c,i.get(c));continue}const u=o.getIndices(),h=e.jsonDoc.json.accessors;let d;try{d=au(o,pt({},this._encoderOptions,{quantizationVolume:a}))}catch(M){if(M instanceof ts){n.warn(`[${Ee}]: ${M.message} Skipping primitive compression.`);continue}throw M}i.set(c,d);const m=e.createAccessorDef(u);m.count=d.numIndices,e.accessorIndexMap.set(u,h.length),h.push(m);for(const M of o.listSemantics()){const w=o.getAttribute(M);if(d.attributeIDs[M]===void 0)continue;const p=e.createAccessorDef(w);p.count=d.numVertices,e.accessorIndexMap.set(w,h.length),h.push(p)}const x=o.getAttribute("POSITION").getBuffer()||this.document.getRoot().listBuffers()[0];e.otherBufferViews.has(x)||e.otherBufferViews.set(x,[]),e.otherBufferViews.get(x).push(d.data)}return n.debug(`[${Ee}] Compressed ${s.size} primitives.`),e.extensionData[Ee]={primitiveHashMap:s,primitiveEncodingMap:i},this}write(e){const r=e.extensionData[Ee];for(const n of this.document.getRoot().listMeshes()){const s=e.jsonDoc.json.meshes[e.meshIndexMap.get(n)];for(let i=0;i<n.listPrimitives().length;i++){const a=n.listPrimitives()[i],o=s.primitives[i],c=r.primitiveHashMap.get(a);if(!c)continue;const u=r.primitiveEncodingMap.get(c);u&&(o.extensions=o.extensions||{},o.extensions[Ee]={bufferView:e.otherBufferViewsIndexMap.get(u.data),attributes:u.attributeIDs})}}if(!r.primitiveHashMap.size){const n=e.jsonDoc.json;n.extensionsUsed=(n.extensionsUsed||[]).filter(s=>s!==Ee),n.extensionsRequired=(n.extensionsRequired||[]).filter(s=>s!==Ee)}return this}}function _i(t,e){const r=[],n=t.getIndices();r.push(e.get(n));for(const s of t.listAttributes())r.push(e.get(s));return r.sort().join("|")}rs.EXTENSION_NAME=Ee,rs.EncoderMethod=$r;class ar extends we{init(){this.extensionName=ds,this.propertyType="Light",this.parentTypes=[G.NODE]}getDefaults(){return Object.assign(super.getDefaults(),{color:[1,1,1],intensity:1,type:ar.Type.POINT,range:null,innerConeAngle:0,outerConeAngle:Math.PI/4})}getColor(){return this.get("color")}setColor(e){return this.set("color",e)}getColorHex(){return Ve.factorToHex(this.getColor())}setColorHex(e){const r=this.getColor().slice();return Ve.hexToFactor(e,r),this.setColor(r)}getIntensity(){return this.get("intensity")}setIntensity(e){return this.set("intensity",e)}getType(){return this.get("type")}setType(e){return this.set("type",e)}getRange(){return this.get("range")}setRange(e){return this.set("range",e)}getInnerConeAngle(){return this.get("innerConeAngle")}setInnerConeAngle(e){return this.set("innerConeAngle",e)}getOuterConeAngle(){return this.get("outerConeAngle")}setOuterConeAngle(e){return this.set("outerConeAngle",e)}}ar.EXTENSION_NAME=ds,ar.Type={POINT:"point",SPOT:"spot",DIRECTIONAL:"directional"};const it=ds;class va extends ge{constructor(...e){super(...e),this.extensionName=it}createLight(e=""){return new ar(this.document.getGraph(),e)}read(e){const r=e.jsonDoc;if(!r.json.extensions||!r.json.extensions[it])return this;const n=(r.json.extensions[it].lights||[]).map(s=>{var i,a;const o=this.createLight().setName(s.name||"").setType(s.type);return s.color!==void 0&&o.setColor(s.color),s.intensity!==void 0&&o.setIntensity(s.intensity),s.range!==void 0&&o.setRange(s.range),((i=s.spot)==null?void 0:i.innerConeAngle)!==void 0&&o.setInnerConeAngle(s.spot.innerConeAngle),((a=s.spot)==null?void 0:a.outerConeAngle)!==void 0&&o.setOuterConeAngle(s.spot.outerConeAngle),o});return r.json.nodes.forEach((s,i)=>{s.extensions&&s.extensions[it]&&e.nodes[i].setExtension(it,n[s.extensions[it].light])}),this}write(e){const r=e.jsonDoc;if(this.properties.size===0)return this;const n=[],s=new Map;for(const i of this.properties){const a=i,o={type:a.getType()};ve.eq(a.getColor(),[1,1,1])||(o.color=a.getColor()),a.getIntensity()!==1&&(o.intensity=a.getIntensity()),a.getRange()!=null&&(o.range=a.getRange()),a.getName()&&(o.name=a.getName()),a.getType()===ar.Type.SPOT&&(o.spot={innerConeAngle:a.getInnerConeAngle(),outerConeAngle:a.getOuterConeAngle()}),n.push(o),s.set(a,n.length-1)}return this.document.getRoot().listNodes().forEach(i=>{const a=i.getExtension(it);if(a){const o=e.nodeIndexMap.get(i),c=r.json.nodes[o];c.extensions=c.extensions||{},c.extensions[it]={light:s.get(a)}}}),r.json.extensions=r.json.extensions||{},r.json.extensions[it]={lights:n},this}}va.EXTENSION_NAME=it;const{R:lu,G:fu,B:uu}=tt;class xa extends we{init(){this.extensionName=ms,this.propertyType="Anisotropy",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{anisotropyStrength:0,anisotropyRotation:0,anisotropyTexture:null,anisotropyTextureInfo:new ye(this.graph,"anisotropyTextureInfo")})}getAnisotropyStrength(){return this.get("anisotropyStrength")}setAnisotropyStrength(e){return this.set("anisotropyStrength",e)}getAnisotropyRotation(){return this.get("anisotropyRotation")}setAnisotropyRotation(e){return this.set("anisotropyRotation",e)}getAnisotropyTexture(){return this.getRef("anisotropyTexture")}getAnisotropyTextureInfo(){return this.getRef("anisotropyTexture")?this.getRef("anisotropyTextureInfo"):null}setAnisotropyTexture(e){return this.setRef("anisotropyTexture",e,{channels:lu|fu|uu})}}xa.EXTENSION_NAME=ms;const wt=ms;class ya extends ge{constructor(...e){super(...e),this.extensionName=wt}createAnisotropy(){return new xa(this.document.getGraph())}read(e){const r=e.jsonDoc,n=r.json.textures||[];return(r.json.materials||[]).forEach((s,i)=>{if(s.extensions&&s.extensions[wt]){const a=this.createAnisotropy();e.materials[i].setExtension(wt,a);const o=s.extensions[wt];if(o.anisotropyStrength!==void 0&&a.setAnisotropyStrength(o.anisotropyStrength),o.anisotropyRotation!==void 0&&a.setAnisotropyRotation(o.anisotropyRotation),o.anisotropyTexture!==void 0){const c=o.anisotropyTexture;a.setAnisotropyTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getAnisotropyTextureInfo(),c)}}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension(wt);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{};const o=a.extensions[wt]={};if(s.getAnisotropyStrength()>0&&(o.anisotropyStrength=s.getAnisotropyStrength()),s.getAnisotropyRotation()!==0&&(o.anisotropyRotation=s.getAnisotropyRotation()),s.getAnisotropyTexture()){const c=s.getAnisotropyTexture(),u=s.getAnisotropyTextureInfo();o.anisotropyTexture=e.createTextureInfoDef(c,u)}}}),this}}ya.EXTENSION_NAME=wt;const{R:Si,G:Ci,B:hu}=tt;class Ta extends we{init(){this.extensionName=vs,this.propertyType="Clearcoat",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{clearcoatFactor:0,clearcoatTexture:null,clearcoatTextureInfo:new ye(this.graph,"clearcoatTextureInfo"),clearcoatRoughnessFactor:0,clearcoatRoughnessTexture:null,clearcoatRoughnessTextureInfo:new ye(this.graph,"clearcoatRoughnessTextureInfo"),clearcoatNormalScale:1,clearcoatNormalTexture:null,clearcoatNormalTextureInfo:new ye(this.graph,"clearcoatNormalTextureInfo")})}getClearcoatFactor(){return this.get("clearcoatFactor")}setClearcoatFactor(e){return this.set("clearcoatFactor",e)}getClearcoatTexture(){return this.getRef("clearcoatTexture")}getClearcoatTextureInfo(){return this.getRef("clearcoatTexture")?this.getRef("clearcoatTextureInfo"):null}setClearcoatTexture(e){return this.setRef("clearcoatTexture",e,{channels:Si})}getClearcoatRoughnessFactor(){return this.get("clearcoatRoughnessFactor")}setClearcoatRoughnessFactor(e){return this.set("clearcoatRoughnessFactor",e)}getClearcoatRoughnessTexture(){return this.getRef("clearcoatRoughnessTexture")}getClearcoatRoughnessTextureInfo(){return this.getRef("clearcoatRoughnessTexture")?this.getRef("clearcoatRoughnessTextureInfo"):null}setClearcoatRoughnessTexture(e){return this.setRef("clearcoatRoughnessTexture",e,{channels:Ci})}getClearcoatNormalScale(){return this.get("clearcoatNormalScale")}setClearcoatNormalScale(e){return this.set("clearcoatNormalScale",e)}getClearcoatNormalTexture(){return this.getRef("clearcoatNormalTexture")}getClearcoatNormalTextureInfo(){return this.getRef("clearcoatNormalTexture")?this.getRef("clearcoatNormalTextureInfo"):null}setClearcoatNormalTexture(e){return this.setRef("clearcoatNormalTexture",e,{channels:Si|Ci|hu})}}Ta.EXTENSION_NAME=vs;const It=vs;class Ma extends ge{constructor(...e){super(...e),this.extensionName=It}createClearcoat(){return new Ta(this.document.getGraph())}read(e){const r=e.jsonDoc,n=r.json.textures||[];return(r.json.materials||[]).forEach((s,i)=>{if(s.extensions&&s.extensions[It]){const a=this.createClearcoat();e.materials[i].setExtension(It,a);const o=s.extensions[It];if(o.clearcoatFactor!==void 0&&a.setClearcoatFactor(o.clearcoatFactor),o.clearcoatRoughnessFactor!==void 0&&a.setClearcoatRoughnessFactor(o.clearcoatRoughnessFactor),o.clearcoatTexture!==void 0){const c=o.clearcoatTexture;a.setClearcoatTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getClearcoatTextureInfo(),c)}if(o.clearcoatRoughnessTexture!==void 0){const c=o.clearcoatRoughnessTexture;a.setClearcoatRoughnessTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getClearcoatRoughnessTextureInfo(),c)}if(o.clearcoatNormalTexture!==void 0){const c=o.clearcoatNormalTexture;a.setClearcoatNormalTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getClearcoatNormalTextureInfo(),c),c.scale!==void 0&&a.setClearcoatNormalScale(c.scale)}}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension(It);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{};const o=a.extensions[It]={clearcoatFactor:s.getClearcoatFactor(),clearcoatRoughnessFactor:s.getClearcoatRoughnessFactor()};if(s.getClearcoatTexture()){const c=s.getClearcoatTexture(),u=s.getClearcoatTextureInfo();o.clearcoatTexture=e.createTextureInfoDef(c,u)}if(s.getClearcoatRoughnessTexture()){const c=s.getClearcoatRoughnessTexture(),u=s.getClearcoatRoughnessTextureInfo();o.clearcoatRoughnessTexture=e.createTextureInfoDef(c,u)}if(s.getClearcoatNormalTexture()){const c=s.getClearcoatNormalTexture(),u=s.getClearcoatNormalTextureInfo();o.clearcoatNormalTexture=e.createTextureInfoDef(c,u),s.getClearcoatNormalScale()!==1&&(o.clearcoatNormalTexture.scale=s.getClearcoatNormalScale())}}}),this}}Ma.EXTENSION_NAME=It;class Ea extends we{init(){this.extensionName=xs,this.propertyType="EmissiveStrength",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{emissiveStrength:1})}getEmissiveStrength(){return this.get("emissiveStrength")}setEmissiveStrength(e){return this.set("emissiveStrength",e)}}Ea.EXTENSION_NAME=xs;const At=xs;class Ra extends ge{constructor(...e){super(...e),this.extensionName=At}createEmissiveStrength(){return new Ea(this.document.getGraph())}read(e){return(e.jsonDoc.json.materials||[]).forEach((r,n)=>{if(r.extensions&&r.extensions[At]){const s=this.createEmissiveStrength();e.materials[n].setExtension(At,s);const i=r.extensions[At];i.emissiveStrength!==void 0&&s.setEmissiveStrength(i.emissiveStrength)}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension(At);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{},a.extensions[At]={emissiveStrength:s.getEmissiveStrength()}}}),this}}Ra.EXTENSION_NAME=At;class wa extends we{init(){this.extensionName=ys,this.propertyType="IOR",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{ior:1.5})}getIOR(){return this.get("ior")}setIOR(e){return this.set("ior",e)}}wa.EXTENSION_NAME=ys;const bt=ys;class Ia extends ge{constructor(...e){super(...e),this.extensionName=bt}createIOR(){return new wa(this.document.getGraph())}read(e){return(e.jsonDoc.json.materials||[]).forEach((r,n)=>{if(r.extensions&&r.extensions[bt]){const s=this.createIOR();e.materials[n].setExtension(bt,s);const i=r.extensions[bt];i.ior!==void 0&&s.setIOR(i.ior)}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension(bt);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{},a.extensions[bt]={ior:s.getIOR()}}}),this}}Ia.EXTENSION_NAME=bt;const{R:pu,G:gu}=tt;class Aa extends we{init(){this.extensionName=Ts,this.propertyType="Iridescence",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{iridescenceFactor:0,iridescenceTexture:null,iridescenceTextureInfo:new ye(this.graph,"iridescenceTextureInfo"),iridescenceIOR:1.3,iridescenceThicknessMinimum:100,iridescenceThicknessMaximum:400,iridescenceThicknessTexture:null,iridescenceThicknessTextureInfo:new ye(this.graph,"iridescenceThicknessTextureInfo")})}getIridescenceFactor(){return this.get("iridescenceFactor")}setIridescenceFactor(e){return this.set("iridescenceFactor",e)}getIridescenceTexture(){return this.getRef("iridescenceTexture")}getIridescenceTextureInfo(){return this.getRef("iridescenceTexture")?this.getRef("iridescenceTextureInfo"):null}setIridescenceTexture(e){return this.setRef("iridescenceTexture",e,{channels:pu})}getIridescenceIOR(){return this.get("iridescenceIOR")}setIridescenceIOR(e){return this.set("iridescenceIOR",e)}getIridescenceThicknessMinimum(){return this.get("iridescenceThicknessMinimum")}setIridescenceThicknessMinimum(e){return this.set("iridescenceThicknessMinimum",e)}getIridescenceThicknessMaximum(){return this.get("iridescenceThicknessMaximum")}setIridescenceThicknessMaximum(e){return this.set("iridescenceThicknessMaximum",e)}getIridescenceThicknessTexture(){return this.getRef("iridescenceThicknessTexture")}getIridescenceThicknessTextureInfo(){return this.getRef("iridescenceThicknessTexture")?this.getRef("iridescenceThicknessTextureInfo"):null}setIridescenceThicknessTexture(e){return this.setRef("iridescenceThicknessTexture",e,{channels:gu})}}Aa.EXTENSION_NAME=Ts;const _t=Ts;class ba extends ge{constructor(...e){super(...e),this.extensionName=_t}createIridescence(){return new Aa(this.document.getGraph())}read(e){const r=e.jsonDoc,n=r.json.textures||[];return(r.json.materials||[]).forEach((s,i)=>{if(s.extensions&&s.extensions[_t]){const a=this.createIridescence();e.materials[i].setExtension(_t,a);const o=s.extensions[_t];if(o.iridescenceFactor!==void 0&&a.setIridescenceFactor(o.iridescenceFactor),o.iridescenceIor!==void 0&&a.setIridescenceIOR(o.iridescenceIor),o.iridescenceThicknessMinimum!==void 0&&a.setIridescenceThicknessMinimum(o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&a.setIridescenceThicknessMaximum(o.iridescenceThicknessMaximum),o.iridescenceTexture!==void 0){const c=o.iridescenceTexture;a.setIridescenceTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getIridescenceTextureInfo(),c)}if(o.iridescenceThicknessTexture!==void 0){const c=o.iridescenceThicknessTexture;a.setIridescenceThicknessTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getIridescenceThicknessTextureInfo(),c)}}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension(_t);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{};const o=a.extensions[_t]={};if(s.getIridescenceFactor()>0&&(o.iridescenceFactor=s.getIridescenceFactor()),s.getIridescenceIOR()!==1.3&&(o.iridescenceIor=s.getIridescenceIOR()),s.getIridescenceThicknessMinimum()!==100&&(o.iridescenceThicknessMinimum=s.getIridescenceThicknessMinimum()),s.getIridescenceThicknessMaximum()!==400&&(o.iridescenceThicknessMaximum=s.getIridescenceThicknessMaximum()),s.getIridescenceTexture()){const c=s.getIridescenceTexture(),u=s.getIridescenceTextureInfo();o.iridescenceTexture=e.createTextureInfoDef(c,u)}if(s.getIridescenceThicknessTexture()){const c=s.getIridescenceThicknessTexture(),u=s.getIridescenceThicknessTextureInfo();o.iridescenceThicknessTexture=e.createTextureInfoDef(c,u)}}}),this}}ba.EXTENSION_NAME=_t;const{R:Ni,G:Oi,B:$i,A:Fi}=tt;class _a extends we{init(){this.extensionName=Ms,this.propertyType="PBRSpecularGlossiness",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{diffuseFactor:[1,1,1,1],diffuseTexture:null,diffuseTextureInfo:new ye(this.graph,"diffuseTextureInfo"),specularFactor:[1,1,1],glossinessFactor:1,specularGlossinessTexture:null,specularGlossinessTextureInfo:new ye(this.graph,"specularGlossinessTextureInfo")})}getDiffuseFactor(){return this.get("diffuseFactor")}setDiffuseFactor(e){return this.set("diffuseFactor",e)}getDiffuseHex(){return Ve.factorToHex(this.getDiffuseFactor())}setDiffuseHex(e){const r=this.getDiffuseFactor().slice();return this.setDiffuseFactor(Ve.hexToFactor(e,r))}getDiffuseTexture(){return this.getRef("diffuseTexture")}getDiffuseTextureInfo(){return this.getRef("diffuseTexture")?this.getRef("diffuseTextureInfo"):null}setDiffuseTexture(e){return this.setRef("diffuseTexture",e,{channels:Ni|Oi|$i|Fi,isColor:!0})}getSpecularFactor(){return this.get("specularFactor")}setSpecularFactor(e){return this.set("specularFactor",e)}getGlossinessFactor(){return this.get("glossinessFactor")}setGlossinessFactor(e){return this.set("glossinessFactor",e)}getSpecularGlossinessTexture(){return this.getRef("specularGlossinessTexture")}getSpecularGlossinessTextureInfo(){return this.getRef("specularGlossinessTexture")?this.getRef("specularGlossinessTextureInfo"):null}setSpecularGlossinessTexture(e){return this.setRef("specularGlossinessTexture",e,{channels:Ni|Oi|$i|Fi})}}_a.EXTENSION_NAME=Ms;const St=Ms;class Sa extends ge{constructor(...e){super(...e),this.extensionName=St}createPBRSpecularGlossiness(){return new _a(this.document.getGraph())}read(e){const r=e.jsonDoc,n=r.json.textures||[];return(r.json.materials||[]).forEach((s,i)=>{if(s.extensions&&s.extensions[St]){const a=this.createPBRSpecularGlossiness();e.materials[i].setExtension(St,a);const o=s.extensions[St];if(o.diffuseFactor!==void 0&&a.setDiffuseFactor(o.diffuseFactor),o.specularFactor!==void 0&&a.setSpecularFactor(o.specularFactor),o.glossinessFactor!==void 0&&a.setGlossinessFactor(o.glossinessFactor),o.diffuseTexture!==void 0){const c=o.diffuseTexture;a.setDiffuseTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getDiffuseTextureInfo(),c)}if(o.specularGlossinessTexture!==void 0){const c=o.specularGlossinessTexture;a.setSpecularGlossinessTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getSpecularGlossinessTextureInfo(),c)}}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension(St);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{};const o=a.extensions[St]={diffuseFactor:s.getDiffuseFactor(),specularFactor:s.getSpecularFactor(),glossinessFactor:s.getGlossinessFactor()};if(s.getDiffuseTexture()){const c=s.getDiffuseTexture(),u=s.getDiffuseTextureInfo();o.diffuseTexture=e.createTextureInfoDef(c,u)}if(s.getSpecularGlossinessTexture()){const c=s.getSpecularGlossinessTexture(),u=s.getSpecularGlossinessTextureInfo();o.specularGlossinessTexture=e.createTextureInfoDef(c,u)}}}),this}}Sa.EXTENSION_NAME=St;const{R:du,G:mu,B:vu,A:xu}=tt;class Ca extends we{init(){this.extensionName=Es,this.propertyType="Sheen",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{sheenColorFactor:[0,0,0],sheenColorTexture:null,sheenColorTextureInfo:new ye(this.graph,"sheenColorTextureInfo"),sheenRoughnessFactor:0,sheenRoughnessTexture:null,sheenRoughnessTextureInfo:new ye(this.graph,"sheenRoughnessTextureInfo")})}getSheenColorFactor(){return this.get("sheenColorFactor")}getSheenColorHex(){return Ve.factorToHex(this.getSheenColorFactor())}setSheenColorFactor(e){return this.set("sheenColorFactor",e)}setSheenColorHex(e){const r=this.getSheenColorFactor().slice();return this.set("sheenColorFactor",Ve.hexToFactor(e,r))}getSheenColorTexture(){return this.getRef("sheenColorTexture")}getSheenColorTextureInfo(){return this.getRef("sheenColorTexture")?this.getRef("sheenColorTextureInfo"):null}setSheenColorTexture(e){return this.setRef("sheenColorTexture",e,{channels:du|mu|vu,isColor:!0})}getSheenRoughnessFactor(){return this.get("sheenRoughnessFactor")}setSheenRoughnessFactor(e){return this.set("sheenRoughnessFactor",e)}getSheenRoughnessTexture(){return this.getRef("sheenRoughnessTexture")}getSheenRoughnessTextureInfo(){return this.getRef("sheenRoughnessTexture")?this.getRef("sheenRoughnessTextureInfo"):null}setSheenRoughnessTexture(e){return this.setRef("sheenRoughnessTexture",e,{channels:xu})}}Ca.EXTENSION_NAME=Es;const Ct=Es;class Na extends ge{constructor(...e){super(...e),this.extensionName=Ct}createSheen(){return new Ca(this.document.getGraph())}read(e){const r=e.jsonDoc,n=r.json.textures||[];return(r.json.materials||[]).forEach((s,i)=>{if(s.extensions&&s.extensions[Ct]){const a=this.createSheen();e.materials[i].setExtension(Ct,a);const o=s.extensions[Ct];if(o.sheenColorFactor!==void 0&&a.setSheenColorFactor(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&a.setSheenRoughnessFactor(o.sheenRoughnessFactor),o.sheenColorTexture!==void 0){const c=o.sheenColorTexture;a.setSheenColorTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getSheenColorTextureInfo(),c)}if(o.sheenRoughnessTexture!==void 0){const c=o.sheenRoughnessTexture;a.setSheenRoughnessTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getSheenRoughnessTextureInfo(),c)}}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension(Ct);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{};const o=a.extensions[Ct]={sheenColorFactor:s.getSheenColorFactor(),sheenRoughnessFactor:s.getSheenRoughnessFactor()};if(s.getSheenColorTexture()){const c=s.getSheenColorTexture(),u=s.getSheenColorTextureInfo();o.sheenColorTexture=e.createTextureInfoDef(c,u)}if(s.getSheenRoughnessTexture()){const c=s.getSheenRoughnessTexture(),u=s.getSheenRoughnessTextureInfo();o.sheenRoughnessTexture=e.createTextureInfoDef(c,u)}}}),this}}Na.EXTENSION_NAME=Ct;const{R:yu,G:Tu,B:Mu,A:Eu}=tt;class Oa extends we{init(){this.extensionName=Rs,this.propertyType="Specular",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{specularFactor:1,specularTexture:null,specularTextureInfo:new ye(this.graph,"specularTextureInfo"),specularColorFactor:[1,1,1],specularColorTexture:null,specularColorTextureInfo:new ye(this.graph,"specularColorTextureInfo")})}getSpecularFactor(){return this.get("specularFactor")}setSpecularFactor(e){return this.set("specularFactor",e)}getSpecularColorFactor(){return this.get("specularColorFactor")}setSpecularColorFactor(e){return this.set("specularColorFactor",e)}getSpecularColorHex(){return Ve.factorToHex(this.getSpecularColorFactor())}setSpecularColorHex(e){const r=this.getSpecularColorFactor().slice();return this.set("specularColorFactor",Ve.hexToFactor(e,r))}getSpecularTexture(){return this.getRef("specularTexture")}getSpecularTextureInfo(){return this.getRef("specularTexture")?this.getRef("specularTextureInfo"):null}setSpecularTexture(e){return this.setRef("specularTexture",e,{channels:Eu})}getSpecularColorTexture(){return this.getRef("specularColorTexture")}getSpecularColorTextureInfo(){return this.getRef("specularColorTexture")?this.getRef("specularColorTextureInfo"):null}setSpecularColorTexture(e){return this.setRef("specularColorTexture",e,{channels:yu|Tu|Mu,isColor:!0})}}Oa.EXTENSION_NAME=Rs;const Nt=Rs;class $a extends ge{constructor(...e){super(...e),this.extensionName=Nt}createSpecular(){return new Oa(this.document.getGraph())}read(e){const r=e.jsonDoc,n=r.json.textures||[];return(r.json.materials||[]).forEach((s,i)=>{if(s.extensions&&s.extensions[Nt]){const a=this.createSpecular();e.materials[i].setExtension(Nt,a);const o=s.extensions[Nt];if(o.specularFactor!==void 0&&a.setSpecularFactor(o.specularFactor),o.specularColorFactor!==void 0&&a.setSpecularColorFactor(o.specularColorFactor),o.specularTexture!==void 0){const c=o.specularTexture;a.setSpecularTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getSpecularTextureInfo(),c)}if(o.specularColorTexture!==void 0){const c=o.specularColorTexture;a.setSpecularColorTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getSpecularColorTextureInfo(),c)}}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension(Nt);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{};const o=a.extensions[Nt]={};if(s.getSpecularFactor()!==1&&(o.specularFactor=s.getSpecularFactor()),ve.eq(s.getSpecularColorFactor(),[1,1,1])||(o.specularColorFactor=s.getSpecularColorFactor()),s.getSpecularTexture()){const c=s.getSpecularTexture(),u=s.getSpecularTextureInfo();o.specularTexture=e.createTextureInfoDef(c,u)}if(s.getSpecularColorTexture()){const c=s.getSpecularColorTexture(),u=s.getSpecularColorTextureInfo();o.specularColorTexture=e.createTextureInfoDef(c,u)}}}),this}}$a.EXTENSION_NAME=Nt;const{R:Ru}=tt;class Fa extends we{init(){this.extensionName=ws,this.propertyType="Transmission",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{transmissionFactor:0,transmissionTexture:null,transmissionTextureInfo:new ye(this.graph,"transmissionTextureInfo")})}getTransmissionFactor(){return this.get("transmissionFactor")}setTransmissionFactor(e){return this.set("transmissionFactor",e)}getTransmissionTexture(){return this.getRef("transmissionTexture")}getTransmissionTextureInfo(){return this.getRef("transmissionTexture")?this.getRef("transmissionTextureInfo"):null}setTransmissionTexture(e){return this.setRef("transmissionTexture",e,{channels:Ru})}}Fa.EXTENSION_NAME=ws;const Ot=ws;class Da extends ge{constructor(...e){super(...e),this.extensionName=Ot}createTransmission(){return new Fa(this.document.getGraph())}read(e){const r=e.jsonDoc,n=r.json.textures||[];return(r.json.materials||[]).forEach((s,i)=>{if(s.extensions&&s.extensions[Ot]){const a=this.createTransmission();e.materials[i].setExtension(Ot,a);const o=s.extensions[Ot];if(o.transmissionFactor!==void 0&&a.setTransmissionFactor(o.transmissionFactor),o.transmissionTexture!==void 0){const c=o.transmissionTexture;a.setTransmissionTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getTransmissionTextureInfo(),c)}}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension(Ot);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{};const o=a.extensions[Ot]={transmissionFactor:s.getTransmissionFactor()};if(s.getTransmissionTexture()){const c=s.getTransmissionTexture(),u=s.getTransmissionTextureInfo();o.transmissionTexture=e.createTextureInfoDef(c,u)}}}),this}}Da.EXTENSION_NAME=Ot;class Pa extends we{init(){this.extensionName=Is,this.propertyType="Unlit",this.parentTypes=[G.MATERIAL]}}Pa.EXTENSION_NAME=Is;const Jt=Is;class _s extends ge{constructor(...e){super(...e),this.extensionName=Jt}createUnlit(){return new Pa(this.document.getGraph())}read(e){return(e.jsonDoc.json.materials||[]).forEach((r,n)=>{r.extensions&&r.extensions[Jt]&&e.materials[n].setExtension(Jt,this.createUnlit())}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{if(n.getExtension(Jt)){const s=e.materialIndexMap.get(n),i=r.json.materials[s];i.extensions=i.extensions||{},i.extensions[Jt]={}}}),this}}_s.EXTENSION_NAME=Jt;class Ua extends we{init(){this.extensionName=kt,this.propertyType="Mapping",this.parentTypes=["MappingList"]}getDefaults(){return Object.assign(super.getDefaults(),{material:null,variants:[]})}getMaterial(){return this.getRef("material")}setMaterial(e){return this.setRef("material",e)}addVariant(e){return this.addRef("variants",e)}removeVariant(e){return this.removeRef("variants",e)}listVariants(){return this.listRefs("variants")}}Ua.EXTENSION_NAME=kt;class La extends we{init(){this.extensionName=kt,this.propertyType="MappingList",this.parentTypes=[G.PRIMITIVE]}getDefaults(){return Object.assign(super.getDefaults(),{mappings:[]})}addMapping(e){return this.addRef("mappings",e)}removeMapping(e){return this.removeRef("mappings",e)}listMappings(){return this.listRefs("mappings")}}La.EXTENSION_NAME=kt;class ns extends we{init(){this.extensionName=kt,this.propertyType="Variant",this.parentTypes=["MappingList"]}}ns.EXTENSION_NAME=kt;const at=kt;class Ba extends ge{constructor(...e){super(...e),this.extensionName=at}createMappingList(){return new La(this.document.getGraph())}createVariant(e=""){return new ns(this.document.getGraph(),e)}createMapping(){return new Ua(this.document.getGraph())}listVariants(){return Array.from(this.properties).filter(e=>e instanceof ns)}read(e){const r=e.jsonDoc;if(!r.json.extensions||!r.json.extensions[at])return this;const n=(r.json.extensions[at].variants||[]).map(s=>this.createVariant().setName(s.name||""));return(r.json.meshes||[]).forEach((s,i)=>{const a=e.meshes[i];(s.primitives||[]).forEach((o,c)=>{if(!o.extensions||!o.extensions[at])return;const u=this.createMappingList(),h=o.extensions[at];for(const d of h.mappings){const m=this.createMapping();d.material!==void 0&&m.setMaterial(e.materials[d.material]);for(const x of d.variants||[])m.addVariant(n[x]);u.addMapping(m)}a.listPrimitives()[c].setExtension(at,u)})}),this}write(e){const r=e.jsonDoc,n=this.listVariants();if(!n.length)return this;const s=[],i=new Map;for(const a of n)i.set(a,s.length),s.push(e.createPropertyDef(a));for(const a of this.document.getRoot().listMeshes()){const o=e.meshIndexMap.get(a);a.listPrimitives().forEach((c,u)=>{const h=c.getExtension(at);if(!h)return;const d=e.jsonDoc.json.meshes[o].primitives[u],m=h.listMappings().map(x=>{const M=e.createPropertyDef(x),w=x.getMaterial();return w&&(M.material=e.materialIndexMap.get(w)),M.variants=x.listVariants().map(p=>i.get(p)),M});d.extensions=d.extensions||{},d.extensions[at]={mappings:m}})}return r.json.extensions=r.json.extensions||{},r.json.extensions[at]={variants:s},this}}Ba.EXTENSION_NAME=at;const{G:wu}=tt;class Va extends we{init(){this.extensionName=As,this.propertyType="Volume",this.parentTypes=[G.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{thicknessFactor:0,thicknessTexture:null,thicknessTextureInfo:new ye(this.graph,"thicknessTexture"),attenuationDistance:1/0,attenuationColor:[1,1,1]})}getThicknessFactor(){return this.get("thicknessFactor")}setThicknessFactor(e){return this.set("thicknessFactor",e)}getThicknessTexture(){return this.getRef("thicknessTexture")}getThicknessTextureInfo(){return this.getRef("thicknessTexture")?this.getRef("thicknessTextureInfo"):null}setThicknessTexture(e){return this.setRef("thicknessTexture",e,{channels:wu})}getAttenuationDistance(){return this.get("attenuationDistance")}setAttenuationDistance(e){return this.set("attenuationDistance",e)}getAttenuationColor(){return this.get("attenuationColor")}setAttenuationColor(e){return this.set("attenuationColor",e)}getAttenuationColorHex(){return Ve.factorToHex(this.getAttenuationColor())}setAttenuationColorHex(e){const r=this.getAttenuationColor().slice();return this.set("attenuationColor",Ve.hexToFactor(e,r))}}Va.EXTENSION_NAME=As;const $t=As;class ja extends ge{constructor(...e){super(...e),this.extensionName=$t}createVolume(){return new Va(this.document.getGraph())}read(e){const r=e.jsonDoc,n=r.json.textures||[];return(r.json.materials||[]).forEach((s,i)=>{if(s.extensions&&s.extensions[$t]){const a=this.createVolume();e.materials[i].setExtension($t,a);const o=s.extensions[$t];if(o.thicknessFactor!==void 0&&a.setThicknessFactor(o.thicknessFactor),o.attenuationDistance!==void 0&&a.setAttenuationDistance(o.attenuationDistance),o.attenuationColor!==void 0&&a.setAttenuationColor(o.attenuationColor),o.thicknessTexture!==void 0){const c=o.thicknessTexture;a.setThicknessTexture(e.textures[n[c.index].source]),e.setTextureInfo(a.getThicknessTextureInfo(),c)}}}),this}write(e){const r=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const s=n.getExtension($t);if(s){const i=e.materialIndexMap.get(n),a=r.json.materials[i];a.extensions=a.extensions||{};const o=a.extensions[$t]={};if(s.getThicknessFactor()>0&&(o.thicknessFactor=s.getThicknessFactor()),Number.isFinite(s.getAttenuationDistance())&&(o.attenuationDistance=s.getAttenuationDistance()),ve.eq(s.getAttenuationColor(),[1,1,1])||(o.attenuationColor=s.getAttenuationColor()),s.getThicknessTexture()){const c=s.getThicknessTexture(),u=s.getThicknessTextureInfo();o.thicknessTexture=e.createTextureInfoDef(c,u)}}}),this}}ja.EXTENSION_NAME=$t;const za="KHR_mesh_quantization";class ka extends ge{constructor(...e){super(...e),this.extensionName=za}read(e){return this}write(e){return this}}ka.EXTENSION_NAME=za;const wr="KHR_texture_basisu";class Iu{match(e){return e[0]===171&&e[1]===75&&e[2]===84&&e[3]===88&&e[4]===32&&e[5]===50&&e[6]===48&&e[7]===187&&e[8]===13&&e[9]===10&&e[10]===26&&e[11]===10}getSize(e){const r=Vn(e);return[r.pixelWidth,r.pixelHeight]}getChannels(e){const r=Vn(e).dataFormatDescriptor[0];if(r.colorModel===zf)return r.samples.length===2&&(15&r.samples[1].channelType)==15?4:3;if(r.colorModel===kf)return(15&r.samples[0].channelType)==3?4:3;throw new Error(`Unexpected KTX2 colorModel, "${r.colorModel}".`)}getVRAMByteLength(e){const r=Vn(e),n=this.getChannels(e)>3;let s=0;for(let i=0;i<r.levels.length;i++){const a=r.levels[i];s+=a.uncompressedByteLength?a.uncompressedByteLength:Math.max(1,Math.floor(r.pixelWidth/Math.pow(2,i)))/4*(Math.max(1,Math.floor(r.pixelHeight/Math.pow(2,i)))/4)*(n?16:8)}return s}}class Ga extends ge{constructor(...e){super(...e),this.extensionName=wr,this.prereadTypes=[G.TEXTURE]}static register(){ct.registerFormat("image/ktx2",new Iu)}preread(e){return e.jsonDoc.json.textures.forEach(r=>{r.extensions&&r.extensions[wr]&&(r.source=r.extensions[wr].source)}),this}read(e){return this}write(e){const r=e.jsonDoc;return this.document.getRoot().listTextures().forEach(n=>{if(n.getMimeType()==="image/ktx2"){const s=e.imageIndexMap.get(n);r.json.textures.forEach(i=>{i.source===s&&(i.extensions=i.extensions||{},i.extensions[wr]={source:i.source},delete i.source)})}}),this}}Ga.EXTENSION_NAME=wr;class qa extends we{init(){this.extensionName=bs,this.propertyType="Transform",this.parentTypes=[G.TEXTURE_INFO]}getDefaults(){return Object.assign(super.getDefaults(),{offset:[0,0],rotation:0,scale:[1,1],texCoord:null})}getOffset(){return this.get("offset")}setOffset(e){return this.set("offset",e)}getRotation(){return this.get("rotation")}setRotation(e){return this.set("rotation",e)}getScale(){return this.get("scale")}setScale(e){return this.set("scale",e)}getTexCoord(){return this.get("texCoord")}setTexCoord(e){return this.set("texCoord",e)}}qa.EXTENSION_NAME=bs;const Ft=bs;class Ha extends ge{constructor(...e){super(...e),this.extensionName=Ft}createTransform(){return new qa(this.document.getGraph())}read(e){for(const[r,n]of Array.from(e.textureInfos.entries())){if(!n.extensions||!n.extensions[Ft])continue;const s=this.createTransform(),i=n.extensions[Ft];i.offset!==void 0&&s.setOffset(i.offset),i.rotation!==void 0&&s.setRotation(i.rotation),i.scale!==void 0&&s.setScale(i.scale),i.texCoord!==void 0&&s.setTexCoord(i.texCoord),r.setExtension(Ft,s)}return this}write(e){const r=Array.from(e.textureInfoDefMap.entries());for(const[n,s]of r){const i=n.getExtension(Ft);if(!i)continue;s.extensions=s.extensions||{};const a={},o=ve.eq;o(i.getOffset(),[0,0])||(a.offset=i.getOffset()),i.getRotation()!==0&&(a.rotation=i.getRotation()),o(i.getScale(),[1,1])||(a.scale=i.getScale()),i.getTexCoord()!=null&&(a.texCoord=i.getTexCoord()),s.extensions[Ft]=a}return this}}Ha.EXTENSION_NAME=Ft;const Au=[G.ROOT,G.SCENE,G.NODE,G.MESH,G.MATERIAL,G.TEXTURE,G.ANIMATION];class Wa extends we{init(){this.extensionName=ln,this.propertyType="Packet",this.parentTypes=Au}getDefaults(){return Object.assign(super.getDefaults(),{context:{},properties:{}})}getContext(){return this.get("context")}setContext(e){return this.set("context",pt({},e))}listProperties(){return Object.keys(this.get("properties"))}getProperty(e){const r=this.get("properties");return e in r?r[e]:null}setProperty(e,r){this._assertContext(e);const n=pt({},this.get("properties"));return r?n[e]=r:delete n[e],this.set("properties",n)}toJSONLD(){return pt({"@context":zn(this.get("context"))},zn(this.get("properties")))}fromJSONLD(e){const r=(e=zn(e))["@context"];return r&&this.set("context",r),delete e["@context"],this.set("properties",e)}_assertContext(e){if(!(e.split(":")[0]in this.get("context")))throw new Error(`${ln}: Missing context for term, "${e}".`)}}function zn(t){return JSON.parse(JSON.stringify(t))}Wa.EXTENSION_NAME=ln;const ht=ln;class Xa extends ge{constructor(...e){super(...e),this.extensionName=ht}createPacket(){return new Wa(this.document.getGraph())}listPackets(){return Array.from(this.properties)}read(e){var r;const n=(r=e.jsonDoc.json.extensions)==null?void 0:r[ht];if(!n||!n.packets)return this;const s=e.jsonDoc.json,i=this.document.getRoot(),a=n.packets.map(u=>this.createPacket().fromJSONLD(u)),o=[[s.asset],s.scenes,s.nodes,s.meshes,s.materials,s.images,s.animations],c=[[i],i.listScenes(),i.listNodes(),i.listMeshes(),i.listMaterials(),i.listTextures(),i.listAnimations()];for(let u=0;u<o.length;u++){const h=o[u]||[];for(let d=0;d<h.length;d++){const m=h[d];m.extensions&&m.extensions[ht]&&c[u][d].setExtension(ht,a[m.extensions[ht].packet])}}return this}write(e){const{json:r}=e.jsonDoc,n=[];for(const s of this.properties){n.push(s.toJSONLD());for(const i of s.listParents()){let a;switch(i.propertyType){case G.ROOT:a=r.asset;break;case G.SCENE:a=r.scenes[e.sceneIndexMap.get(i)];break;case G.NODE:a=r.nodes[e.nodeIndexMap.get(i)];break;case G.MESH:a=r.meshes[e.meshIndexMap.get(i)];break;case G.MATERIAL:a=r.materials[e.materialIndexMap.get(i)];break;case G.TEXTURE:a=r.images[e.imageIndexMap.get(i)];break;case G.ANIMATION:a=r.animations[e.animationIndexMap.get(i)];break;default:a=null,this.document.getLogger().warn(`[${ht}]: Unsupported parent property, "${i.propertyType}"`)}a&&(a.extensions=a.extensions||{},a.extensions[ht]={packet:n.length-1})}}return n.length>0&&(r.extensions=r.extensions||{},r.extensions[ht]={packets:n}),this}}Xa.EXTENSION_NAME=ht;const Ya=[rs,va,ya,Ma,Ra,Ia,ba,Sa,$a,Na,Da,_s,Ba,ja,ka,Ga,Ha,Xa];[...Ya];const Ka=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ja=t=>{let e="";for(let r=0;r<16;r++)r%4!=3&&(r>0&&(e+=" "),e+=t[r]||0);return e},bu=(t=1,e=Ka)=>`    <item objectid="${t}" transform="${Ja(e)}" />
`,Di=t=>t?t.toISOString().substring(0,10):"";function _u(t,{unit:e="millimeter",title:r="jscad model",author:n="",description:s="",application:i="jscad",creationDate:a=new Date,license:o="",modificationDate:c}={}){t.push(`<?xml version="1.0" encoding="UTF-8"?>
<model unit="${e}" xml:lang="en-US" xmlns="http://schemas.microsoft.com/3dmanufacturing/core/2015/02" xmlns:slic3rpe="http://schemas.slic3r.org/3mf/2017/06">
  <metadata name="slic3rpe:Version3mf">1</metadata>
  <metadata name="Title">${r}</metadata>
  <metadata name="Designer">${n}</metadata>
  <metadata name="Description">${s||r}</metadata>
  <metadata name="Copyright"></metadata>
  <metadata name="LicenseTerms">${o}</metadata>
  <metadata name="Rating"></metadata>
  <metadata name="CreationDate">${Di(a)}</metadata>
  <metadata name="ModificationDate">${Di(c||a)}</metadata>
  <metadata name="Application">${i}</metadata>
   `)}function Su(t,e,r,n){t.push(`<object id="${e}" type="model"${n==null?"":' name="'+n+'"'}>
`),t.push(` <components>
`),r.forEach(({objectID:s,transform:i})=>{Cu(t,s,i)}),t.push(` </components>
`),t.push(`</object>
`)}const Cu=(t,e=1,r=Ka)=>{t.push(`    <component objectid="${e}" transform="${Ja(r)}" />
`)};function Nu(t,e,r,n,s,i){t.push(`  <object id="${e}" type="model"${i?' name="'+i+'"':""}>
   <mesh>
    <vertices>
`);for(let a=0;a<r.length;a+=3)t.push(`     <vertex x="${r[a].toPrecision(s)}" y="${r[a+1].toPrecision(s)}" z="${r[a+2].toPrecision(s)}" />
`);t.push(`    </vertices>
    <triangles>
`);for(let a=0;a<n.length;a+=3)t.push(`     <triangle v1="${n[a]}" v2="${n[a+1]}" v3="${n[a+2]}" />
`);return t.push(`    </triangles>
   </mesh>
  </object>
`),t}const Pi={name:"[Content_Types].xml",content:`<?xml version="1.0" encoding="UTF-8"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" />
<Default Extension="model" ContentType="application/vnd.ms-package.3dmanufacturing-3dmodel+xml" />
<Default Extension="png" ContentType="image/png" />
</Types>`};function Ou({meshes:t=[],components:e=[],items:r=[],precision:n=17,header:s}){const i=[];return _u(i,s),i.push(`  <resources>
`),r.length==0&&console.error("3MF empty build! Include items or simple."),t.forEach(({id:a,vertices:o,indices:c,name:u})=>Nu(i,a,o,c,n,u)),e.forEach(({id:a,children:o,name:c})=>{Su(i,a,o,c)}),i.push(`  </resources>
`),i.push(`<build>
`),r.forEach(({objectID:a,transform:o})=>{i.push(bu(a,o))}),i.push(`</build>
`),i.push(`</model>
`),i.join("")}class $u{constructor(){this.idSeq=0,this.lines=['<?xml version="1.0" encoding="UTF-8"?>','<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">']}get name(){return"_rels/.rels"}addRel(e,r){this.lines.push(`  <Relationship Target="${e}" Id="rel-${++this.idSeq}" Type="${r}" />`)}add3dModel(e){this.addRel(e,"http://schemas.microsoft.com/3dmanufacturing/2013/01/3dmodel")}addThumbnail(e){this.addRel(e,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/thumbnail")}get content(){return this.lines.join(`
`)+`
</Relationships>`}}var $e=Uint8Array,ke=Uint16Array,Ss=Int32Array,Cs=new $e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ns=new $e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ui=new $e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Za=function(t,e){for(var r=new ke(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new Ss(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)s[i]=i-r[n]<<5|n;return{b:r,r:s}},Qa=Za(Cs,2),Fu=Qa.b,ss=Qa.r;Fu[28]=258,ss[258]=28;var Du=Za(Ns,0),Li=Du.r,is=new ke(32768);for(var fe=0;fe<32768;++fe){var mt=(fe&43690)>>1|(fe&21845)<<1;mt=(mt&52428)>>2|(mt&13107)<<2,mt=(mt&61680)>>4|(mt&3855)<<4,is[fe]=((mt&65280)>>8|(mt&255)<<8)>>1}var _r=function(t,e,r){for(var n=t.length,s=0,i=new ke(e);s<n;++s)t[s]&&++i[t[s]-1];var a=new ke(e);for(s=1;s<e;++s)a[s]=a[s-1]+i[s-1]<<1;var o;if(r){o=new ke(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var u=s<<4|t[s],h=e-t[s],d=a[t[s]-1]++<<h,m=d|(1<<h)-1;d<=m;++d)o[is[d]>>c]=u}else for(o=new ke(n),s=0;s<n;++s)t[s]&&(o[s]=is[a[t[s]-1]++]>>15-t[s]);return o},jt=new $e(288);for(var fe=0;fe<144;++fe)jt[fe]=8;for(var fe=144;fe<256;++fe)jt[fe]=9;for(var fe=256;fe<280;++fe)jt[fe]=7;for(var fe=280;fe<288;++fe)jt[fe]=8;var fn=new $e(32);for(var fe=0;fe<32;++fe)fn[fe]=5;var Pu=_r(jt,9,0),Uu=_r(fn,5,0),eo=function(t){return(t+7)/8|0},to=function(t,e,r){return(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length),new $e(t.subarray(e,r))},Lu=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],xn=function(t,e,r){var n=new Error(e||Lu[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,xn),!r)throw n;return n},ut=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},mr=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},kn=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,i=r.slice();if(!s)return{t:no,l:0};if(s==1){var a=new $e(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(I,_){return I.f-_.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,h=1,d=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};h!=s-1;)o=r[r[u].f<r[d].f?u++:d++],c=r[u!=h&&r[u].f<r[d].f?u++:d++],r[h++]={s:-1,f:o.f+c.f,l:o,r:c};for(var m=i[0].s,n=1;n<s;++n)i[n].s>m&&(m=i[n].s);var x=new ke(m+1),M=as(r[h-1],x,0);if(M>e){var n=0,w=0,p=M-e,R=1<<p;for(i.sort(function(_,U){return x[U.s]-x[_.s]||_.f-U.f});n<s;++n){var g=i[n].s;if(x[g]>e)w+=R-(1<<M-x[g]),x[g]=e;else break}for(w>>=p;w>0;){var y=i[n].s;x[y]<e?w-=1<<e-x[y]++-1:++n}for(;n>=0&&w;--n){var T=i[n].s;x[T]==e&&(--x[T],++w)}M=e}return{t:new $e(x),l:M}},as=function(t,e,r){return t.s==-1?Math.max(as(t.l,e,r+1),as(t.r,e,r+1)):e[t.s]=r},Bi=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new ke(++e),n=0,s=t[0],i=1,a=function(c){r[n++]=c},o=1;o<=e;++o)if(t[o]==s&&o!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(s),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(s);i=1,s=t[o]}return{c:r.subarray(0,n),n:e}},vr=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},ro=function(t,e,r){var n=r.length,s=eo(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var i=0;i<n;++i)t[s+i+4]=r[i];return(s+4+n)*8},Vi=function(t,e,r,n,s,i,a,o,c,u,h){ut(e,h++,r),++s[256];for(var d=kn(s,15),m=d.t,x=d.l,M=kn(i,15),w=M.t,p=M.l,R=Bi(m),g=R.c,y=R.n,T=Bi(w),I=T.c,_=T.n,U=new ke(19),$=0;$<g.length;++$)++U[g[$]&31];for(var $=0;$<I.length;++$)++U[I[$]&31];for(var C=kn(U,7),j=C.t,V=C.l,q=19;q>4&&!j[Ui[q-1]];--q);var L=u+5<<3,D=vr(s,jt)+vr(i,fn)+a,X=vr(s,m)+vr(i,w)+a+14+3*q+vr(U,j)+2*U[16]+3*U[17]+7*U[18];if(c>=0&&L<=D&&L<=X)return ro(e,h,t.subarray(c,c+u));var te,J,ie,re;if(ut(e,h,1+(X<D)),h+=2,X<D){te=_r(m,x,0),J=m,ie=_r(w,p,0),re=w;var ae=_r(j,V,0);ut(e,h,y-257),ut(e,h+5,_-1),ut(e,h+10,q-4),h+=14;for(var $=0;$<q;++$)ut(e,h+3*$,j[Ui[$]]);h+=3*q;for(var oe=[g,I],le=0;le<2;++le)for(var Ae=oe[le],$=0;$<Ae.length;++$){var ue=Ae[$]&31;ut(e,h,ae[ue]),h+=j[ue],ue>15&&(ut(e,h,Ae[$]>>5&127),h+=Ae[$]>>12)}}else te=Pu,J=jt,ie=Uu,re=fn;for(var $=0;$<o;++$){var de=n[$];if(de>255){var ue=de>>18&31;mr(e,h,te[ue+257]),h+=J[ue+257],ue>7&&(ut(e,h,de>>23&31),h+=Cs[ue]);var be=de&31;mr(e,h,ie[be]),h+=re[be],be>3&&(mr(e,h,de>>5&8191),h+=Ns[be])}else mr(e,h,te[de]),h+=J[de]}return mr(e,h,te[256]),h+J[256]},Bu=new Ss([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),no=new $e(0),Vu=function(t,e,r,n,s,i){var a=i.z||t.length,o=new $e(n+a+5*(1+Math.ceil(a/7e3))+s),c=o.subarray(n,o.length-s),u=i.l,h=(i.r||0)&7;if(e){h&&(c[0]=i.r>>3);for(var d=Bu[e-1],m=d>>13,x=d&8191,M=(1<<r)-1,w=i.p||new ke(32768),p=i.h||new ke(M+1),R=Math.ceil(r/3),g=2*R,y=function(xt){return(t[xt]^t[xt+1]<<R^t[xt+2]<<g)&M},T=new Ss(25e3),I=new ke(288),_=new ke(32),U=0,$=0,C=i.i||0,j=0,V=i.w||0,q=0;C+2<a;++C){var L=y(C),D=C&32767,X=p[L];if(w[D]=X,p[L]=D,V<=C){var te=a-C;if((U>7e3||j>24576)&&(te>423||!u)){h=Vi(t,c,0,T,I,_,$,j,q,C-q,h),j=U=$=0,q=C;for(var J=0;J<286;++J)I[J]=0;for(var J=0;J<30;++J)_[J]=0}var ie=2,re=0,ae=x,oe=D-X&32767;if(te>2&&L==y(C-oe))for(var le=Math.min(m,te)-1,Ae=Math.min(32767,C),ue=Math.min(258,te);oe<=Ae&&--ae&&D!=X;){if(t[C+ie]==t[C+ie-oe]){for(var de=0;de<ue&&t[C+de]==t[C+de-oe];++de);if(de>ie){if(ie=de,re=oe,de>le)break;for(var be=Math.min(oe,de-2),Fe=0,J=0;J<be;++J){var dt=C-oe+J&32767,he=w[dt],je=dt-he&32767;je>Fe&&(Fe=je,X=dt)}}}D=X,X=w[D],oe+=D-X&32767}if(re){T[j++]=268435456|ss[ie]<<18|Li[re];var Be=ss[ie]&31,vt=Li[re]&31;$+=Cs[Be]+Ns[vt],++I[257+Be],++_[vt],V=C+ie,++U}else T[j++]=t[C],++I[t[C]]}}for(C=Math.max(C,V);C<a;++C)T[j++]=t[C],++I[t[C]];h=Vi(t,c,u,T,I,_,$,j,q,C-q,h),u||(i.r=h&7|c[h/8|0]<<3,h-=7,i.h=p,i.p=w,i.i=C,i.w=V)}else{for(var C=i.w||0;C<a+u;C+=65535){var rt=C+65535;rt>=a&&(c[h/8|0]=u,rt=a),h=ro(c,h+1,t.subarray(C,rt))}i.i=a}return to(o,0,n+eo(h)+s)},ju=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,n=9;--n;)r=(r&1&&-306674912)^r>>>1;t[e]=r}return t}(),zu=function(){var t=-1;return{p:function(e){for(var r=t,n=0;n<e.length;++n)r=ju[r&255^e[n]]^r>>>8;t=r},d:function(){return~t}}},ku=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),a=new $e(i.length+t.length);a.set(i),a.set(t,i.length),t=a,s.w=i.length}return Vu(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},so=function(t,e){var r={};for(var n in t)r[n]=t[n];for(var n in e)r[n]=e[n];return r},Oe=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8};function Gu(t,e){return ku(t,e||{},0,0)}var io=function(t,e,r,n){for(var s in t){var i=t[s],a=e+s,o=n;Array.isArray(i)&&(o=so(n,i[1]),i=i[0]),i instanceof $e?r[a]=[i,o]:(r[a+="/"]=[new $e(0),o],io(i,a,r,n))}},ji=typeof TextEncoder<"u"&&new TextEncoder,qu=typeof TextDecoder<"u"&&new TextDecoder,Hu=0;try{qu.decode(no,{stream:!0}),Hu=1}catch{}function Sr(t,e){if(e){for(var r=new $e(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}if(ji)return ji.encode(t);for(var s=t.length,i=new $e(t.length+(t.length>>1)),a=0,o=function(h){i[a++]=h},n=0;n<s;++n){if(a+5>i.length){var c=new $e(a+8+(s-n<<1));c.set(i),i=c}var u=t.charCodeAt(n);u<128||e?o(u):u<2048?(o(192|u>>6),o(128|u&63)):u>55295&&u<57344?(u=65536+(u&1047552)|t.charCodeAt(++n)&1023,o(240|u>>18),o(128|u>>12&63),o(128|u>>6&63),o(128|u&63)):(o(224|u>>12),o(128|u>>6&63),o(128|u&63))}return to(i,0,a)}var os=function(t){var e=0;if(t)for(var r in t){var n=t[r].length;n>65535&&xn(9),e+=n+4}return e},zi=function(t,e,r,n,s,i,a,o){var c=n.length,u=r.extra,h=o&&o.length,d=os(u);Oe(t,e,a!=null?33639248:67324752),e+=4,a!=null&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(i<0&&8),t[e++]=s&&8,t[e++]=r.compression&255,t[e++]=r.compression>>8;var m=new Date(r.mtime==null?Date.now():r.mtime),x=m.getFullYear()-1980;if((x<0||x>119)&&xn(10),Oe(t,e,x<<25|m.getMonth()+1<<21|m.getDate()<<16|m.getHours()<<11|m.getMinutes()<<5|m.getSeconds()>>1),e+=4,i!=-1&&(Oe(t,e,r.crc),Oe(t,e+4,i<0?-i-2:i),Oe(t,e+8,r.size)),Oe(t,e+12,c),Oe(t,e+14,d),e+=16,a!=null&&(Oe(t,e,h),Oe(t,e+6,r.attrs),Oe(t,e+10,a),e+=14),t.set(n,e),e+=c,d)for(var M in u){var w=u[M],p=w.length;Oe(t,e,+M),Oe(t,e+2,p),t.set(w,e+4),e+=4+p}return h&&(t.set(o,e),e+=h),e},Wu=function(t,e,r,n,s){Oe(t,e,101010256),Oe(t,e+8,r),Oe(t,e+10,r),Oe(t,e+12,n),Oe(t,e+16,s)};function Xu(t,e){e||(e={});var r={},n=[];io(t,"",r,e);var s=0,i=0;for(var a in r){var o=r[a],c=o[0],u=o[1],h=u.level==0?0:8,d=Sr(a),m=d.length,x=u.comment,M=x&&Sr(x),w=M&&M.length,p=os(u.extra);m>65535&&xn(11);var R=h?Gu(c,u):c,g=R.length,y=zu();y.p(c),n.push(so(u,{size:c.length,crc:y.d(),c:R,f:d,m:M,u:m!=a.length||M&&x.length!=w,o:s,compression:h})),s+=30+m+p+g,i+=76+2*(m+p)+(w||0)+g}for(var T=new $e(i+22),I=s,_=i-s,U=0;U<n.length;++U){var d=n[U];zi(T,d.o,d,d.f,d.u,d.c.length);var $=30+d.f.length+os(d.extra);T.set(d.c,d.o+$),zi(T,s,d,d.f,d.u,d.c.length,d.o,d.m),s+=16+$+(d.m?d.m.length:0)}return Wu(T,s,n.length,_,I),T}var W=1e-6,ee=typeof Float32Array<"u"?Float32Array:Array,Qe=Math.random;function ao(t){ee=t}var Yu=Math.PI/180;function Ku(t){return t*Yu}function Ju(t,e){return Math.abs(t-e)<=W*Math.max(1,Math.abs(t),Math.abs(e))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Zu=Object.freeze({__proto__:null,get ARRAY_TYPE(){return ee},EPSILON:W,RANDOM:Qe,equals:Ju,setMatrixArrayType:ao,toRadian:Ku});function Qu(){var t=new ee(4);return ee!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function eh(t){var e=new ee(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function th(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function rh(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function nh(t,e,r,n){var s=new ee(4);return s[0]=t,s[1]=e,s[2]=r,s[3]=n,s}function sh(t,e,r,n,s){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t}function ih(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function ah(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=r*i-s*n;return a?(a=1/a,t[0]=i*a,t[1]=-n*a,t[2]=-s*a,t[3]=r*a,t):null}function oh(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}function ch(t){return t[0]*t[3]-t[2]*t[1]}function oo(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=r[0],c=r[1],u=r[2],h=r[3];return t[0]=n*o+i*c,t[1]=s*o+a*c,t[2]=n*u+i*h,t[3]=s*u+a*h,t}function lh(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(r),c=Math.cos(r);return t[0]=n*c+i*o,t[1]=s*c+a*o,t[2]=n*-o+i*c,t[3]=s*-o+a*c,t}function fh(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=r[0],c=r[1];return t[0]=n*o,t[1]=s*o,t[2]=i*c,t[3]=a*c,t}function uh(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t}function hh(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function ph(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function gh(t){return Math.hypot(t[0],t[1],t[2],t[3])}function dh(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]}function mh(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function co(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function vh(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function xh(t,e){var r=t[0],n=t[1],s=t[2],i=t[3],a=e[0],o=e[1],c=e[2],u=e[3];return Math.abs(r-a)<=W*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=W*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(s-c)<=W*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(i-u)<=W*Math.max(1,Math.abs(i),Math.abs(u))}function yh(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Th(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}var Mh=oo,Eh=co,Rh=Object.freeze({__proto__:null,LDU:dh,add:mh,adjoint:oh,clone:eh,copy:th,create:Qu,determinant:ch,equals:xh,exactEquals:vh,frob:gh,fromRotation:uh,fromScaling:hh,fromValues:nh,identity:rh,invert:ah,mul:Mh,multiply:oo,multiplyScalar:yh,multiplyScalarAndAdd:Th,rotate:lh,scale:fh,set:sh,str:ph,sub:Eh,subtract:co,transpose:ih});function wh(){var t=new ee(6);return ee!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function Ih(t){var e=new ee(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Ah(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function bh(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function _h(t,e,r,n,s,i){var a=new ee(6);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a[4]=s,a[5]=i,a}function Sh(t,e,r,n,s,i,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t[4]=i,t[5]=a,t}function Ch(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=e[4],o=e[5],c=r*i-n*s;return c?(c=1/c,t[0]=i*c,t[1]=-n*c,t[2]=-s*c,t[3]=r*c,t[4]=(s*o-i*a)*c,t[5]=(n*a-r*o)*c,t):null}function Nh(t){return t[0]*t[3]-t[1]*t[2]}function lo(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=r[0],h=r[1],d=r[2],m=r[3],x=r[4],M=r[5];return t[0]=n*u+i*h,t[1]=s*u+a*h,t[2]=n*d+i*m,t[3]=s*d+a*m,t[4]=n*x+i*M+o,t[5]=s*x+a*M+c,t}function Oh(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=Math.sin(r),h=Math.cos(r);return t[0]=n*h+i*u,t[1]=s*h+a*u,t[2]=n*-u+i*h,t[3]=s*-u+a*h,t[4]=o,t[5]=c,t}function $h(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=r[0],h=r[1];return t[0]=n*u,t[1]=s*u,t[2]=i*h,t[3]=a*h,t[4]=o,t[5]=c,t}function Fh(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=r[0],h=r[1];return t[0]=n,t[1]=s,t[2]=i,t[3]=a,t[4]=n*u+i*h+o,t[5]=s*u+a*h+c,t}function Dh(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t}function Ph(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function Uh(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function Lh(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function Bh(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function Vh(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function fo(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function jh(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function zh(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t}function kh(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Gh(t,e){var r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],o=t[5],c=e[0],u=e[1],h=e[2],d=e[3],m=e[4],x=e[5];return Math.abs(r-c)<=W*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-u)<=W*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(s-h)<=W*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(i-d)<=W*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-m)<=W*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(o-x)<=W*Math.max(1,Math.abs(o),Math.abs(x))}var qh=lo,Hh=fo,Wh=Object.freeze({__proto__:null,add:Vh,clone:Ih,copy:Ah,create:wh,determinant:Nh,equals:Gh,exactEquals:kh,frob:Bh,fromRotation:Dh,fromScaling:Ph,fromTranslation:Uh,fromValues:_h,identity:bh,invert:Ch,mul:qh,multiply:lo,multiplyScalar:jh,multiplyScalarAndAdd:zh,rotate:Oh,scale:$h,set:Sh,str:Lh,sub:Hh,subtract:fo,translate:Fh});function uo(){var t=new ee(9);return ee!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Xh(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Yh(t){var e=new ee(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Kh(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Jh(t,e,r,n,s,i,a,o,c){var u=new ee(9);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=s,u[5]=i,u[6]=a,u[7]=o,u[8]=c,u}function Zh(t,e,r,n,s,i,a,o,c,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t[4]=i,t[5]=a,t[6]=o,t[7]=c,t[8]=u,t}function Qh(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function ep(t,e){if(t===e){var r=e[1],n=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function tp(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=e[4],o=e[5],c=e[6],u=e[7],h=e[8],d=h*a-o*u,m=-h*i+o*c,x=u*i-a*c,M=r*d+n*m+s*x;return M?(M=1/M,t[0]=d*M,t[1]=(-h*n+s*u)*M,t[2]=(o*n-s*a)*M,t[3]=m*M,t[4]=(h*r-s*c)*M,t[5]=(-o*r+s*i)*M,t[6]=x*M,t[7]=(-u*r+n*c)*M,t[8]=(a*r-n*i)*M,t):null}function rp(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=e[4],o=e[5],c=e[6],u=e[7],h=e[8];return t[0]=a*h-o*u,t[1]=s*u-n*h,t[2]=n*o-s*a,t[3]=o*c-i*h,t[4]=r*h-s*c,t[5]=s*i-r*o,t[6]=i*u-a*c,t[7]=n*c-r*u,t[8]=r*a-n*i,t}function np(t){var e=t[0],r=t[1],n=t[2],s=t[3],i=t[4],a=t[5],o=t[6],c=t[7],u=t[8];return e*(u*i-a*c)+r*(-u*s+a*o)+n*(c*s-i*o)}function ho(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],d=e[8],m=r[0],x=r[1],M=r[2],w=r[3],p=r[4],R=r[5],g=r[6],y=r[7],T=r[8];return t[0]=m*n+x*a+M*u,t[1]=m*s+x*o+M*h,t[2]=m*i+x*c+M*d,t[3]=w*n+p*a+R*u,t[4]=w*s+p*o+R*h,t[5]=w*i+p*c+R*d,t[6]=g*n+y*a+T*u,t[7]=g*s+y*o+T*h,t[8]=g*i+y*c+T*d,t}function sp(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],d=e[8],m=r[0],x=r[1];return t[0]=n,t[1]=s,t[2]=i,t[3]=a,t[4]=o,t[5]=c,t[6]=m*n+x*a+u,t[7]=m*s+x*o+h,t[8]=m*i+x*c+d,t}function ip(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],d=e[8],m=Math.sin(r),x=Math.cos(r);return t[0]=x*n+m*a,t[1]=x*s+m*o,t[2]=x*i+m*c,t[3]=x*a-m*n,t[4]=x*o-m*s,t[5]=x*c-m*i,t[6]=u,t[7]=h,t[8]=d,t}function ap(t,e,r){var n=r[0],s=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function op(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function cp(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function lp(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function fp(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function up(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=r+r,o=n+n,c=s+s,u=r*a,h=n*a,d=n*o,m=s*a,x=s*o,M=s*c,w=i*a,p=i*o,R=i*c;return t[0]=1-d-M,t[3]=h-R,t[6]=m+p,t[1]=h+R,t[4]=1-u-M,t[7]=x-w,t[2]=m-p,t[5]=x+w,t[8]=1-u-d,t}function hp(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=e[4],o=e[5],c=e[6],u=e[7],h=e[8],d=e[9],m=e[10],x=e[11],M=e[12],w=e[13],p=e[14],R=e[15],g=r*o-n*a,y=r*c-s*a,T=r*u-i*a,I=n*c-s*o,_=n*u-i*o,U=s*u-i*c,$=h*w-d*M,C=h*p-m*M,j=h*R-x*M,V=d*p-m*w,q=d*R-x*w,L=m*R-x*p,D=g*L-y*q+T*V+I*j-_*C+U*$;return D?(D=1/D,t[0]=(o*L-c*q+u*V)*D,t[1]=(c*j-a*L-u*C)*D,t[2]=(a*q-o*j+u*$)*D,t[3]=(s*q-n*L-i*V)*D,t[4]=(r*L-s*j+i*C)*D,t[5]=(n*j-r*q-i*$)*D,t[6]=(w*U-p*_+R*I)*D,t[7]=(p*T-M*U-R*y)*D,t[8]=(M*_-w*T+R*g)*D,t):null}function pp(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function gp(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function dp(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function mp(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function po(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function vp(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function xp(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function yp(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Tp(t,e){var r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],o=t[5],c=t[6],u=t[7],h=t[8],d=e[0],m=e[1],x=e[2],M=e[3],w=e[4],p=e[5],R=e[6],g=e[7],y=e[8];return Math.abs(r-d)<=W*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-m)<=W*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(s-x)<=W*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(i-M)<=W*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(a-w)<=W*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(o-p)<=W*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(c-R)<=W*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(u-g)<=W*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(h-y)<=W*Math.max(1,Math.abs(h),Math.abs(y))}var Mp=ho,Ep=po,Rp=Object.freeze({__proto__:null,add:mp,adjoint:rp,clone:Yh,copy:Kh,create:uo,determinant:np,equals:Tp,exactEquals:yp,frob:dp,fromMat2d:fp,fromMat4:Xh,fromQuat:up,fromRotation:cp,fromScaling:lp,fromTranslation:op,fromValues:Jh,identity:Qh,invert:tp,mul:Mp,multiply:ho,multiplyScalar:vp,multiplyScalarAndAdd:xp,normalFromMat4:hp,projection:pp,rotate:ip,scale:ap,set:Zh,str:gp,sub:Ep,subtract:po,translate:sp,transpose:ep});function wp(){var t=new ee(16);return ee!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Ip(t){var e=new ee(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ap(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function bp(t,e,r,n,s,i,a,o,c,u,h,d,m,x,M,w){var p=new ee(16);return p[0]=t,p[1]=e,p[2]=r,p[3]=n,p[4]=s,p[5]=i,p[6]=a,p[7]=o,p[8]=c,p[9]=u,p[10]=h,p[11]=d,p[12]=m,p[13]=x,p[14]=M,p[15]=w,p}function _p(t,e,r,n,s,i,a,o,c,u,h,d,m,x,M,w,p){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t[4]=i,t[5]=a,t[6]=o,t[7]=c,t[8]=u,t[9]=h,t[10]=d,t[11]=m,t[12]=x,t[13]=M,t[14]=w,t[15]=p,t}function go(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Sp(t,e){if(t===e){var r=e[1],n=e[2],s=e[3],i=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=s,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Cp(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=e[4],o=e[5],c=e[6],u=e[7],h=e[8],d=e[9],m=e[10],x=e[11],M=e[12],w=e[13],p=e[14],R=e[15],g=r*o-n*a,y=r*c-s*a,T=r*u-i*a,I=n*c-s*o,_=n*u-i*o,U=s*u-i*c,$=h*w-d*M,C=h*p-m*M,j=h*R-x*M,V=d*p-m*w,q=d*R-x*w,L=m*R-x*p,D=g*L-y*q+T*V+I*j-_*C+U*$;return D?(D=1/D,t[0]=(o*L-c*q+u*V)*D,t[1]=(s*q-n*L-i*V)*D,t[2]=(w*U-p*_+R*I)*D,t[3]=(m*_-d*U-x*I)*D,t[4]=(c*j-a*L-u*C)*D,t[5]=(r*L-s*j+i*C)*D,t[6]=(p*T-M*U-R*y)*D,t[7]=(h*U-m*T+x*y)*D,t[8]=(a*q-o*j+u*$)*D,t[9]=(n*j-r*q-i*$)*D,t[10]=(M*_-w*T+R*g)*D,t[11]=(d*T-h*_-x*g)*D,t[12]=(o*C-a*V-c*$)*D,t[13]=(r*V-n*C+s*$)*D,t[14]=(w*y-M*I-p*g)*D,t[15]=(h*I-d*y+m*g)*D,t):null}function Np(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=e[4],o=e[5],c=e[6],u=e[7],h=e[8],d=e[9],m=e[10],x=e[11],M=e[12],w=e[13],p=e[14],R=e[15];return t[0]=o*(m*R-x*p)-d*(c*R-u*p)+w*(c*x-u*m),t[1]=-(n*(m*R-x*p)-d*(s*R-i*p)+w*(s*x-i*m)),t[2]=n*(c*R-u*p)-o*(s*R-i*p)+w*(s*u-i*c),t[3]=-(n*(c*x-u*m)-o*(s*x-i*m)+d*(s*u-i*c)),t[4]=-(a*(m*R-x*p)-h*(c*R-u*p)+M*(c*x-u*m)),t[5]=r*(m*R-x*p)-h*(s*R-i*p)+M*(s*x-i*m),t[6]=-(r*(c*R-u*p)-a*(s*R-i*p)+M*(s*u-i*c)),t[7]=r*(c*x-u*m)-a*(s*x-i*m)+h*(s*u-i*c),t[8]=a*(d*R-x*w)-h*(o*R-u*w)+M*(o*x-u*d),t[9]=-(r*(d*R-x*w)-h*(n*R-i*w)+M*(n*x-i*d)),t[10]=r*(o*R-u*w)-a*(n*R-i*w)+M*(n*u-i*o),t[11]=-(r*(o*x-u*d)-a*(n*x-i*d)+h*(n*u-i*o)),t[12]=-(a*(d*p-m*w)-h*(o*p-c*w)+M*(o*m-c*d)),t[13]=r*(d*p-m*w)-h*(n*p-s*w)+M*(n*m-s*d),t[14]=-(r*(o*p-c*w)-a*(n*p-s*w)+M*(n*c-s*o)),t[15]=r*(o*m-c*d)-a*(n*m-s*d)+h*(n*c-s*o),t}function Op(t){var e=t[0],r=t[1],n=t[2],s=t[3],i=t[4],a=t[5],o=t[6],c=t[7],u=t[8],h=t[9],d=t[10],m=t[11],x=t[12],M=t[13],w=t[14],p=t[15],R=e*a-r*i,g=e*o-n*i,y=e*c-s*i,T=r*o-n*a,I=r*c-s*a,_=n*c-s*o,U=u*M-h*x,$=u*w-d*x,C=u*p-m*x,j=h*w-d*M,V=h*p-m*M,q=d*p-m*w;return R*q-g*V+y*j+T*C-I*$+_*U}function mo(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],d=e[8],m=e[9],x=e[10],M=e[11],w=e[12],p=e[13],R=e[14],g=e[15],y=r[0],T=r[1],I=r[2],_=r[3];return t[0]=y*n+T*o+I*d+_*w,t[1]=y*s+T*c+I*m+_*p,t[2]=y*i+T*u+I*x+_*R,t[3]=y*a+T*h+I*M+_*g,y=r[4],T=r[5],I=r[6],_=r[7],t[4]=y*n+T*o+I*d+_*w,t[5]=y*s+T*c+I*m+_*p,t[6]=y*i+T*u+I*x+_*R,t[7]=y*a+T*h+I*M+_*g,y=r[8],T=r[9],I=r[10],_=r[11],t[8]=y*n+T*o+I*d+_*w,t[9]=y*s+T*c+I*m+_*p,t[10]=y*i+T*u+I*x+_*R,t[11]=y*a+T*h+I*M+_*g,y=r[12],T=r[13],I=r[14],_=r[15],t[12]=y*n+T*o+I*d+_*w,t[13]=y*s+T*c+I*m+_*p,t[14]=y*i+T*u+I*x+_*R,t[15]=y*a+T*h+I*M+_*g,t}function $p(t,e,r){var n=r[0],s=r[1],i=r[2],a,o,c,u,h,d,m,x,M,w,p,R;return e===t?(t[12]=e[0]*n+e[4]*s+e[8]*i+e[12],t[13]=e[1]*n+e[5]*s+e[9]*i+e[13],t[14]=e[2]*n+e[6]*s+e[10]*i+e[14],t[15]=e[3]*n+e[7]*s+e[11]*i+e[15]):(a=e[0],o=e[1],c=e[2],u=e[3],h=e[4],d=e[5],m=e[6],x=e[7],M=e[8],w=e[9],p=e[10],R=e[11],t[0]=a,t[1]=o,t[2]=c,t[3]=u,t[4]=h,t[5]=d,t[6]=m,t[7]=x,t[8]=M,t[9]=w,t[10]=p,t[11]=R,t[12]=a*n+h*s+M*i+e[12],t[13]=o*n+d*s+w*i+e[13],t[14]=c*n+m*s+p*i+e[14],t[15]=u*n+x*s+R*i+e[15]),t}function Fp(t,e,r){var n=r[0],s=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Dp(t,e,r,n){var s=n[0],i=n[1],a=n[2],o=Math.hypot(s,i,a),c,u,h,d,m,x,M,w,p,R,g,y,T,I,_,U,$,C,j,V,q,L,D,X;return o<W?null:(o=1/o,s*=o,i*=o,a*=o,c=Math.sin(r),u=Math.cos(r),h=1-u,d=e[0],m=e[1],x=e[2],M=e[3],w=e[4],p=e[5],R=e[6],g=e[7],y=e[8],T=e[9],I=e[10],_=e[11],U=s*s*h+u,$=i*s*h+a*c,C=a*s*h-i*c,j=s*i*h-a*c,V=i*i*h+u,q=a*i*h+s*c,L=s*a*h+i*c,D=i*a*h-s*c,X=a*a*h+u,t[0]=d*U+w*$+y*C,t[1]=m*U+p*$+T*C,t[2]=x*U+R*$+I*C,t[3]=M*U+g*$+_*C,t[4]=d*j+w*V+y*q,t[5]=m*j+p*V+T*q,t[6]=x*j+R*V+I*q,t[7]=M*j+g*V+_*q,t[8]=d*L+w*D+y*X,t[9]=m*L+p*D+T*X,t[10]=x*L+R*D+I*X,t[11]=M*L+g*D+_*X,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Pp(t,e,r){var n=Math.sin(r),s=Math.cos(r),i=e[4],a=e[5],o=e[6],c=e[7],u=e[8],h=e[9],d=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*s+u*n,t[5]=a*s+h*n,t[6]=o*s+d*n,t[7]=c*s+m*n,t[8]=u*s-i*n,t[9]=h*s-a*n,t[10]=d*s-o*n,t[11]=m*s-c*n,t}function Up(t,e,r){var n=Math.sin(r),s=Math.cos(r),i=e[0],a=e[1],o=e[2],c=e[3],u=e[8],h=e[9],d=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s-u*n,t[1]=a*s-h*n,t[2]=o*s-d*n,t[3]=c*s-m*n,t[8]=i*n+u*s,t[9]=a*n+h*s,t[10]=o*n+d*s,t[11]=c*n+m*s,t}function Lp(t,e,r){var n=Math.sin(r),s=Math.cos(r),i=e[0],a=e[1],o=e[2],c=e[3],u=e[4],h=e[5],d=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s+u*n,t[1]=a*s+h*n,t[2]=o*s+d*n,t[3]=c*s+m*n,t[4]=u*s-i*n,t[5]=h*s-a*n,t[6]=d*s-o*n,t[7]=m*s-c*n,t}function Bp(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Vp(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jp(t,e,r){var n=r[0],s=r[1],i=r[2],a=Math.hypot(n,s,i),o,c,u;return a<W?null:(a=1/a,n*=a,s*=a,i*=a,o=Math.sin(e),c=Math.cos(e),u=1-c,t[0]=n*n*u+c,t[1]=s*n*u+i*o,t[2]=i*n*u-s*o,t[3]=0,t[4]=n*s*u-i*o,t[5]=s*s*u+c,t[6]=i*s*u+n*o,t[7]=0,t[8]=n*i*u+s*o,t[9]=s*i*u-n*o,t[10]=i*i*u+c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function zp(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function kp(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gp(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vo(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=n+n,c=s+s,u=i+i,h=n*o,d=n*c,m=n*u,x=s*c,M=s*u,w=i*u,p=a*o,R=a*c,g=a*u;return t[0]=1-(x+w),t[1]=d+g,t[2]=m-R,t[3]=0,t[4]=d-g,t[5]=1-(h+w),t[6]=M+p,t[7]=0,t[8]=m+R,t[9]=M-p,t[10]=1-(h+x),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function qp(t,e){var r=new ee(3),n=-e[0],s=-e[1],i=-e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],d=n*n+s*s+i*i+a*a;return d>0?(r[0]=(o*a+h*n+c*i-u*s)*2/d,r[1]=(c*a+h*s+u*n-o*i)*2/d,r[2]=(u*a+h*i+o*s-c*n)*2/d):(r[0]=(o*a+h*n+c*i-u*s)*2,r[1]=(c*a+h*s+u*n-o*i)*2,r[2]=(u*a+h*i+o*s-c*n)*2),vo(t,e,r),t}function xo(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function yo(t,e){var r=e[0],n=e[1],s=e[2],i=e[4],a=e[5],o=e[6],c=e[8],u=e[9],h=e[10];return t[0]=Math.hypot(r,n,s),t[1]=Math.hypot(i,a,o),t[2]=Math.hypot(c,u,h),t}function To(t,e){var r=new ee(3);yo(r,e);var n=1/r[0],s=1/r[1],i=1/r[2],a=e[0]*n,o=e[1]*s,c=e[2]*i,u=e[4]*n,h=e[5]*s,d=e[6]*i,m=e[8]*n,x=e[9]*s,M=e[10]*i,w=a+h+M,p=0;return w>0?(p=Math.sqrt(w+1)*2,t[3]=.25*p,t[0]=(d-x)/p,t[1]=(m-c)/p,t[2]=(o-u)/p):a>h&&a>M?(p=Math.sqrt(1+a-h-M)*2,t[3]=(d-x)/p,t[0]=.25*p,t[1]=(o+u)/p,t[2]=(m+c)/p):h>M?(p=Math.sqrt(1+h-a-M)*2,t[3]=(m-c)/p,t[0]=(o+u)/p,t[1]=.25*p,t[2]=(d+x)/p):(p=Math.sqrt(1+M-a-h)*2,t[3]=(o-u)/p,t[0]=(m+c)/p,t[1]=(d+x)/p,t[2]=.25*p),t}function Hp(t,e,r,n){var s=e[0],i=e[1],a=e[2],o=e[3],c=s+s,u=i+i,h=a+a,d=s*c,m=s*u,x=s*h,M=i*u,w=i*h,p=a*h,R=o*c,g=o*u,y=o*h,T=n[0],I=n[1],_=n[2];return t[0]=(1-(M+p))*T,t[1]=(m+y)*T,t[2]=(x-g)*T,t[3]=0,t[4]=(m-y)*I,t[5]=(1-(d+p))*I,t[6]=(w+R)*I,t[7]=0,t[8]=(x+g)*_,t[9]=(w-R)*_,t[10]=(1-(d+M))*_,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Wp(t,e,r,n,s){var i=e[0],a=e[1],o=e[2],c=e[3],u=i+i,h=a+a,d=o+o,m=i*u,x=i*h,M=i*d,w=a*h,p=a*d,R=o*d,g=c*u,y=c*h,T=c*d,I=n[0],_=n[1],U=n[2],$=s[0],C=s[1],j=s[2],V=(1-(w+R))*I,q=(x+T)*I,L=(M-y)*I,D=(x-T)*_,X=(1-(m+R))*_,te=(p+g)*_,J=(M+y)*U,ie=(p-g)*U,re=(1-(m+w))*U;return t[0]=V,t[1]=q,t[2]=L,t[3]=0,t[4]=D,t[5]=X,t[6]=te,t[7]=0,t[8]=J,t[9]=ie,t[10]=re,t[11]=0,t[12]=r[0]+$-(V*$+D*C+J*j),t[13]=r[1]+C-(q*$+X*C+ie*j),t[14]=r[2]+j-(L*$+te*C+re*j),t[15]=1,t}function Xp(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=r+r,o=n+n,c=s+s,u=r*a,h=n*a,d=n*o,m=s*a,x=s*o,M=s*c,w=i*a,p=i*o,R=i*c;return t[0]=1-d-M,t[1]=h+R,t[2]=m-p,t[3]=0,t[4]=h-R,t[5]=1-u-M,t[6]=x+w,t[7]=0,t[8]=m+p,t[9]=x-w,t[10]=1-u-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Yp(t,e,r,n,s,i,a){var o=1/(r-e),c=1/(s-n),u=1/(i-a);return t[0]=i*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*c,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(s+n)*c,t[10]=(a+i)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i*2*u,t[15]=0,t}function Mo(t,e,r,n,s){var i=1/Math.tan(e/2),a;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(a=1/(n-s),t[10]=(s+n)*a,t[14]=2*s*n*a):(t[10]=-1,t[14]=-2*n),t}var Kp=Mo;function Jp(t,e,r,n,s){var i=1/Math.tan(e/2),a;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(a=1/(n-s),t[10]=s*a,t[14]=s*n*a):(t[10]=-1,t[14]=-n),t}function Zp(t,e,r,n){var s=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),c=2/(a+o),u=2/(s+i);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((a-o)*c*.5),t[9]=(s-i)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Eo(t,e,r,n,s,i,a){var o=1/(e-r),c=1/(n-s),u=1/(i-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*o,t[13]=(s+n)*c,t[14]=(a+i)*u,t[15]=1,t}var Qp=Eo;function e1(t,e,r,n,s,i,a){var o=1/(e-r),c=1/(n-s),u=1/(i-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+r)*o,t[13]=(s+n)*c,t[14]=i*u,t[15]=1,t}function t1(t,e,r,n){var s,i,a,o,c,u,h,d,m,x,M=e[0],w=e[1],p=e[2],R=n[0],g=n[1],y=n[2],T=r[0],I=r[1],_=r[2];return Math.abs(M-T)<W&&Math.abs(w-I)<W&&Math.abs(p-_)<W?go(t):(h=M-T,d=w-I,m=p-_,x=1/Math.hypot(h,d,m),h*=x,d*=x,m*=x,s=g*m-y*d,i=y*h-R*m,a=R*d-g*h,x=Math.hypot(s,i,a),x?(x=1/x,s*=x,i*=x,a*=x):(s=0,i=0,a=0),o=d*a-m*i,c=m*s-h*a,u=h*i-d*s,x=Math.hypot(o,c,u),x?(x=1/x,o*=x,c*=x,u*=x):(o=0,c=0,u=0),t[0]=s,t[1]=o,t[2]=h,t[3]=0,t[4]=i,t[5]=c,t[6]=d,t[7]=0,t[8]=a,t[9]=u,t[10]=m,t[11]=0,t[12]=-(s*M+i*w+a*p),t[13]=-(o*M+c*w+u*p),t[14]=-(h*M+d*w+m*p),t[15]=1,t)}function r1(t,e,r,n){var s=e[0],i=e[1],a=e[2],o=n[0],c=n[1],u=n[2],h=s-r[0],d=i-r[1],m=a-r[2],x=h*h+d*d+m*m;x>0&&(x=1/Math.sqrt(x),h*=x,d*=x,m*=x);var M=c*m-u*d,w=u*h-o*m,p=o*d-c*h;return x=M*M+w*w+p*p,x>0&&(x=1/Math.sqrt(x),M*=x,w*=x,p*=x),t[0]=M,t[1]=w,t[2]=p,t[3]=0,t[4]=d*p-m*w,t[5]=m*M-h*p,t[6]=h*w-d*M,t[7]=0,t[8]=h,t[9]=d,t[10]=m,t[11]=0,t[12]=s,t[13]=i,t[14]=a,t[15]=1,t}function n1(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function s1(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function i1(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Ro(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function a1(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function o1(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function c1(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function l1(t,e){var r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],o=t[5],c=t[6],u=t[7],h=t[8],d=t[9],m=t[10],x=t[11],M=t[12],w=t[13],p=t[14],R=t[15],g=e[0],y=e[1],T=e[2],I=e[3],_=e[4],U=e[5],$=e[6],C=e[7],j=e[8],V=e[9],q=e[10],L=e[11],D=e[12],X=e[13],te=e[14],J=e[15];return Math.abs(r-g)<=W*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-y)<=W*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(s-T)<=W*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(i-I)<=W*Math.max(1,Math.abs(i),Math.abs(I))&&Math.abs(a-_)<=W*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(o-U)<=W*Math.max(1,Math.abs(o),Math.abs(U))&&Math.abs(c-$)<=W*Math.max(1,Math.abs(c),Math.abs($))&&Math.abs(u-C)<=W*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(h-j)<=W*Math.max(1,Math.abs(h),Math.abs(j))&&Math.abs(d-V)<=W*Math.max(1,Math.abs(d),Math.abs(V))&&Math.abs(m-q)<=W*Math.max(1,Math.abs(m),Math.abs(q))&&Math.abs(x-L)<=W*Math.max(1,Math.abs(x),Math.abs(L))&&Math.abs(M-D)<=W*Math.max(1,Math.abs(M),Math.abs(D))&&Math.abs(w-X)<=W*Math.max(1,Math.abs(w),Math.abs(X))&&Math.abs(p-te)<=W*Math.max(1,Math.abs(p),Math.abs(te))&&Math.abs(R-J)<=W*Math.max(1,Math.abs(R),Math.abs(J))}var f1=mo,u1=Ro,h1=Object.freeze({__proto__:null,add:i1,adjoint:Np,clone:Ip,copy:Ap,create:wp,determinant:Op,equals:l1,exactEquals:c1,frob:s1,fromQuat:Xp,fromQuat2:qp,fromRotation:jp,fromRotationTranslation:vo,fromRotationTranslationScale:Hp,fromRotationTranslationScaleOrigin:Wp,fromScaling:Vp,fromTranslation:Bp,fromValues:bp,fromXRotation:zp,fromYRotation:kp,fromZRotation:Gp,frustum:Yp,getRotation:To,getScaling:yo,getTranslation:xo,identity:go,invert:Cp,lookAt:t1,mul:f1,multiply:mo,multiplyScalar:a1,multiplyScalarAndAdd:o1,ortho:Qp,orthoNO:Eo,orthoZO:e1,perspective:Kp,perspectiveFromFieldOfView:Zp,perspectiveNO:Mo,perspectiveZO:Jp,rotate:Dp,rotateX:Pp,rotateY:Up,rotateZ:Lp,scale:Fp,set:_p,str:n1,sub:u1,subtract:Ro,targetTo:r1,translate:$p,transpose:Sp});function Os(){var t=new ee(3);return ee!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function p1(t){var e=new ee(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function wo(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function cs(t,e,r){var n=new ee(3);return n[0]=t,n[1]=e,n[2]=r,n}function g1(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function d1(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function m1(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Io(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Ao(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function bo(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function v1(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function x1(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function y1(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function T1(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function M1(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function E1(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function R1(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function _o(t,e){var r=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return Math.hypot(r,n,s)}function So(t,e){var r=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return r*r+n*n+s*s}function Co(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function w1(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function I1(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function No(t,e){var r=e[0],n=e[1],s=e[2],i=r*r+n*n+s*s;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function $s(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function en(t,e,r){var n=e[0],s=e[1],i=e[2],a=r[0],o=r[1],c=r[2];return t[0]=s*c-i*o,t[1]=i*a-n*c,t[2]=n*o-s*a,t}function A1(t,e,r,n){var s=e[0],i=e[1],a=e[2];return t[0]=s+n*(r[0]-s),t[1]=i+n*(r[1]-i),t[2]=a+n*(r[2]-a),t}function b1(t,e,r,n,s,i){var a=i*i,o=a*(2*i-3)+1,c=a*(i-2)+i,u=a*(i-1),h=a*(3-2*i);return t[0]=e[0]*o+r[0]*c+n[0]*u+s[0]*h,t[1]=e[1]*o+r[1]*c+n[1]*u+s[1]*h,t[2]=e[2]*o+r[2]*c+n[2]*u+s[2]*h,t}function _1(t,e,r,n,s,i){var a=1-i,o=a*a,c=i*i,u=o*a,h=3*i*o,d=3*c*a,m=c*i;return t[0]=e[0]*u+r[0]*h+n[0]*d+s[0]*m,t[1]=e[1]*u+r[1]*h+n[1]*d+s[1]*m,t[2]=e[2]*u+r[2]*h+n[2]*d+s[2]*m,t}function S1(t,e){e=e||1;var r=Qe()*2*Math.PI,n=Qe()*2-1,s=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*s,t[1]=Math.sin(r)*s,t[2]=n*e,t}function C1(t,e,r){var n=e[0],s=e[1],i=e[2],a=r[3]*n+r[7]*s+r[11]*i+r[15];return a=a||1,t[0]=(r[0]*n+r[4]*s+r[8]*i+r[12])/a,t[1]=(r[1]*n+r[5]*s+r[9]*i+r[13])/a,t[2]=(r[2]*n+r[6]*s+r[10]*i+r[14])/a,t}function N1(t,e,r){var n=e[0],s=e[1],i=e[2];return t[0]=n*r[0]+s*r[3]+i*r[6],t[1]=n*r[1]+s*r[4]+i*r[7],t[2]=n*r[2]+s*r[5]+i*r[8],t}function O1(t,e,r){var n=r[0],s=r[1],i=r[2],a=r[3],o=e[0],c=e[1],u=e[2],h=s*u-i*c,d=i*o-n*u,m=n*c-s*o,x=s*m-i*d,M=i*h-n*m,w=n*d-s*h,p=a*2;return h*=p,d*=p,m*=p,x*=2,M*=2,w*=2,t[0]=o+h+x,t[1]=c+d+M,t[2]=u+m+w,t}function $1(t,e,r,n){var s=[],i=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],i[0]=s[0],i[1]=s[1]*Math.cos(n)-s[2]*Math.sin(n),i[2]=s[1]*Math.sin(n)+s[2]*Math.cos(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function F1(t,e,r,n){var s=[],i=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],i[0]=s[2]*Math.sin(n)+s[0]*Math.cos(n),i[1]=s[1],i[2]=s[2]*Math.cos(n)-s[0]*Math.sin(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function D1(t,e,r,n){var s=[],i=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],i[0]=s[0]*Math.cos(n)-s[1]*Math.sin(n),i[1]=s[0]*Math.sin(n)+s[1]*Math.cos(n),i[2]=s[2],t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t}function P1(t,e){var r=t[0],n=t[1],s=t[2],i=e[0],a=e[1],o=e[2],c=Math.sqrt(r*r+n*n+s*s),u=Math.sqrt(i*i+a*a+o*o),h=c*u,d=h&&$s(t,e)/h;return Math.acos(Math.min(Math.max(d,-1),1))}function U1(t){return t[0]=0,t[1]=0,t[2]=0,t}function L1(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function B1(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function V1(t,e){var r=t[0],n=t[1],s=t[2],i=e[0],a=e[1],o=e[2];return Math.abs(r-i)<=W*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=W*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(s-o)<=W*Math.max(1,Math.abs(s),Math.abs(o))}var j1=Io,z1=Ao,k1=bo,G1=_o,q1=So,Oo=wo,H1=Co,W1=function(){var t=Os();return function(e,r,n,s,i,a){var o,c;for(r||(r=3),n||(n=0),s?c=Math.min(s*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],i(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}(),X1=Object.freeze({__proto__:null,add:m1,angle:P1,bezier:_1,ceil:v1,clone:p1,copy:g1,create:Os,cross:en,dist:G1,distance:_o,div:k1,divide:bo,dot:$s,equals:V1,exactEquals:B1,floor:x1,forEach:W1,fromValues:cs,hermite:b1,inverse:I1,len:Oo,length:wo,lerp:A1,max:T1,min:y1,mul:z1,multiply:Ao,negate:w1,normalize:No,random:S1,rotateX:$1,rotateY:F1,rotateZ:D1,round:M1,scale:E1,scaleAndAdd:R1,set:d1,sqrDist:q1,sqrLen:H1,squaredDistance:So,squaredLength:Co,str:L1,sub:j1,subtract:Io,transformMat3:N1,transformMat4:C1,transformQuat:O1,zero:U1});function $o(){var t=new ee(4);return ee!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Fo(t){var e=new ee(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Do(t,e,r,n){var s=new ee(4);return s[0]=t,s[1]=e,s[2]=r,s[3]=n,s}function Po(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Uo(t,e,r,n,s){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t}function Lo(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function Bo(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Vo(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function jo(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Y1(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function K1(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function J1(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Z1(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function Q1(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function zo(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function eg(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function ko(t,e){var r=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2],i=e[3]-t[3];return Math.hypot(r,n,s,i)}function Go(t,e){var r=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2],i=e[3]-t[3];return r*r+n*n+s*s+i*i}function Fs(t){var e=t[0],r=t[1],n=t[2],s=t[3];return Math.hypot(e,r,n,s)}function Ds(t){var e=t[0],r=t[1],n=t[2],s=t[3];return e*e+r*r+n*n+s*s}function tg(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function rg(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function qo(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=r*r+n*n+s*s+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=r*a,t[1]=n*a,t[2]=s*a,t[3]=i*a,t}function Ho(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ng(t,e,r,n){var s=r[0]*n[1]-r[1]*n[0],i=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],o=r[1]*n[2]-r[2]*n[1],c=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],h=e[0],d=e[1],m=e[2],x=e[3];return t[0]=d*u-m*c+x*o,t[1]=-(h*u)+m*a-x*i,t[2]=h*c-d*a+x*s,t[3]=-(h*o)+d*i-m*s,t}function Wo(t,e,r,n){var s=e[0],i=e[1],a=e[2],o=e[3];return t[0]=s+n*(r[0]-s),t[1]=i+n*(r[1]-i),t[2]=a+n*(r[2]-a),t[3]=o+n*(r[3]-o),t}function sg(t,e){e=e||1;var r,n,s,i,a,o;do r=Qe()*2-1,n=Qe()*2-1,a=r*r+n*n;while(a>=1);do s=Qe()*2-1,i=Qe()*2-1,o=s*s+i*i;while(o>=1);var c=Math.sqrt((1-a)/o);return t[0]=e*r,t[1]=e*n,t[2]=e*s*c,t[3]=e*i*c,t}function ig(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3];return t[0]=r[0]*n+r[4]*s+r[8]*i+r[12]*a,t[1]=r[1]*n+r[5]*s+r[9]*i+r[13]*a,t[2]=r[2]*n+r[6]*s+r[10]*i+r[14]*a,t[3]=r[3]*n+r[7]*s+r[11]*i+r[15]*a,t}function ag(t,e,r){var n=e[0],s=e[1],i=e[2],a=r[0],o=r[1],c=r[2],u=r[3],h=u*n+o*i-c*s,d=u*s+c*n-a*i,m=u*i+a*s-o*n,x=-a*n-o*s-c*i;return t[0]=h*u+x*-a+d*-c-m*-o,t[1]=d*u+x*-o+m*-a-h*-c,t[2]=m*u+x*-c+h*-o-d*-a,t[3]=e[3],t}function og(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function cg(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Xo(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Yo(t,e){var r=t[0],n=t[1],s=t[2],i=t[3],a=e[0],o=e[1],c=e[2],u=e[3];return Math.abs(r-a)<=W*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=W*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(s-c)<=W*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(i-u)<=W*Math.max(1,Math.abs(i),Math.abs(u))}var lg=Bo,fg=Vo,ug=jo,hg=ko,pg=Go,gg=Fs,dg=Ds,mg=function(){var t=$o();return function(e,r,n,s,i,a){var o,c;for(r||(r=4),n||(n=0),s?c=Math.min(s*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],i(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}(),vg=Object.freeze({__proto__:null,add:Lo,ceil:Y1,clone:Fo,copy:Po,create:$o,cross:ng,dist:hg,distance:ko,div:ug,divide:jo,dot:Ho,equals:Yo,exactEquals:Xo,floor:K1,forEach:mg,fromValues:Do,inverse:rg,len:gg,length:Fs,lerp:Wo,max:Z1,min:J1,mul:fg,multiply:Vo,negate:tg,normalize:qo,random:sg,round:Q1,scale:zo,scaleAndAdd:eg,set:Uo,sqrDist:pg,sqrLen:dg,squaredDistance:Go,squaredLength:Ds,str:cg,sub:lg,subtract:Bo,transformMat4:ig,transformQuat:ag,zero:og});function un(){var t=new ee(4);return ee!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function xg(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ko(t,e,r){r=r*.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function yg(t,e){var r=Math.acos(e[3])*2,n=Math.sin(r/2);return n>W?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function Tg(t,e){var r=Us(t,e);return Math.acos(2*r*r-1)}function Jo(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=r[0],c=r[1],u=r[2],h=r[3];return t[0]=n*h+a*o+s*u-i*c,t[1]=s*h+a*c+i*o-n*u,t[2]=i*h+a*u+n*c-s*o,t[3]=a*h-n*o-s*c-i*u,t}function Zo(t,e,r){r*=.5;var n=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(r),c=Math.cos(r);return t[0]=n*c+a*o,t[1]=s*c+i*o,t[2]=i*c-s*o,t[3]=a*c-n*o,t}function Qo(t,e,r){r*=.5;var n=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(r),c=Math.cos(r);return t[0]=n*c-i*o,t[1]=s*c+a*o,t[2]=i*c+n*o,t[3]=a*c-s*o,t}function ec(t,e,r){r*=.5;var n=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(r),c=Math.cos(r);return t[0]=n*c+s*o,t[1]=s*c-n*o,t[2]=i*c+a*o,t[3]=a*c-i*o,t}function Mg(t,e){var r=e[0],n=e[1],s=e[2];return t[0]=r,t[1]=n,t[2]=s,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-s*s)),t}function tc(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=Math.sqrt(r*r+n*n+s*s),o=Math.exp(i),c=a>0?o*Math.sin(a)/a:0;return t[0]=r*c,t[1]=n*c,t[2]=s*c,t[3]=o*Math.cos(a),t}function rc(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=Math.sqrt(r*r+n*n+s*s),o=a>0?Math.atan2(a,i)/a:0;return t[0]=r*o,t[1]=n*o,t[2]=s*o,t[3]=.5*Math.log(r*r+n*n+s*s+i*i),t}function Eg(t,e,r){return rc(t,e),sc(t,t,r),tc(t,t),t}function tn(t,e,r,n){var s=e[0],i=e[1],a=e[2],o=e[3],c=r[0],u=r[1],h=r[2],d=r[3],m,x,M,w,p;return x=s*c+i*u+a*h+o*d,x<0&&(x=-x,c=-c,u=-u,h=-h,d=-d),1-x>W?(m=Math.acos(x),M=Math.sin(m),w=Math.sin((1-n)*m)/M,p=Math.sin(n*m)/M):(w=1-n,p=n),t[0]=w*s+p*c,t[1]=w*i+p*u,t[2]=w*a+p*h,t[3]=w*o+p*d,t}function Rg(t){var e=Qe(),r=Qe(),n=Qe(),s=Math.sqrt(1-e),i=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*r),t[1]=s*Math.cos(2*Math.PI*r),t[2]=i*Math.sin(2*Math.PI*n),t[3]=i*Math.cos(2*Math.PI*n),t}function wg(t,e){var r=e[0],n=e[1],s=e[2],i=e[3],a=r*r+n*n+s*s+i*i,o=a?1/a:0;return t[0]=-r*o,t[1]=-n*o,t[2]=-s*o,t[3]=i*o,t}function Ig(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function nc(t,e){var r=e[0]+e[4]+e[8],n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var i=(s+1)%3,a=(s+2)%3;n=Math.sqrt(e[s*3+s]-e[i*3+i]-e[a*3+a]+1),t[s]=.5*n,n=.5/n,t[3]=(e[i*3+a]-e[a*3+i])*n,t[i]=(e[i*3+s]+e[s*3+i])*n,t[a]=(e[a*3+s]+e[s*3+a])*n}return t}function Ag(t,e,r,n){var s=.5*Math.PI/180;e*=s,r*=s,n*=s;var i=Math.sin(e),a=Math.cos(e),o=Math.sin(r),c=Math.cos(r),u=Math.sin(n),h=Math.cos(n);return t[0]=i*c*h-a*o*u,t[1]=a*o*h+i*c*u,t[2]=a*c*u-i*o*h,t[3]=a*c*h+i*o*u,t}function bg(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var _g=Fo,Sg=Do,Ps=Po,Cg=Uo,Ng=Lo,Og=Jo,sc=zo,Us=Ho,$g=Wo,Ls=Fs,Fg=Ls,Bs=Ds,Dg=Bs,Vs=qo,Pg=Xo,Ug=Yo,Lg=function(){var t=Os(),e=cs(1,0,0),r=cs(0,1,0);return function(n,s,i){var a=$s(s,i);return a<-.999999?(en(t,e,s),Oo(t)<1e-6&&en(t,r,s),No(t,t),Ko(n,t,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(en(t,s,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+a,Vs(n,n))}}(),Bg=function(){var t=un(),e=un();return function(r,n,s,i,a,o){return tn(t,n,a,o),tn(e,s,i,o),tn(r,t,e,2*o*(1-o)),r}}(),Vg=function(){var t=uo();return function(e,r,n,s){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],Vs(e,nc(e,t))}}(),jg=Object.freeze({__proto__:null,add:Ng,calculateW:Mg,clone:_g,conjugate:Ig,copy:Ps,create:un,dot:Us,equals:Ug,exactEquals:Pg,exp:tc,fromEuler:Ag,fromMat3:nc,fromValues:Sg,getAngle:Tg,getAxisAngle:yg,identity:xg,invert:wg,len:Fg,length:Ls,lerp:$g,ln:rc,mul:Og,multiply:Jo,normalize:Vs,pow:Eg,random:Rg,rotateX:Zo,rotateY:Qo,rotateZ:ec,rotationTo:Lg,scale:sc,set:Cg,setAxes:Vg,setAxisAngle:Ko,slerp:tn,sqlerp:Bg,sqrLen:Dg,squaredLength:Bs,str:bg});function zg(){var t=new ee(8);return ee!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function kg(t){var e=new ee(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Gg(t,e,r,n,s,i,a,o){var c=new ee(8);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=s,c[5]=i,c[6]=a,c[7]=o,c}function qg(t,e,r,n,s,i,a){var o=new ee(8);o[0]=t,o[1]=e,o[2]=r,o[3]=n;var c=s*.5,u=i*.5,h=a*.5;return o[4]=c*n+u*r-h*e,o[5]=u*n+h*t-c*r,o[6]=h*n+c*e-u*t,o[7]=-c*t-u*e-h*r,o}function ic(t,e,r){var n=r[0]*.5,s=r[1]*.5,i=r[2]*.5,a=e[0],o=e[1],c=e[2],u=e[3];return t[0]=a,t[1]=o,t[2]=c,t[3]=u,t[4]=n*u+s*c-i*o,t[5]=s*u+i*a-n*c,t[6]=i*u+n*o-s*a,t[7]=-n*a-s*o-i*c,t}function Hg(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0]*.5,t[5]=e[1]*.5,t[6]=e[2]*.5,t[7]=0,t}function Wg(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Xg(t,e){var r=un();To(r,e);var n=new ee(3);return xo(n,e),ic(t,r,n),t}function ac(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Yg(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Kg(t,e,r,n,s,i,a,o,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t[4]=i,t[5]=a,t[6]=o,t[7]=c,t}var Jg=Ps;function Zg(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Qg=Ps;function ed(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function td(t,e){var r=e[4],n=e[5],s=e[6],i=e[7],a=-e[0],o=-e[1],c=-e[2],u=e[3];return t[0]=(r*u+i*a+n*c-s*o)*2,t[1]=(n*u+i*o+s*a-r*c)*2,t[2]=(s*u+i*c+r*o-n*a)*2,t}function rd(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=r[0]*.5,c=r[1]*.5,u=r[2]*.5,h=e[4],d=e[5],m=e[6],x=e[7];return t[0]=n,t[1]=s,t[2]=i,t[3]=a,t[4]=a*o+s*u-i*c+h,t[5]=a*c+i*o-n*u+d,t[6]=a*u+n*c-s*o+m,t[7]=-n*o-s*c-i*u+x,t}function nd(t,e,r){var n=-e[0],s=-e[1],i=-e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],d=o*a+h*n+c*i-u*s,m=c*a+h*s+u*n-o*i,x=u*a+h*i+o*s-c*n,M=h*a-o*n-c*s-u*i;return Zo(t,e,r),n=t[0],s=t[1],i=t[2],a=t[3],t[4]=d*a+M*n+m*i-x*s,t[5]=m*a+M*s+x*n-d*i,t[6]=x*a+M*i+d*s-m*n,t[7]=M*a-d*n-m*s-x*i,t}function sd(t,e,r){var n=-e[0],s=-e[1],i=-e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],d=o*a+h*n+c*i-u*s,m=c*a+h*s+u*n-o*i,x=u*a+h*i+o*s-c*n,M=h*a-o*n-c*s-u*i;return Qo(t,e,r),n=t[0],s=t[1],i=t[2],a=t[3],t[4]=d*a+M*n+m*i-x*s,t[5]=m*a+M*s+x*n-d*i,t[6]=x*a+M*i+d*s-m*n,t[7]=M*a-d*n-m*s-x*i,t}function id(t,e,r){var n=-e[0],s=-e[1],i=-e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],d=o*a+h*n+c*i-u*s,m=c*a+h*s+u*n-o*i,x=u*a+h*i+o*s-c*n,M=h*a-o*n-c*s-u*i;return ec(t,e,r),n=t[0],s=t[1],i=t[2],a=t[3],t[4]=d*a+M*n+m*i-x*s,t[5]=m*a+M*s+x*n-d*i,t[6]=x*a+M*i+d*s-m*n,t[7]=M*a-d*n-m*s-x*i,t}function ad(t,e,r){var n=r[0],s=r[1],i=r[2],a=r[3],o=e[0],c=e[1],u=e[2],h=e[3];return t[0]=o*a+h*n+c*i-u*s,t[1]=c*a+h*s+u*n-o*i,t[2]=u*a+h*i+o*s-c*n,t[3]=h*a-o*n-c*s-u*i,o=e[4],c=e[5],u=e[6],h=e[7],t[4]=o*a+h*n+c*i-u*s,t[5]=c*a+h*s+u*n-o*i,t[6]=u*a+h*i+o*s-c*n,t[7]=h*a-o*n-c*s-u*i,t}function od(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=r[0],c=r[1],u=r[2],h=r[3];return t[0]=n*h+a*o+s*u-i*c,t[1]=s*h+a*c+i*o-n*u,t[2]=i*h+a*u+n*c-s*o,t[3]=a*h-n*o-s*c-i*u,o=r[4],c=r[5],u=r[6],h=r[7],t[4]=n*h+a*o+s*u-i*c,t[5]=s*h+a*c+i*o-n*u,t[6]=i*h+a*u+n*c-s*o,t[7]=a*h-n*o-s*c-i*u,t}function cd(t,e,r,n){if(Math.abs(n)<W)return ac(t,e);var s=Math.hypot(r[0],r[1],r[2]);n=n*.5;var i=Math.sin(n),a=i*r[0]/s,o=i*r[1]/s,c=i*r[2]/s,u=Math.cos(n),h=e[0],d=e[1],m=e[2],x=e[3];t[0]=h*u+x*a+d*c-m*o,t[1]=d*u+x*o+m*a-h*c,t[2]=m*u+x*c+h*o-d*a,t[3]=x*u-h*a-d*o-m*c;var M=e[4],w=e[5],p=e[6],R=e[7];return t[4]=M*u+R*a+w*c-p*o,t[5]=w*u+R*o+p*a-M*c,t[6]=p*u+R*c+M*o-w*a,t[7]=R*u-M*a-w*o-p*c,t}function ld(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t}function oc(t,e,r){var n=e[0],s=e[1],i=e[2],a=e[3],o=r[4],c=r[5],u=r[6],h=r[7],d=e[4],m=e[5],x=e[6],M=e[7],w=r[0],p=r[1],R=r[2],g=r[3];return t[0]=n*g+a*w+s*R-i*p,t[1]=s*g+a*p+i*w-n*R,t[2]=i*g+a*R+n*p-s*w,t[3]=a*g-n*w-s*p-i*R,t[4]=n*h+a*o+s*u-i*c+d*g+M*w+m*R-x*p,t[5]=s*h+a*c+i*o-n*u+m*g+M*p+x*w-d*R,t[6]=i*h+a*u+n*c-s*o+x*g+M*R+d*p-m*w,t[7]=a*h-n*o-s*c-i*u+M*g-d*w-m*p-x*R,t}var fd=oc;function ud(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t}var cc=Us;function hd(t,e,r,n){var s=1-n;return cc(e,r)<0&&(n=-n),t[0]=e[0]*s+r[0]*n,t[1]=e[1]*s+r[1]*n,t[2]=e[2]*s+r[2]*n,t[3]=e[3]*s+r[3]*n,t[4]=e[4]*s+r[4]*n,t[5]=e[5]*s+r[5]*n,t[6]=e[6]*s+r[6]*n,t[7]=e[7]*s+r[7]*n,t}function pd(t,e){var r=yn(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t}function gd(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var lc=Ls,dd=lc,yn=Bs,md=yn;function vd(t,e){var r=yn(e);if(r>0){r=Math.sqrt(r);var n=e[0]/r,s=e[1]/r,i=e[2]/r,a=e[3]/r,o=e[4],c=e[5],u=e[6],h=e[7],d=n*o+s*c+i*u+a*h;t[0]=n,t[1]=s,t[2]=i,t[3]=a,t[4]=(o-n*d)/r,t[5]=(c-s*d)/r,t[6]=(u-i*d)/r,t[7]=(h-a*d)/r}return t}function xd(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function yd(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function Td(t,e){var r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],o=t[5],c=t[6],u=t[7],h=e[0],d=e[1],m=e[2],x=e[3],M=e[4],w=e[5],p=e[6],R=e[7];return Math.abs(r-h)<=W*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-d)<=W*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(s-m)<=W*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(i-x)<=W*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-M)<=W*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(o-w)<=W*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(c-p)<=W*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(u-R)<=W*Math.max(1,Math.abs(u),Math.abs(R))}var Md=Object.freeze({__proto__:null,add:ld,clone:kg,conjugate:gd,copy:ac,create:zg,dot:cc,equals:Td,exactEquals:yd,fromMat4:Xg,fromRotation:Wg,fromRotationTranslation:ic,fromRotationTranslationValues:qg,fromTranslation:Hg,fromValues:Gg,getDual:Zg,getReal:Jg,getTranslation:td,identity:Yg,invert:pd,len:dd,length:lc,lerp:hd,mul:fd,multiply:oc,normalize:vd,rotateAroundAxis:cd,rotateByQuatAppend:ad,rotateByQuatPrepend:od,rotateX:nd,rotateY:sd,rotateZ:id,scale:ud,set:Kg,setDual:ed,setReal:Qg,sqrLen:md,squaredLength:yn,str:xd,translate:rd});function fc(){var t=new ee(2);return ee!=Float32Array&&(t[0]=0,t[1]=0),t}function Ed(t){var e=new ee(2);return e[0]=t[0],e[1]=t[1],e}function Rd(t,e){var r=new ee(2);return r[0]=t,r[1]=e,r}function wd(t,e){return t[0]=e[0],t[1]=e[1],t}function Id(t,e,r){return t[0]=e,t[1]=r,t}function Ad(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function uc(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function hc(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function pc(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function bd(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function _d(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Sd(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function Cd(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function Nd(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function Od(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function $d(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function gc(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.hypot(r,n)}function dc(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function mc(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function vc(t){var e=t[0],r=t[1];return e*e+r*r}function Fd(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Dd(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Pd(t,e){var r=e[0],n=e[1],s=r*r+n*n;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t}function Ud(t,e){return t[0]*e[0]+t[1]*e[1]}function Ld(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function Bd(t,e,r,n){var s=e[0],i=e[1];return t[0]=s+n*(r[0]-s),t[1]=i+n*(r[1]-i),t}function Vd(t,e){e=e||1;var r=Qe()*2*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function jd(t,e,r){var n=e[0],s=e[1];return t[0]=r[0]*n+r[2]*s,t[1]=r[1]*n+r[3]*s,t}function zd(t,e,r){var n=e[0],s=e[1];return t[0]=r[0]*n+r[2]*s+r[4],t[1]=r[1]*n+r[3]*s+r[5],t}function kd(t,e,r){var n=e[0],s=e[1];return t[0]=r[0]*n+r[3]*s+r[6],t[1]=r[1]*n+r[4]*s+r[7],t}function Gd(t,e,r){var n=e[0],s=e[1];return t[0]=r[0]*n+r[4]*s+r[12],t[1]=r[1]*n+r[5]*s+r[13],t}function qd(t,e,r,n){var s=e[0]-r[0],i=e[1]-r[1],a=Math.sin(n),o=Math.cos(n);return t[0]=s*o-i*a+r[0],t[1]=s*a+i*o+r[1],t}function Hd(t,e){var r=t[0],n=t[1],s=e[0],i=e[1],a=Math.sqrt(r*r+n*n)*Math.sqrt(s*s+i*i),o=a&&(r*s+n*i)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function Wd(t){return t[0]=0,t[1]=0,t}function Xd(t){return"vec2("+t[0]+", "+t[1]+")"}function Yd(t,e){return t[0]===e[0]&&t[1]===e[1]}function Kd(t,e){var r=t[0],n=t[1],s=e[0],i=e[1];return Math.abs(r-s)<=W*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-i)<=W*Math.max(1,Math.abs(n),Math.abs(i))}var Jd=mc,Zd=uc,Qd=hc,e0=pc,t0=gc,r0=dc,n0=vc,s0=function(){var t=fc();return function(e,r,n,s,i,a){var o,c;for(r||(r=2),n||(n=0),s?c=Math.min(s*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],i(t,t,a),e[o]=t[0],e[o+1]=t[1];return e}}(),i0=Object.freeze({__proto__:null,add:Ad,angle:Hd,ceil:bd,clone:Ed,copy:wd,create:fc,cross:Ld,dist:t0,distance:gc,div:e0,divide:pc,dot:Ud,equals:Kd,exactEquals:Yd,floor:_d,forEach:s0,fromValues:Rd,inverse:Dd,len:Jd,length:mc,lerp:Bd,max:Cd,min:Sd,mul:Qd,multiply:hc,negate:Fd,normalize:Pd,random:Vd,rotate:qd,round:Nd,scale:Od,scaleAndAdd:$d,set:Id,sqrDist:r0,sqrLen:n0,squaredDistance:dc,squaredLength:vc,str:Xd,sub:Zd,subtract:uc,transformMat2:jd,transformMat2d:zd,transformMat3:kd,transformMat4:Gd,zero:Wd}),xc=Object.freeze({__proto__:null,glMatrix:Zu,mat2:Rh,mat2d:Wh,mat3:Rp,mat4:h1,quat:jg,quat2:Md,vec2:i0,vec3:X1,vec4:vg}),a0=(()=>{var t=import.meta.url;return async function(e={}){var r,n=e,s,i,a=new Promise((l,f)=>{s=l,i=f}),o=typeof window=="object",c=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(u){const{createRequire:l}=await import("./__vite-browser-external-4ed993c7.js");var h=l(import.meta.url)}var d=!1;n.setup=function(){if(d)return;d=!0;function l(A,S,F=k=>k){if(S)for(let k of S)A.push_back(F(k));return A}function f(A,S=F=>F){const F=[],k=A.size();for(let K=0;K<k;K++)F.push(S(A.get(K)));return F}function v(A,S=F=>F){const F=[],k=A.size();for(let K=0;K<k;K++){const me=A.get(K),Te=me.size(),ze=[];for(let Ce=0;Ce<Te;Ce++)ze.push(S(me.get(Ce)));F.push(ze)}return F}function E(A){return A[0].length<3&&(A=[A]),l(new n.Vector2_vec2,A,S=>l(new n.Vector_vec2,S,F=>F instanceof Array?{x:F[0],y:F[1]}:F))}function b(A){for(let S=0;S<A.size();S++)A.get(S).delete();A.delete()}function N(A){return A[0]instanceof Array?{x:A[0][0],y:A[0][1]}:typeof A[0]=="number"?{x:A[0]||0,y:A[1]||0}:A[0]}function P(A){return A[0]instanceof Array?{x:A[0][0],y:A[0][1],z:A[0][2]}:typeof A[0]=="number"?{x:A[0]||0,y:A[1]||0,z:A[2]||0}:A[0]}function O(A){return A=="EvenOdd"?0:A=="NonZero"?1:A=="Negative"?3:2}function B(A){return A=="Round"?1:A=="Miter"?2:0}const z=n.CrossSection;function H(A,S="Positive"){if(A instanceof z)return A;{const F=E(A),k=new z(F,O(S));return b(F),k}}n.CrossSection.prototype.translate=function(...A){return this._Translate(N(A))},n.CrossSection.prototype.scale=function(A){return typeof A=="number"?this._Scale({x:A,y:A}):this._Scale(N([A]))},n.CrossSection.prototype.mirror=function(A){return this._Mirror(N([A]))},n.CrossSection.prototype.warp=function(A){const S=pr(function(k){const K=Xe(k,"double"),me=Xe(k+8,"double"),Te=[K,me];A(Te),qt(k,Te[0],"double"),qt(k+8,Te[1],"double")},"vi"),F=this._Warp(S);return gr(S),F},n.CrossSection.prototype.decompose=function(){const A=this._Decompose(),S=f(A);return A.delete(),S},n.CrossSection.prototype.bounds=function(){const A=this._Bounds();return{min:["x","y"].map(S=>A.min[S]),max:["x","y"].map(S=>A.max[S])}},n.CrossSection.prototype.offset=function(A,S="Square",F=2,k=0){return this._Offset(A,B(S),F,k)},n.CrossSection.prototype.extrude=function(A,S=0,F=0,k=[1,1],K=!1){k=N([k]);const me=n._Extrude(this._ToPolygons(),A,S,F,k);return K?me.translate([0,0,-A/2]):me},n.CrossSection.prototype.revolve=function(A=0,S=360){return n._Revolve(this._ToPolygons(),A,S)},n.CrossSection.prototype.add=function(A){return this._add(H(A))},n.CrossSection.prototype.subtract=function(A){return this._subtract(H(A))},n.CrossSection.prototype.intersect=function(A){return this._intersect(H(A))},n.CrossSection.prototype.toPolygons=function(){const A=this._ToPolygons(),S=v(A,F=>[F.x,F.y]);return A.delete(),S},n.Manifold.prototype.smoothOut=function(A=60,S=0){return this._SmoothOut(A,S)},n.Manifold.prototype.warp=function(A){const S=pr(function(K){const me=Xe(K,"double"),Te=Xe(K+8,"double"),ze=Xe(K+16,"double"),Ce=[me,Te,ze];A(Ce),qt(K,Ce[0],"double"),qt(K+8,Ce[1],"double"),qt(K+16,Ce[2],"double")},"vi"),F=this._Warp(S);gr(S);const k=F.status();if(k.value!==0)throw new n.ManifoldError(k.value);return F},n.Manifold.prototype.calculateNormals=function(A,S=60){return this._CalculateNormals(A,S)},n.Manifold.prototype.setProperties=function(A,S){const F=this.numProp(),k=pr(function(me,Te,ze){const Ce=[];for(let Me=0;Me<A;++Me)Ce[Me]=Xe(me+8*Me,"double");const Yt=[];for(let Me=0;Me<3;++Me)Yt[Me]=Xe(Te+8*Me,"double");const Kt=[];for(let Me=0;Me<F;++Me)Kt[Me]=Xe(ze+8*Me,"double");S(Ce,Yt,Kt);for(let Me=0;Me<A;++Me)qt(me+8*Me,Ce[Me],"double")},"viii"),K=this._SetProperties(A,k);return gr(k),K},n.Manifold.prototype.translate=function(...A){return this._Translate(P(A))},n.Manifold.prototype.rotate=function(A,S,F){return Array.isArray(A)?this._Rotate(...A):this._Rotate(A,S||0,F||0)},n.Manifold.prototype.scale=function(A){return typeof A=="number"?this._Scale({x:A,y:A,z:A}):this._Scale(P([A]))},n.Manifold.prototype.mirror=function(A){return this._Mirror(P([A]))},n.Manifold.prototype.trimByPlane=function(A,S=0){return this._TrimByPlane(P([A]),S)},n.Manifold.prototype.slice=function(A=0){const S=this._Slice(A),F=new z(S,O("Positive"));return b(S),F},n.Manifold.prototype.project=function(){const A=this._Project(),S=new z(A,O("Positive"));return b(A),S},n.Manifold.prototype.split=function(A){const S=this._Split(A),F=f(S);return S.delete(),F},n.Manifold.prototype.splitByPlane=function(A,S=0){const F=this._SplitByPlane(P([A]),S),k=f(F);return F.delete(),k},n.Manifold.prototype.decompose=function(){const A=this._Decompose(),S=f(A);return A.delete(),S},n.Manifold.prototype.boundingBox=function(){const A=this._boundingBox();return{min:["x","y","z"].map(S=>A.min[S]),max:["x","y","z"].map(S=>A.max[S])}};class Z{constructor({numProp:S=3,triVerts:F=new Uint32Array,vertProperties:k=new Float32Array,mergeFromVert:K,mergeToVert:me,runIndex:Te,runOriginalID:ze,faceID:Ce,halfedgeTangent:Yt,runTransform:Kt}={}){this.numProp=S,this.triVerts=F,this.vertProperties=k,this.mergeFromVert=K,this.mergeToVert=me,this.runIndex=Te,this.runOriginalID=ze,this.faceID=Ce,this.halfedgeTangent=Yt,this.runTransform=Kt}get numTri(){return this.triVerts.length/3}get numVert(){return this.vertProperties.length/this.numProp}get numRun(){return this.runOriginalID.length}merge(){const{changed:S,mesh:F}=n._Merge(this);return Object.assign(this,{...F}),S}verts(S){return this.triVerts.subarray(3*S,3*(S+1))}position(S){return this.vertProperties.subarray(this.numProp*S,this.numProp*S+3)}extras(S){return this.vertProperties.subarray(this.numProp*S+3,this.numProp*(S+1))}tangent(S){return this.halfedgeTangent.subarray(4*S,4*(S+1))}transform(S){const F=new Array(16);for(const k of[0,1,2,3])for(const K of[0,1,2])F[4*k+K]=this.runTransform[12*S+3*k+K];return F[15]=1,F}}n.Mesh=Z,n.Manifold.prototype.getMesh=function(A=-1){return new Z(this._GetMeshJS(A))},n.ManifoldError=function(S,...F){let k="Unknown error";switch(S){case n.status.NonFiniteVertex.value:k="Non-finite vertex";break;case n.status.NotManifold.value:k="Not manifold";break;case n.status.VertexOutOfBounds.value:k="Vertex index out of bounds";break;case n.status.PropertiesWrongLength.value:k="Properties have wrong length";break;case n.status.MissingPositionProperties.value:k="Less than three properties";break;case n.status.MergeVectorsDifferentLengths.value:k="Merge vectors have different lengths";break;case n.status.MergeIndexOutOfBounds.value:k="Merge index out of bounds";break;case n.status.TransformWrongLength.value:k="Transform vector has wrong length";break;case n.status.RunIndexWrongLength.value:k="Run index vector has wrong length";break;case n.status.FaceIDWrongLength.value:k="Face ID vector has wrong length";case n.status.InvalidConstruction.value:k="Manifold constructed with invalid parameters"}const K=Error.apply(this,[k,...F]);K.name=this.name="ManifoldError",this.message=K.message,this.stack=K.stack,this.code=S},n.ManifoldError.prototype=Object.create(Error.prototype,{constructor:{value:n.ManifoldError,writable:!0,configurable:!0}}),n.CrossSection=function(A,S="Positive"){const F=E(A),k=new z(F,O(S));return b(F),k},n.CrossSection.ofPolygons=function(A,S="Positive"){return new n.CrossSection(A,S)},n.CrossSection.square=function(...A){let S;A.length==0?S={x:1,y:1}:typeof A[0]=="number"?S={x:A[0],y:A[0]}:S=N(A);const F=A[1]||!1;return n._Square(S,F)},n.CrossSection.circle=function(A,S=0){return n._Circle(A,S)};function se(A){return function(...S){S.length==1&&(S=S[0]);const F=new n.Vector_crossSection;for(const K of S)F.push_back(H(K));const k=n["_crossSection"+A](F);return F.delete(),k}}n.CrossSection.compose=se("Compose"),n.CrossSection.union=se("UnionN"),n.CrossSection.difference=se("DifferenceN"),n.CrossSection.intersection=se("IntersectionN");function Ie(A,S){l(A,S,F=>F instanceof Array?{x:F[0],y:F[1]}:F)}n.CrossSection.hull=function(...A){A.length==1&&(A=A[0]);let S=new n.Vector_vec2;for(const k of A)if(k instanceof z)n._crossSectionCollectVertices(S,k);else if(k instanceof Array&&k.length==2&&typeof k[0]=="number")S.push_back({x:k[0],y:k[1]});else if(k.x)S.push_back(k);else{const me=k[0].length==2&&typeof k[0][0]=="number"||k[0].x?[k]:k;for(const Te of me)Ie(S,Te)}const F=n._crossSectionHullPoints(S);return S.delete(),F},n.CrossSection.prototype=Object.create(z.prototype),Object.defineProperty(n.CrossSection,Symbol.hasInstance,{get:()=>A=>A instanceof z});const xe=n.Manifold;n.Manifold=function(A){const S=new xe(A),F=S.status();if(F.value!==0)throw new n.ManifoldError(F.value);return S},n.Manifold.ofMesh=function(A){return new n.Manifold(A)},n.Manifold.tetrahedron=function(){return n._Tetrahedron()},n.Manifold.cube=function(...A){let S;A.length==0?S={x:1,y:1,z:1}:typeof A[0]=="number"?S={x:A[0],y:A[0],z:A[0]}:S=P(A);const F=A[1]||!1;return n._Cube(S,F)},n.Manifold.cylinder=function(A,S,F=-1,k=0,K=!1){return n._Cylinder(A,S,F,k,K)},n.Manifold.sphere=function(A,S=0){return n._Sphere(A,S)},n.Manifold.smooth=function(A,S=[]){const F=new n.Vector_smoothness;l(F,S);const k=n._Smooth(A,F);return F.delete(),k},n.Manifold.extrude=function(A,S,F=0,k=0,K=[1,1],me=!1){return(A instanceof z?A:n.CrossSection(A,"Positive")).extrude(S,F,k,K,me)},n.Manifold.revolve=function(A,S=0,F=360){return(A instanceof z?A:n.CrossSection(A,"Positive")).revolve(S,F)},n.Manifold.reserveIDs=function(A){return n._ReserveIDs(A)},n.Manifold.compose=function(A){const S=new n.Vector_manifold;l(S,A);const F=n._manifoldCompose(S);return S.delete(),F};function Je(A){return function(...S){S.length==1&&(S=S[0]);const F=new n.Vector_manifold;for(const K of S)F.push_back(K);const k=n["_manifold"+A+"N"](F);return F.delete(),k}}n.Manifold.union=Je("Union"),n.Manifold.difference=Je("Difference"),n.Manifold.intersection=Je("Intersection"),n.Manifold.levelSet=function(A,S,F,k=0,K=-1){const me={min:{x:S.min[0],y:S.min[1],z:S.min[2]},max:{x:S.max[0],y:S.max[1],z:S.max[2]}},Te=pr(function(Ce){const Yt=Xe(Ce,"double"),Kt=Xe(Ce+8,"double"),Me=Xe(Ce+16,"double");return A([Yt,Kt,Me])},"di"),ze=n._LevelSet(Te,me,F,k,K);return gr(Te),ze};function Ze(A,S){l(A,S,F=>F instanceof Array?{x:F[0],y:F[1],z:F[2]}:F)}n.Manifold.hull=function(...A){A.length==1&&(A=A[0]);let S=new n.Vector_vec3;for(const k of A)k instanceof xe?n._manifoldCollectVertices(S,k):k instanceof Array&&k.length==3&&typeof k[0]=="number"?S.push_back({x:k[0],y:k[1],z:k[2]}):k.x?S.push_back(k):Ze(S,k);const F=n._manifoldHullPoints(S);return S.delete(),F},n.Manifold.prototype=Object.create(xe.prototype),Object.defineProperty(n.Manifold,Symbol.hasInstance,{get:()=>A=>A instanceof xe}),n.triangulate=function(A,S=-1){const F=E(A),k=f(n._Triangulate(F,S),K=>[K[0],K[1],K[2]]);return b(F),k}};var m=Object.assign({},n),x="";function M(l){return n.locateFile?n.locateFile(l,x):x+l}var w,p,R;if(u){var g=h("fs"),y=h("path");x=h("url").fileURLToPath(new URL("./",self.location)),w=(l,f)=>(l=rt(l)?new URL(l):y.normalize(l),g.readFileSync(l,f?void 0:"utf8")),R=l=>{var f=w(l,!0);return f.buffer||(f=new Uint8Array(f)),f},p=(l,f,v,E=!0)=>{l=rt(l)?new URL(l):y.normalize(l),g.readFile(l,E?void 0:"utf8",(b,N)=>{b?v(b):f(E?N.buffer:N)})},!n.thisProgram&&process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2)}else(o||c)&&(c?x=self.location.href:typeof document<"u"&&document.currentScript&&(x=document.currentScript.src),t&&(x=t),x.startsWith("blob:")?x="":x=x.substr(0,x.replace(/[?#].*/,"").lastIndexOf("/")+1),w=l=>{var f=new XMLHttpRequest;return f.open("GET",l,!1),f.send(null),f.responseText},c&&(R=l=>{var f=new XMLHttpRequest;return f.open("GET",l,!1),f.responseType="arraybuffer",f.send(null),new Uint8Array(f.response)}),p=(l,f,v)=>{if(rt(l)){var E=new XMLHttpRequest;E.open("GET",l,!0),E.responseType="arraybuffer",E.onload=()=>{if(E.status==200||E.status==0&&E.response){f(E.response);return}v()},E.onerror=v,E.send(null);return}fetch(l,{credentials:"same-origin"}).then(b=>b.ok?b.arrayBuffer():Promise.reject(new Error(b.status+" : "+b.url))).then(f,v)});n.print||console.log.bind(console);var T=n.printErr||console.error.bind(console);Object.assign(n,m),m=null,n.arguments&&n.arguments,n.thisProgram&&n.thisProgram,n.quit&&n.quit;var I;n.wasmBinary&&(I=n.wasmBinary);var _,U=!1,$,C,j,V,q,L,D,X;function te(){var l=_.buffer;n.HEAP8=$=new Int8Array(l),n.HEAP16=j=new Int16Array(l),n.HEAPU8=C=new Uint8Array(l),n.HEAPU16=V=new Uint16Array(l),n.HEAP32=q=new Int32Array(l),n.HEAPU32=L=new Uint32Array(l),n.HEAPF32=D=new Float32Array(l),n.HEAPF64=X=new Float64Array(l)}var J=[],ie=[],re=[];function ae(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)Ae(n.preRun.shift());En(J)}function oe(){En(ie)}function le(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)de(n.postRun.shift());En(re)}function Ae(l){J.unshift(l)}function ue(l){ie.unshift(l)}function de(l){re.unshift(l)}var be=0,Fe=null;function dt(l){be++,n.monitorRunDependencies?.(be)}function he(l){if(be--,n.monitorRunDependencies?.(be),be==0&&Fe){var f=Fe;Fe=null,f()}}function je(l){n.onAbort?.(l),l="Aborted("+l+")",T(l),U=!0,l+=". Build with -sASSERTIONS for more info.";var f=new WebAssembly.RuntimeError(l);throw i(f),f}var Be="data:application/octet-stream;base64,",vt=l=>l.startsWith(Be),rt=l=>l.startsWith("file://");function xt(){if(n.locateFile){var l="manifold.wasm";return vt(l)?l:M(l)}return new URL("/assets/manifold-9b2fe413.wasm",self.location).href}var Gt;function Pr(l){if(l==Gt&&I)return new Uint8Array(I);if(R)return R(l);throw"both async and sync fetching of the wasm failed"}function Mn(l){return I?Promise.resolve().then(()=>Pr(l)):new Promise((f,v)=>{p(l,E=>f(new Uint8Array(E)),E=>{try{f(Pr(l))}catch(b){v(b)}})})}function Gs(l,f,v){return Mn(l).then(E=>WebAssembly.instantiate(E,f)).then(v,E=>{T(`failed to asynchronously prepare wasm: ${E}`),je(E)})}function Sc(l,f,v,E){return!l&&typeof WebAssembly.instantiateStreaming=="function"&&!vt(f)&&!rt(f)&&!u&&typeof fetch=="function"?fetch(f,{credentials:"same-origin"}).then(b=>{var N=WebAssembly.instantiateStreaming(b,v);return N.then(E,function(P){return T(`wasm streaming compile failed: ${P}`),T("falling back to ArrayBuffer instantiation"),Gs(f,v,E)})}):Gs(f,v,E)}function Cc(){return{a:uf}}function Nc(){var l=Cc();function f(E,b){return Ke=E.exports,Ke=hf(Ke),_=Ke.J,te(),Mt=Ke.M,ue(Ke.K),he(),Ke}dt();function v(E){f(E.instance)}if(n.instantiateWasm)try{return n.instantiateWasm(l,f)}catch(E){T(`Module.instantiateWasm callback failed with error: ${E}`),i(E)}return Gt||(Gt=xt()),Sc(I,Gt,l,v).catch(i),{}}var En=l=>{for(;l.length>0;)l.shift()(n)};function Xe(l,f="i8"){switch(f.endsWith("*")&&(f="*"),f){case"i1":return $[l>>>0];case"i8":return $[l>>>0];case"i16":return j[l>>>1>>>0];case"i32":return q[l>>>2>>>0];case"i64":je("to do getValue(i64) use WASM_BIGINT");case"float":return D[l>>>2>>>0];case"double":return X[l>>>3>>>0];case"*":return L[l>>>2>>>0];default:je(`invalid type for getValue: ${f}`)}}n.noExitRuntime;function qt(l,f,v="i8"){switch(v.endsWith("*")&&(v="*"),v){case"i1":$[l>>>0]=f;break;case"i8":$[l>>>0]=f;break;case"i16":j[l>>>1>>>0]=f;break;case"i32":q[l>>>2>>>0]=f;break;case"i64":je("to do setValue(i64) use WASM_BIGINT");case"float":D[l>>>2>>>0]=f;break;case"double":X[l>>>3>>>0]=f;break;case"*":L[l>>>2>>>0]=f;break;default:je(`invalid type for setValue: ${v}`)}}class Oc{constructor(f){this.excPtr=f,this.ptr=f-24}set_type(f){L[this.ptr+4>>>2>>>0]=f}get_type(){return L[this.ptr+4>>>2>>>0]}set_destructor(f){L[this.ptr+8>>>2>>>0]=f}get_destructor(){return L[this.ptr+8>>>2>>>0]}set_caught(f){f=f?1:0,$[this.ptr+12>>>0]=f}get_caught(){return $[this.ptr+12>>>0]!=0}set_rethrown(f){f=f?1:0,$[this.ptr+13>>>0]=f}get_rethrown(){return $[this.ptr+13>>>0]!=0}init(f,v){this.set_adjusted_ptr(0),this.set_type(f),this.set_destructor(v)}set_adjusted_ptr(f){L[this.ptr+16>>>2>>>0]=f}get_adjusted_ptr(){return L[this.ptr+16>>>2>>>0]}get_exception_ptr(){var f=pi(this.get_type());if(f)return L[this.excPtr>>>2>>>0];var v=this.get_adjusted_ptr();return v!==0?v:this.excPtr}}var qs=0;function $c(l,f,v){l>>>=0,f>>>=0,v>>>=0;var E=new Oc(l);throw E.init(f,v),qs=l,qs}var Fc=()=>{je("")},Ur={},Rn=l=>{for(;l.length;){var f=l.pop(),v=l.pop();v(f)}};function or(l){return this.fromWireType(L[l>>>2>>>0])}var Ht={},yt={},Lr={},Hs,Br=l=>{throw new Hs(l)},Tt=(l,f,v)=>{l.forEach(function(O){Lr[O]=f});function E(O){var B=v(O);B.length!==l.length&&Br("Mismatched type converter count");for(var z=0;z<l.length;++z)nt(l[z],B[z])}var b=new Array(f.length),N=[],P=0;f.forEach((O,B)=>{yt.hasOwnProperty(O)?b[B]=yt[O]:(N.push(O),Ht.hasOwnProperty(O)||(Ht[O]=[]),Ht[O].push(()=>{b[B]=yt[O],++P,P===N.length&&E(b)}))}),N.length===0&&E(b)},Dc=function(l){l>>>=0;var f=Ur[l];delete Ur[l];var v=f.rawConstructor,E=f.rawDestructor,b=f.fields,N=b.map(P=>P.getterReturnType).concat(b.map(P=>P.setterArgumentType));Tt([l],N,P=>{var O={};return b.forEach((B,z)=>{var H=B.fieldName,Z=P[z],se=B.getter,Ie=B.getterContext,xe=P[z+b.length],Je=B.setter,Ze=B.setterContext;O[H]={read:A=>Z.fromWireType(se(Ie,A)),write:(A,S)=>{var F=[];Je(Ze,A,xe.toWireType(F,S)),Rn(F)}}}),[{name:f.name,fromWireType:B=>{var z={};for(var H in O)z[H]=O[H].read(B);return E(B),z},toWireType:(B,z)=>{for(var H in O)if(!(H in z))throw new TypeError(`Missing field: "${H}"`);var Z=v();for(H in O)O[H].write(Z,z[H]);return B!==null&&B.push(E,Z),Z},argPackAdvance:st,readValueFromPointer:or,destructorFunction:E}]})};function Pc(l,f,v,E,b){}var Uc=()=>{for(var l=new Array(256),f=0;f<256;++f)l[f]=String.fromCharCode(f);Ws=l},Ws,Ne=l=>{for(var f="",v=l;C[v>>>0];)f+=Ws[C[v++>>>0]];return f},Wt,ne=l=>{throw new Wt(l)};function Lc(l,f,v={}){var E=f.name;if(l||ne(`type "${E}" must have a positive integer typeid pointer`),yt.hasOwnProperty(l)){if(v.ignoreDuplicateRegistrations)return;ne(`Cannot register type '${E}' twice`)}if(yt[l]=f,delete Lr[l],Ht.hasOwnProperty(l)){var b=Ht[l];delete Ht[l],b.forEach(N=>N())}}function nt(l,f,v={}){if(!("argPackAdvance"in f))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Lc(l,f,v)}var st=8;function Bc(l,f,v,E){l>>>=0,f>>>=0,f=Ne(f),nt(l,{name:f,fromWireType:function(b){return!!b},toWireType:function(b,N){return N?v:E},argPackAdvance:st,readValueFromPointer:function(b){return this.fromWireType(C[b>>>0])},destructorFunction:null})}var Vc=l=>({count:l.count,deleteScheduled:l.deleteScheduled,preservePointerOnDelete:l.preservePointerOnDelete,ptr:l.ptr,ptrType:l.ptrType,smartPtr:l.smartPtr,smartPtrType:l.smartPtrType}),wn=l=>{function f(v){return v.$$.ptrType.registeredClass.name}ne(f(l)+" instance already deleted")},In=!1,Xs=l=>{},jc=l=>{l.smartPtr?l.smartPtrType.rawDestructor(l.smartPtr):l.ptrType.registeredClass.rawDestructor(l.ptr)},Ys=l=>{l.count.value-=1;var f=l.count.value===0;f&&jc(l)},Ks=(l,f,v)=>{if(f===v)return l;if(v.baseClass===void 0)return null;var E=Ks(l,f,v.baseClass);return E===null?null:v.downcast(E)},Js={},zc=()=>Object.keys(fr).length,kc=()=>{var l=[];for(var f in fr)fr.hasOwnProperty(f)&&l.push(fr[f]);return l},cr=[],An=()=>{for(;cr.length;){var l=cr.pop();l.$$.deleteScheduled=!1,l.delete()}},lr,Gc=l=>{lr=l,cr.length&&lr&&lr(An)},qc=()=>{n.getInheritedInstanceCount=zc,n.getLiveInheritedInstances=kc,n.flushPendingDeletes=An,n.setDelayFunction=Gc},fr={},Hc=(l,f)=>{for(f===void 0&&ne("ptr should not be undefined");l.baseClass;)f=l.upcast(f),l=l.baseClass;return f},Wc=(l,f)=>(f=Hc(l,f),fr[f]),Vr=(l,f)=>{(!f.ptrType||!f.ptr)&&Br("makeClassHandle requires ptr and ptrType");var v=!!f.smartPtrType,E=!!f.smartPtr;return v!==E&&Br("Both smartPtrType and smartPtr must be specified"),f.count={value:1},ur(Object.create(l,{$$:{value:f,writable:!0}}))};function Xc(l){var f=this.getPointee(l);if(!f)return this.destructor(l),null;var v=Wc(this.registeredClass,f);if(v!==void 0){if(v.$$.count.value===0)return v.$$.ptr=f,v.$$.smartPtr=l,v.clone();var E=v.clone();return this.destructor(l),E}function b(){return this.isSmartPointer?Vr(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:f,smartPtrType:this,smartPtr:l}):Vr(this.registeredClass.instancePrototype,{ptrType:this,ptr:l})}var N=this.registeredClass.getActualType(f),P=Js[N];if(!P)return b.call(this);var O;this.isConst?O=P.constPointerType:O=P.pointerType;var B=Ks(f,this.registeredClass,O.registeredClass);return B===null?b.call(this):this.isSmartPointer?Vr(O.registeredClass.instancePrototype,{ptrType:O,ptr:B,smartPtrType:this,smartPtr:l}):Vr(O.registeredClass.instancePrototype,{ptrType:O,ptr:B})}var ur=l=>typeof FinalizationRegistry>"u"?(ur=f=>f,l):(In=new FinalizationRegistry(f=>{Ys(f.$$)}),ur=f=>{var v=f.$$,E=!!v.smartPtr;if(E){var b={$$:v};In.register(f,b,f)}return f},Xs=f=>In.unregister(f),ur(l)),Yc=()=>{Object.assign(jr.prototype,{isAliasOf(l){if(!(this instanceof jr)||!(l instanceof jr))return!1;var f=this.$$.ptrType.registeredClass,v=this.$$.ptr;l.$$=l.$$;for(var E=l.$$.ptrType.registeredClass,b=l.$$.ptr;f.baseClass;)v=f.upcast(v),f=f.baseClass;for(;E.baseClass;)b=E.upcast(b),E=E.baseClass;return f===E&&v===b},clone(){if(this.$$.ptr||wn(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var l=ur(Object.create(Object.getPrototypeOf(this),{$$:{value:Vc(this.$$)}}));return l.$$.count.value+=1,l.$$.deleteScheduled=!1,l},delete(){this.$$.ptr||wn(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ne("Object already scheduled for deletion"),Xs(this),Ys(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||wn(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ne("Object already scheduled for deletion"),cr.push(this),cr.length===1&&lr&&lr(An),this.$$.deleteScheduled=!0,this}})};function jr(){}var Xt=(l,f)=>Object.defineProperty(f,"name",{value:l}),Zs=(l,f,v)=>{if(l[f].overloadTable===void 0){var E=l[f];l[f]=function(...b){return l[f].overloadTable.hasOwnProperty(b.length)||ne(`Function '${v}' called with an invalid number of arguments (${b.length}) - expects one of (${l[f].overloadTable})!`),l[f].overloadTable[b.length].apply(this,b)},l[f].overloadTable=[],l[f].overloadTable[E.argCount]=E}},bn=(l,f,v)=>{n.hasOwnProperty(l)?((v===void 0||n[l].overloadTable!==void 0&&n[l].overloadTable[v]!==void 0)&&ne(`Cannot register public name '${l}' twice`),Zs(n,l,l),n.hasOwnProperty(v)&&ne(`Cannot register multiple overloads of a function with the same number of arguments (${v})!`),n[l].overloadTable[v]=f):(n[l]=f,v!==void 0&&(n[l].numArguments=v))},Kc=48,Jc=57,Zc=l=>{if(l===void 0)return"_unknown";l=l.replace(/[^a-zA-Z0-9_]/g,"$");var f=l.charCodeAt(0);return f>=Kc&&f<=Jc?`_${l}`:l};function Qc(l,f,v,E,b,N,P,O){this.name=l,this.constructor=f,this.instancePrototype=v,this.rawDestructor=E,this.baseClass=b,this.getActualType=N,this.upcast=P,this.downcast=O,this.pureVirtualFunctions=[]}var _n=(l,f,v)=>{for(;f!==v;)f.upcast||ne(`Expected null or instance of ${v.name}, got an instance of ${f.name}`),l=f.upcast(l),f=f.baseClass;return l};function el(l,f){if(f===null)return this.isReference&&ne(`null is not a valid ${this.name}`),0;f.$$||ne(`Cannot pass "${$n(f)}" as a ${this.name}`),f.$$.ptr||ne(`Cannot pass deleted object as a pointer of type ${this.name}`);var v=f.$$.ptrType.registeredClass,E=_n(f.$$.ptr,v,this.registeredClass);return E}function tl(l,f){var v;if(f===null)return this.isReference&&ne(`null is not a valid ${this.name}`),this.isSmartPointer?(v=this.rawConstructor(),l!==null&&l.push(this.rawDestructor,v),v):0;(!f||!f.$$)&&ne(`Cannot pass "${$n(f)}" as a ${this.name}`),f.$$.ptr||ne(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&f.$$.ptrType.isConst&&ne(`Cannot convert argument of type ${f.$$.smartPtrType?f.$$.smartPtrType.name:f.$$.ptrType.name} to parameter type ${this.name}`);var E=f.$$.ptrType.registeredClass;if(v=_n(f.$$.ptr,E,this.registeredClass),this.isSmartPointer)switch(f.$$.smartPtr===void 0&&ne("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:f.$$.smartPtrType===this?v=f.$$.smartPtr:ne(`Cannot convert argument of type ${f.$$.smartPtrType?f.$$.smartPtrType.name:f.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:v=f.$$.smartPtr;break;case 2:if(f.$$.smartPtrType===this)v=f.$$.smartPtr;else{var b=f.clone();v=this.rawShare(v,Se.toHandle(()=>b.delete())),l!==null&&l.push(this.rawDestructor,v)}break;default:ne("Unsupporting sharing policy")}return v}function rl(l,f){if(f===null)return this.isReference&&ne(`null is not a valid ${this.name}`),0;f.$$||ne(`Cannot pass "${$n(f)}" as a ${this.name}`),f.$$.ptr||ne(`Cannot pass deleted object as a pointer of type ${this.name}`),f.$$.ptrType.isConst&&ne(`Cannot convert argument of type ${f.$$.ptrType.name} to parameter type ${this.name}`);var v=f.$$.ptrType.registeredClass,E=_n(f.$$.ptr,v,this.registeredClass);return E}var nl=()=>{Object.assign(zr.prototype,{getPointee(l){return this.rawGetPointee&&(l=this.rawGetPointee(l)),l},destructor(l){this.rawDestructor?.(l)},argPackAdvance:st,readValueFromPointer:or,fromWireType:Xc})};function zr(l,f,v,E,b,N,P,O,B,z,H){this.name=l,this.registeredClass=f,this.isReference=v,this.isConst=E,this.isSmartPointer=b,this.pointeeType=N,this.sharingPolicy=P,this.rawGetPointee=O,this.rawConstructor=B,this.rawShare=z,this.rawDestructor=H,!b&&f.baseClass===void 0?E?(this.toWireType=el,this.destructorFunction=null):(this.toWireType=rl,this.destructorFunction=null):this.toWireType=tl}var Qs=(l,f,v)=>{n.hasOwnProperty(l)||Br("Replacing nonexistent public symbol"),n[l].overloadTable!==void 0&&v!==void 0?n[l].overloadTable[v]=f:(n[l]=f,n[l].argCount=v)},sl=(l,f,v)=>{l=l.replace(/p/g,"i");var E=n["dynCall_"+l];return E(f,...v)},hr=[],Mt,kr=l=>{var f=hr[l];return f||(l>=hr.length&&(hr.length=l+1),hr[l]=f=Mt.get(l)),f},il=(l,f,v=[])=>{if(l.includes("j"))return sl(l,f,v);var E=kr(f)(...v);return l[0]=="p"?E>>>0:E},ei=(l,f)=>(...v)=>il(l,f,v),Ye=(l,f)=>{l=Ne(l);function v(){return l.includes("j")||l.includes("p")?ei(l,f):kr(f)}var E=v();return typeof E!="function"&&ne(`unknown function pointer with signature ${l}: ${f}`),E},al=(l,f)=>{var v=Xt(f,function(E){this.name=f,this.message=E;var b=new Error(E).stack;b!==void 0&&(this.stack=this.toString()+`
`+b.replace(/^Error(:[^\n]*)?\n/,""))});return v.prototype=Object.create(l.prototype),v.prototype.constructor=v,v.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},v},ti,ri=l=>{var f=hi(l),v=Ne(f);return ft(f),v},Gr=(l,f)=>{var v=[],E={};function b(N){if(!E[N]&&!yt[N]){if(Lr[N]){Lr[N].forEach(b);return}v.push(N),E[N]=!0}}throw f.forEach(b),new ti(`${l}: `+v.map(ri).join([", "]))};function ol(l,f,v,E,b,N,P,O,B,z,H,Z,se){l>>>=0,f>>>=0,v>>>=0,E>>>=0,b>>>=0,N>>>=0,P>>>=0,O>>>=0,B>>>=0,z>>>=0,H>>>=0,Z>>>=0,se>>>=0,H=Ne(H),N=Ye(b,N),O&&=Ye(P,O),z&&=Ye(B,z),se=Ye(Z,se);var Ie=Zc(H);bn(Ie,function(){Gr(`Cannot construct ${H} due to unbound types`,[E])}),Tt([l,f,v],E?[E]:[],xe=>{xe=xe[0];var Je,Ze;E?(Je=xe.registeredClass,Ze=Je.instancePrototype):Ze=jr.prototype;var A=Xt(H,function(...Te){if(Object.getPrototypeOf(this)!==S)throw new Wt("Use 'new' to construct "+H);if(F.constructor_body===void 0)throw new Wt(H+" has no accessible constructor");var ze=F.constructor_body[Te.length];if(ze===void 0)throw new Wt(`Tried to invoke ctor of ${H} with invalid number of parameters (${Te.length}) - expected (${Object.keys(F.constructor_body).toString()}) parameters instead!`);return ze.apply(this,Te)}),S=Object.create(Ze,{constructor:{value:A}});A.prototype=S;var F=new Qc(H,A,S,se,Je,N,O,z);F.baseClass&&(F.baseClass.__derivedClasses??=[],F.baseClass.__derivedClasses.push(F));var k=new zr(H,F,!0,!1,!1),K=new zr(H+"*",F,!1,!1,!1),me=new zr(H+" const*",F,!1,!0,!1);return Js[l]={pointerType:K,constPointerType:me},Qs(Ie,A),[k,K,me]})}var Sn=(l,f)=>{for(var v=[],E=0;E<l;E++)v.push(L[f+E*4>>>2>>>0]);return v};function ni(l){for(var f=1;f<l.length;++f)if(l[f]!==null&&l[f].destructorFunction===void 0)return!0;return!1}function si(l,f){if(!(l instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof l} which is not a function`);var v=Xt(l.name||"unknownFunctionName",function(){});v.prototype=l.prototype;var E=new v,b=l.apply(E,f);return b instanceof Object?b:E}function cl(l,f,v,E){for(var b=ni(l),N=l.length,P="",O="",B=0;B<N-2;++B)P+=(B!==0?", ":"")+"arg"+B,O+=(B!==0?", ":"")+"arg"+B+"Wired";var z=`
        return function (${P}) {
        if (arguments.length !== ${N-2}) {
          throwBindingError('function ' + humanName + ' called with ' + arguments.length + ' arguments, expected ${N-2}');
        }`;b&&(z+=`var destructors = [];
`);var H=b?"destructors":"null",Z=["humanName","throwBindingError","invoker","fn","runDestructors","retType","classParam"];f&&(z+="var thisWired = classParam['toWireType']("+H+`, this);
`);for(var B=0;B<N-2;++B)z+="var arg"+B+"Wired = argType"+B+"['toWireType']("+H+", arg"+B+`);
`,Z.push("argType"+B);if(f&&(O="thisWired"+(O.length>0?", ":"")+O),z+=(v||E?"var rv = ":"")+"invoker(fn"+(O.length>0?", ":"")+O+`);
`,b)z+=`runDestructors(destructors);
`;else for(var B=f?1:2;B<l.length;++B){var se=B===1?"thisWired":"arg"+(B-2)+"Wired";l[B].destructorFunction!==null&&(z+=`${se}_dtor(${se});
`,Z.push(`${se}_dtor`))}return v&&(z+=`var ret = retType['fromWireType'](rv);
return ret;
`),z+=`}
`,[Z,z]}function Cn(l,f,v,E,b,N){var P=f.length;P<2&&ne("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var O=f[1]!==null&&v!==null,B=ni(f),z=f[0].name!=="void",H=[l,ne,E,b,Rn,f[0],f[1]],Z=0;Z<P-2;++Z)H.push(f[Z+2]);if(!B)for(var Z=O?1:2;Z<f.length;++Z)f[Z].destructorFunction!==null&&H.push(f[Z].destructorFunction);let[se,Ie]=cl(f,O,z,N);se.push(Ie);var xe=si(Function,se)(...H);return Xt(l,xe)}var ll=function(l,f,v,E,b,N){l>>>=0,v>>>=0,E>>>=0,b>>>=0,N>>>=0;var P=Sn(f,v);b=Ye(E,b),Tt([],[l],O=>{O=O[0];var B=`constructor ${O.name}`;if(O.registeredClass.constructor_body===void 0&&(O.registeredClass.constructor_body=[]),O.registeredClass.constructor_body[f-1]!==void 0)throw new Wt(`Cannot register multiple constructors with identical number of parameters (${f-1}) for class '${O.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return O.registeredClass.constructor_body[f-1]=()=>{Gr(`Cannot construct ${O.name} due to unbound types`,P)},Tt([],P,z=>(z.splice(1,0,null),O.registeredClass.constructor_body[f-1]=Cn(B,z,null,b,N),[])),[]})},ii=l=>{l=l.trim();const f=l.indexOf("(");return f!==-1?l.substr(0,f):l},fl=function(l,f,v,E,b,N,P,O,B){l>>>=0,f>>>=0,E>>>=0,b>>>=0,N>>>=0,P>>>=0;var z=Sn(v,E);f=Ne(f),f=ii(f),N=Ye(b,N),Tt([],[l],H=>{H=H[0];var Z=`${H.name}.${f}`;f.startsWith("@@")&&(f=Symbol[f.substring(2)]),O&&H.registeredClass.pureVirtualFunctions.push(f);function se(){Gr(`Cannot call ${Z} due to unbound types`,z)}var Ie=H.registeredClass.instancePrototype,xe=Ie[f];return xe===void 0||xe.overloadTable===void 0&&xe.className!==H.name&&xe.argCount===v-2?(se.argCount=v-2,se.className=H.name,Ie[f]=se):(Zs(Ie,f,Z),Ie[f].overloadTable[v-2]=se),Tt([],z,Je=>{var Ze=Cn(Z,Je,H,N,P,B);return Ie[f].overloadTable===void 0?(Ze.argCount=v-2,Ie[f]=Ze):Ie[f].overloadTable[v-2]=Ze,[]}),[]})},Nn=[],lt=[];function On(l){l>>>=0,l>9&&--lt[l+1]===0&&(lt[l]=void 0,Nn.push(l))}var ul=()=>lt.length/2-5-Nn.length,hl=()=>{lt.push(0,1,void 0,1,null,1,!0,1,!1,1),n.count_emval_handles=ul},Se={toValue:l=>(l||ne("Cannot use deleted val. handle = "+l),lt[l]),toHandle:l=>{switch(l){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const f=Nn.pop()||lt.length;return lt[f]=l,lt[f+1]=1,f}}}},pl={name:"emscripten::val",fromWireType:l=>{var f=Se.toValue(l);return On(l),f},toWireType:(l,f)=>Se.toHandle(f),argPackAdvance:st,readValueFromPointer:or,destructorFunction:null};function ai(l){return l>>>=0,nt(l,pl)}var gl=(l,f,v)=>{switch(f){case 1:return v?function(E){return this.fromWireType($[E>>>0])}:function(E){return this.fromWireType(C[E>>>0])};case 2:return v?function(E){return this.fromWireType(j[E>>>1>>>0])}:function(E){return this.fromWireType(V[E>>>1>>>0])};case 4:return v?function(E){return this.fromWireType(q[E>>>2>>>0])}:function(E){return this.fromWireType(L[E>>>2>>>0])};default:throw new TypeError(`invalid integer width (${f}): ${l}`)}};function dl(l,f,v,E){l>>>=0,f>>>=0,v>>>=0,f=Ne(f);function b(){}b.values={},nt(l,{name:f,constructor:b,fromWireType:function(N){return this.constructor.values[N]},toWireType:(N,P)=>P.value,argPackAdvance:st,readValueFromPointer:gl(f,v,E),destructorFunction:null}),bn(f,b)}var qr=(l,f)=>{var v=yt[l];return v===void 0&&ne(`${f} has unknown type ${ri(l)}`),v};function ml(l,f,v){l>>>=0,f>>>=0;var E=qr(l,"enum");f=Ne(f);var b=E.constructor,N=Object.create(E.constructor.prototype,{value:{value:v},constructor:{value:Xt(`${E.name}_${f}`,function(){})}});b.values[v]=N,b[f]=N}var $n=l=>{if(l===null)return"null";var f=typeof l;return f==="object"||f==="array"||f==="function"?l.toString():""+l},vl=(l,f)=>{switch(f){case 4:return function(v){return this.fromWireType(D[v>>>2>>>0])};case 8:return function(v){return this.fromWireType(X[v>>>3>>>0])};default:throw new TypeError(`invalid float width (${f}): ${l}`)}},xl=function(l,f,v){l>>>=0,f>>>=0,v>>>=0,f=Ne(f),nt(l,{name:f,fromWireType:E=>E,toWireType:(E,b)=>b,argPackAdvance:st,readValueFromPointer:vl(f,v),destructorFunction:null})};function yl(l,f,v,E,b,N,P){l>>>=0,v>>>=0,E>>>=0,b>>>=0,N>>>=0;var O=Sn(f,v);l=Ne(l),l=ii(l),b=Ye(E,b),bn(l,function(){Gr(`Cannot call ${l} due to unbound types`,O)},f-1),Tt([],O,B=>{var z=[B[0],null].concat(B.slice(1));return Qs(l,Cn(l,z,null,b,N,P),f-1),[]})}var Tl=(l,f,v)=>{switch(f){case 1:return v?E=>$[E>>>0]:E=>C[E>>>0];case 2:return v?E=>j[E>>>1>>>0]:E=>V[E>>>1>>>0];case 4:return v?E=>q[E>>>2>>>0]:E=>L[E>>>2>>>0];default:throw new TypeError(`invalid integer width (${f}): ${l}`)}};function Ml(l,f,v,E,b){l>>>=0,f>>>=0,v>>>=0,f=Ne(f);var N=H=>H;if(E===0){var P=32-8*v;N=H=>H<<P>>>P}var O=f.includes("unsigned"),B=(H,Z)=>{},z;O?z=function(H,Z){return B(Z,this.name),Z>>>0}:z=function(H,Z){return B(Z,this.name),Z},nt(l,{name:f,fromWireType:N,toWireType:z,argPackAdvance:st,readValueFromPointer:Tl(f,v,E!==0),destructorFunction:null})}function El(l,f,v){l>>>=0,v>>>=0;var E=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],b=E[f];function N(P){var O=L[P>>>2>>>0],B=L[P+4>>>2>>>0];return new b($.buffer,B,O)}v=Ne(v),nt(l,{name:v,fromWireType:N,argPackAdvance:st,readValueFromPointer:N},{ignoreDuplicateRegistrations:!0})}function Rl(l,f){l>>>=0,ai(l)}var wl=(l,f,v,E)=>{if(v>>>=0,!(E>0))return 0;for(var b=v,N=v+E-1,P=0;P<l.length;++P){var O=l.charCodeAt(P);if(O>=55296&&O<=57343){var B=l.charCodeAt(++P);O=65536+((O&1023)<<10)|B&1023}if(O<=127){if(v>=N)break;f[v++>>>0]=O}else if(O<=2047){if(v+1>=N)break;f[v++>>>0]=192|O>>6,f[v++>>>0]=128|O&63}else if(O<=65535){if(v+2>=N)break;f[v++>>>0]=224|O>>12,f[v++>>>0]=128|O>>6&63,f[v++>>>0]=128|O&63}else{if(v+3>=N)break;f[v++>>>0]=240|O>>18,f[v++>>>0]=128|O>>12&63,f[v++>>>0]=128|O>>6&63,f[v++>>>0]=128|O&63}}return f[v>>>0]=0,v-b},Il=(l,f,v)=>wl(l,C,f,v),Al=l=>{for(var f=0,v=0;v<l.length;++v){var E=l.charCodeAt(v);E<=127?f++:E<=2047?f+=2:E>=55296&&E<=57343?(f+=4,++v):f+=3}return f},oi=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,bl=(l,f,v)=>{f>>>=0;for(var E=f+v,b=f;l[b]&&!(b>=E);)++b;if(b-f>16&&l.buffer&&oi)return oi.decode(l.subarray(f,b));for(var N="";f<b;){var P=l[f++];if(!(P&128)){N+=String.fromCharCode(P);continue}var O=l[f++]&63;if((P&224)==192){N+=String.fromCharCode((P&31)<<6|O);continue}var B=l[f++]&63;if((P&240)==224?P=(P&15)<<12|O<<6|B:P=(P&7)<<18|O<<12|B<<6|l[f++]&63,P<65536)N+=String.fromCharCode(P);else{var z=P-65536;N+=String.fromCharCode(55296|z>>10,56320|z&1023)}}return N},_l=(l,f)=>(l>>>=0,l?bl(C,l,f):"");function Sl(l,f){l>>>=0,f>>>=0,f=Ne(f);var v=f==="std::string";nt(l,{name:f,fromWireType(E){var b=L[E>>>2>>>0],N=E+4,P;if(v)for(var O=N,B=0;B<=b;++B){var z=N+B;if(B==b||C[z>>>0]==0){var H=z-O,Z=_l(O,H);P===void 0?P=Z:(P+=String.fromCharCode(0),P+=Z),O=z+1}}else{for(var se=new Array(b),B=0;B<b;++B)se[B]=String.fromCharCode(C[N+B>>>0]);P=se.join("")}return ft(E),P},toWireType(E,b){b instanceof ArrayBuffer&&(b=new Uint8Array(b));var N,P=typeof b=="string";P||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int8Array||ne("Cannot pass non-string to std::string"),v&&P?N=Al(b):N=b.length;var O=Un(4+N+1),B=O+4;if(L[O>>>2>>>0]=N,v&&P)Il(b,B,N+1);else if(P)for(var z=0;z<N;++z){var H=b.charCodeAt(z);H>255&&(ft(B),ne("String has UTF-16 code units that do not fit in 8 bits")),C[B+z>>>0]=H}else for(var z=0;z<N;++z)C[B+z>>>0]=b[z];return E!==null&&E.push(ft,O),O},argPackAdvance:st,readValueFromPointer:or,destructorFunction(E){ft(E)}})}var ci=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Cl=(l,f)=>{for(var v=l,E=v>>1,b=E+f/2;!(E>=b)&&V[E>>>0];)++E;if(v=E<<1,v-l>32&&ci)return ci.decode(C.subarray(l>>>0,v>>>0));for(var N="",P=0;!(P>=f/2);++P){var O=j[l+P*2>>>1>>>0];if(O==0)break;N+=String.fromCharCode(O)}return N},Nl=(l,f,v)=>{if(v??=2147483647,v<2)return 0;v-=2;for(var E=f,b=v<l.length*2?v/2:l.length,N=0;N<b;++N){var P=l.charCodeAt(N);j[f>>>1>>>0]=P,f+=2}return j[f>>>1>>>0]=0,f-E},Ol=l=>l.length*2,$l=(l,f)=>{for(var v=0,E="";!(v>=f/4);){var b=q[l+v*4>>>2>>>0];if(b==0)break;if(++v,b>=65536){var N=b-65536;E+=String.fromCharCode(55296|N>>10,56320|N&1023)}else E+=String.fromCharCode(b)}return E},Fl=(l,f,v)=>{if(f>>>=0,v??=2147483647,v<4)return 0;for(var E=f,b=E+v-4,N=0;N<l.length;++N){var P=l.charCodeAt(N);if(P>=55296&&P<=57343){var O=l.charCodeAt(++N);P=65536+((P&1023)<<10)|O&1023}if(q[f>>>2>>>0]=P,f+=4,f+4>b)break}return q[f>>>2>>>0]=0,f-E},Dl=l=>{for(var f=0,v=0;v<l.length;++v){var E=l.charCodeAt(v);E>=55296&&E<=57343&&++v,f+=4}return f},Pl=function(l,f,v){l>>>=0,f>>>=0,v>>>=0,v=Ne(v);var E,b,N,P;f===2?(E=Cl,b=Nl,P=Ol,N=O=>V[O>>>1>>>0]):f===4&&(E=$l,b=Fl,P=Dl,N=O=>L[O>>>2>>>0]),nt(l,{name:v,fromWireType:O=>{for(var B=L[O>>>2>>>0],z,H=O+4,Z=0;Z<=B;++Z){var se=O+4+Z*f;if(Z==B||N(se)==0){var Ie=se-H,xe=E(H,Ie);z===void 0?z=xe:(z+=String.fromCharCode(0),z+=xe),H=se+f}}return ft(O),z},toWireType:(O,B)=>{typeof B!="string"&&ne(`Cannot pass non-string to C++ string type ${v}`);var z=P(B),H=Un(4+z+f);return L[H>>>2>>>0]=z/f,b(B,H+4,z+f),O!==null&&O.push(ft,H),H},argPackAdvance:st,readValueFromPointer:or,destructorFunction(O){ft(O)}})};function Ul(l,f,v,E,b,N){l>>>=0,f>>>=0,v>>>=0,E>>>=0,b>>>=0,N>>>=0,Ur[l]={name:Ne(f),rawConstructor:Ye(v,E),rawDestructor:Ye(b,N),fields:[]}}function Ll(l,f,v,E,b,N,P,O,B,z){l>>>=0,f>>>=0,v>>>=0,E>>>=0,b>>>=0,N>>>=0,P>>>=0,O>>>=0,B>>>=0,z>>>=0,Ur[l].fields.push({fieldName:Ne(f),getterReturnType:v,getter:Ye(E,b),getterContext:N,setterArgumentType:P,setter:Ye(O,B),setterContext:z})}var Bl=function(l,f){l>>>=0,f>>>=0,f=Ne(f),nt(l,{isVoid:!0,name:f,argPackAdvance:0,fromWireType:()=>{},toWireType:(v,E)=>{}})};function Vl(l,f,v){return l>>>=0,f>>>=0,v>>>=0,C.copyWithin(l>>>0,f>>>0,f+v>>>0)}var li=(l,f,v)=>{var E=[],b=l.toWireType(E,v);return E.length&&(L[f>>>2>>>0]=Se.toHandle(E)),b};function jl(l,f,v){return l>>>=0,f>>>=0,v>>>=0,l=Se.toValue(l),f=qr(f,"emval::as"),li(f,v,l)}var zl={},fi=l=>{var f=zl[l];return f===void 0?Ne(l):f},Fn=[];function kl(l,f,v,E,b){return l>>>=0,f>>>=0,v>>>=0,E>>>=0,b>>>=0,l=Fn[l],f=Se.toValue(f),v=fi(v),l(f,f[v],E,b)}function Gl(l,f){return l>>>=0,f>>>=0,l=Se.toValue(l),f=Se.toValue(f),l==f}var ql=l=>{var f=Fn.length;return Fn.push(l),f},Hl=(l,f)=>{for(var v=new Array(l),E=0;E<l;++E)v[E]=qr(L[f+E*4>>>2>>>0],"parameter "+E);return v};function Wl(l,f,v){f>>>=0;var E=Hl(l,f),b=E.shift();l--;var N=`return function (obj, func, destructorsRef, args) {
`,P=0,O=[];v===0&&O.push("obj");for(var B=["retType"],z=[b],H=0;H<l;++H)O.push("arg"+H),B.push("argType"+H),z.push(E[H]),N+=`  var arg${H} = argType${H}.readValueFromPointer(args${P?"+"+P:""});
`,P+=E[H].argPackAdvance;var Z=v===1?"new func":"func.call";N+=`  var rv = ${Z}(${O.join(", ")});
`,b.isVoid||(B.push("emval_returnValue"),z.push(li),N+=`  return emval_returnValue(retType, destructorsRef, rv);
`),N+=`};
`,B.push(N);var se=si(Function,B)(...z),Ie=`methodCaller<(${E.map(xe=>xe.name).join(", ")}) => ${b.name}>`;return ql(Xt(Ie,se))}function Xl(l,f){return l>>>=0,f>>>=0,l=Se.toValue(l),f=Se.toValue(f),Se.toHandle(l[f])}function Yl(l){l>>>=0,l>9&&(lt[l+1]+=1)}function Kl(l){return l>>>=0,Se.toHandle(fi(l))}function Jl(){return Se.toHandle({})}function Zl(l){l>>>=0;var f=Se.toValue(l);Rn(f),On(l)}function Ql(l,f,v){l>>>=0,f>>>=0,v>>>=0,l=Se.toValue(l),f=Se.toValue(f),v=Se.toValue(v),l[f]=v}function ef(l,f){l>>>=0,f>>>=0,l=qr(l,"_emval_take_value");var v=l.readValueFromPointer(f);return Se.toHandle(v)}var tf=()=>4294901760,rf=l=>{var f=_.buffer,v=(l-f.byteLength+65535)/65536;try{return _.grow(v),te(),1}catch{}};function nf(l){l>>>=0;var f=C.length,v=tf();if(l>v)return!1;for(var E=(B,z)=>B+(z-B%z)%z,b=1;b<=4;b*=2){var N=f*(1+.2/b);N=Math.min(N,l+100663296);var P=Math.min(v,E(Math.max(l,N),65536)),O=rf(P);if(O)return!0}return!1}var ui=(l,f)=>{l<128?f.push(l):f.push(l%128|128,l>>7)},sf=l=>{for(var f={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},v={parameters:[],results:l[0]=="v"?[]:[f[l[0]]]},E=1;E<l.length;++E)v.parameters.push(f[l[E]]);return v},af=(l,f)=>{var v=l.slice(0,1),E=l.slice(1),b={i:127,p:127,j:126,f:125,d:124,e:111};f.push(96),ui(E.length,f);for(var N=0;N<E.length;++N)f.push(b[E[N]]);v=="v"?f.push(0):f.push(1,b[v])},of=(l,f)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(sf(f),l);var v=[1];af(f,v);var E=[0,97,115,109,1,0,0,0,1];ui(v.length,E),E.push(...v),E.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var b=new WebAssembly.Module(new Uint8Array(E)),N=new WebAssembly.Instance(b,{e:{f:l}}),P=N.exports.f;return P},cf=(l,f)=>{if(Et)for(var v=l;v<l+f;v++){var E=kr(v);E&&Et.set(E,v)}},Et,lf=l=>(Et||(Et=new WeakMap,cf(0,Mt.length)),Et.get(l)||0),Dn=[],ff=()=>{if(Dn.length)return Dn.pop();try{Mt.grow(1)}catch(l){throw l instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":l}return Mt.length-1},Pn=(l,f)=>{Mt.set(l,f),hr[l]=Mt.get(l)},pr=(l,f)=>{var v=lf(l);if(v)return v;var E=ff();try{Pn(E,l)}catch(N){if(!(N instanceof TypeError))throw N;var b=of(l,f);Pn(E,b)}return Et.set(l,E),E},gr=l=>{Et.delete(kr(l)),Pn(l,null),Dn.push(l)};Hs=n.InternalError=class extends Error{constructor(f){super(f),this.name="InternalError"}},Uc(),Wt=n.BindingError=class extends Error{constructor(f){super(f),this.name="BindingError"}},Yc(),qc(),nl(),ti=n.UnboundTypeError=al(Error,"UnboundTypeError"),hl();var uf={r:$c,D:Fc,s:Dc,C:Pc,H:Bc,o:ol,n:ll,a:fl,G:ai,y:dl,h:ml,A:xl,d:yl,p:Ml,g:El,q:Rl,z:Sl,x:Pl,t:Ul,i:Ll,I:Bl,F:Vl,v:jl,k:kl,b:On,u:Gl,l:Wl,f:Xl,w:Yl,c:Kl,B:Jl,j:Zl,m:Ql,e:ef,E:nf},Ke=Nc(),hi=l=>(hi=Ke.L)(l),Un=l=>(Un=Ke.N)(l),ft=l=>(ft=Ke.O)(l),pi=l=>(pi=Ke.P)(l);function hf(l){l=Object.assign({},l);var f=E=>b=>E(b)>>>0,v=E=>()=>E()>>>0;return l.L=f(l.L),l.N=f(l.N),l._emscripten_stack_alloc=f(l._emscripten_stack_alloc),l.emscripten_stack_get_current=v(l.emscripten_stack_get_current),l}n.addFunction=pr,n.removeFunction=gr;var Hr;Fe=function l(){Hr||gi(),Hr||(Fe=l)};function gi(){if(be>0||(ae(),be>0))return;function l(){Hr||(Hr=!0,n.calledRun=!0,!U&&(oe(),s(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),le()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),l()},1)):l()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return gi(),r=a,r}})();const ot="EXT_mesh_manifold",ki="MERGE";class js extends we{static EXTENSION_NAME=ot;init(){js.EXTENSION_NAME=ot,this.propertyType="ManifoldPrimitive",this.parentTypes=[G.MESH]}getDefaults(){return Object.assign(super.getDefaults(),{manifoldPrimitive:null,mergeIndices:null,mergeValues:null})}getMergeIndices(){return this.getRef("mergeIndices")}getMergeValues(){return this.getRef("mergeValues")}setMerge(e,r){if(e.getCount()!==r.getCount())throw new Error("merge vectors must be the same length.");return this.setRef("mergeIndices",e),this.setRef("mergeValues",r)}getRunIndex(){return this.get("runIndex")}setRunIndex(e){return this.set("runIndex",e)}setIndices(e){return this.setRef("indices",e)}getIndices(){return this.getRef("indices")}}class yc extends ge{extensionName=ot;prewriteTypes=[G.ACCESSOR];static EXTENSION_NAME=ot;createManifoldPrimitive(){return new js(this.document.getGraph())}read(e){const{json:r}=e.jsonDoc;return(r.meshes||[]).forEach((s,i)=>{if(!s.extensions||!s.extensions[ot])return;const a=e.meshes[i],o=this.createManifoldPrimitive();a.setExtension(ot,o);const c=s.extensions[ot];if(c.manifoldPrimitive){let u=0;const h=Array();h.push(u);for(const d of a.listPrimitives()){const m=d.getIndices();if(!m){console.log("Skipping non-indexed primitive ",d.getName());continue}u+=m.getCount(),h.push(u)}o.setRunIndex(h),o.setIndices(e.accessors[c.manifoldPrimitive.indices])}c.mergeIndices!=null&&c.mergeValues!=null&&o.setMerge(e.accessors[c.mergeIndices],e.accessors[c.mergeValues])}),this}prewrite(e){return this.document.getRoot().listMeshes().forEach(r=>{const n=r.getExtension(ot);if(!n)return;const s=n.getIndices();e.addAccessorToUsageGroup(s,et.BufferViewUsage.ELEMENT_ARRAY_BUFFER);const i=n.getMergeIndices(),a=n.getMergeValues();!i||!a||(e.addAccessorToUsageGroup(i,ki),e.addAccessorToUsageGroup(a,ki))}),this}write(e){const{json:r}=e.jsonDoc;return this.document.getRoot().listMeshes().forEach(n=>{const s=n.getExtension(ot);if(!s)return;const i=e.meshIndexMap.get(n),a=r.meshes[i],o=s.getRunIndex(),c=o.length-1;if(c!==a.primitives.length)throw new Error("The number of primitives must be exactly one less than the length of runIndex.");const u=e.accessorIndexMap.get(s.getMergeIndices()),h=e.accessorIndexMap.get(s.getMergeValues()),d=r.accessors[u],m=r.accessors[h],x=a.primitives[0],M={indices:e.accessorIndexMap.get(s.getIndices()),mode:x.mode,attributes:{POSITION:x.attributes.POSITION}},w=r.accessors[M.indices];if(w){d&&m&&(w.sparse={count:d.count,indices:{bufferView:d.bufferView,byteOffset:d.byteOffset,componentType:d.componentType},values:{bufferView:m.bufferView,byteOffset:m.byteOffset}});for(let p=0;p<c;++p){const R=r.accessors[a.primitives[p].indices];R.bufferView=w.bufferView,R.byteOffset=w.byteOffset+4*o[p],R.count=o[p+1]-o[p]}a.extensions=a.extensions||{},a.extensions[ot]={manifoldPrimitive:M,mergeIndices:u,mergeValues:h}}}),this}}const xr={POSITION:{type:Y.Type.VEC3,components:3},NORMAL:{type:Y.Type.VEC3,components:3},TANGENT:{type:Y.Type.VEC4,components:4},TEXCOORD_0:{type:Y.Type.VEC2,components:2},TEXCOORD_1:{type:Y.Type.VEC2,components:2},COLOR_0:{type:Y.Type.VEC3,components:3},JOINTS_0:{type:Y.Type.VEC4,components:4},WEIGHTS_0:{type:Y.Type.VEC4,components:4},SKIP_1:{type:null,components:1},SKIP_2:{type:null,components:2},SKIP_3:{type:null,components:3},SKIP_4:{type:null,components:4}};function o0(t){return t.registerExtensions([yc])}function Gi(t,e,r){t.getRoot().listBuffers().length===0&&t.createBuffer();const n=t.getRoot().listBuffers()[0],s=t.createExtension(yc),i=t.createMesh(),a=Array(),o=Array(),c=new Map,u=e.runIndex.length-1;let h=-1;for(let y=0;y<u;++y){const T=e.runOriginalID[y];if(T==h)continue;h=T,a.push(e.runIndex[y]);const I=t.createAccessor("primitive indices of ID "+T).setBuffer(n).setType(Y.Type.SCALAR).setArray(new Uint32Array(1)),_=t.createPrimitive().setIndices(I),U=r.get(T);if(U){const{material:$,attributes:C}=U;if(C.length<1||C[0]!=="POSITION")throw new Error('First attribute must be "POSITION".');_.setMaterial($),c.set(_,C),U.attributes.forEach((j,V)=>{if(V>=o.length)o.push(j);else{const q=xr[j].components,L=xr[o[V]].components;if(q!=L)throw new Error("Attribute sizes do not correspond: "+j+" and "+o[V]);xr[o[V]].type==null&&(o[V]=j)}})}else c.set(_,["POSITION"]);i.addPrimitive(_)}a.push(e.runIndex[u]);const d=e.numVert,m=e.numProp;let x=0;o.forEach((y,T)=>{const I=xr[y];if(I==null)throw new Error(y+" is not a recognized attribute.");if(I.type==null){++x;return}const _=I.components;if(x+_>m)throw new Error("Too many attribute channels.");const U=new Float32Array(_*d);for(let C=0;C<d;++C)for(let j=0;j<_;++j){let V=e.vertProperties[m*C+x+j];y=="COLOR_0"&&(V=Math.max(0,Math.min(1,V))),U[_*C+j]=V}const $=t.createAccessor(y).setBuffer(n).setType(I.type).setArray(U);for(const C of i.listPrimitives()){const j=c.get(C);j.length>T&&xr[j[T]].type!=null&&C.setAttribute(y,$)}x+=_});const M=s.createManifoldPrimitive();i.setExtension("EXT_mesh_manifold",M);const w=t.createAccessor("manifold indices").setBuffer(n).setType(Y.Type.SCALAR).setArray(e.triVerts);M.setIndices(w),M.setRunIndex(a);const p=[...Array(e.numVert).keys()],R=Array(),g=Array();if(e.mergeFromVert&&e.mergeToVert){for(const[y,T]of e.mergeFromVert.entries())p[T]=e.mergeToVert[y];for(const[y,T]of e.triVerts.entries()){const I=p[T];T!==I&&(R.push(y),g.push(I))}}if(R.length>0){const y=t.createAccessor("merge from").setBuffer(n).setType(Y.Type.SCALAR).setArray(new Uint32Array(R)),T=t.createAccessor("merge to").setBuffer(n).setType(Y.Type.SCALAR).setArray(new Uint32Array(g));M.setMerge(y,T)}return i}const We=await a0();We.setup();ao(Array);const Tc=o0(new Pf);Tc.registerExtensions(Ya);const c0=["cube","cylinder","sphere","tetrahedron","extrude","revolve","compose","union","difference","intersection","levelSet","smooth","ofMesh","hull"],l0=["add","subtract","intersect","decompose","warp","transform","translate","rotate","scale","mirror","calculateCurvature","calculateNormals","smoothByNormals","smoothOut","refine","refineToLength","refineToTolerance","setProperties","setTolerance","asOriginal","trimByPlane","split","splitByPlane","slice","project","hull"],f0=["square","circle","union","difference","intersection","compose","ofPolygons","hull"],u0=["add","subtract","intersect","rectClip","decompose","transform","translate","rotate","scale","mirror","simplify","offset","hull"],Mc=["show","only","setMaterial"],h0=["setMinCircularAngle","setMinCircularEdgeLength","setCircularSegments","getCircularSegments","resetToCircularDefaults","Mesh","GLTFNode","Manifold","CrossSection","setMorphStart","setMorphEnd"],p0=Mc.concat(h0),hn=new Array;function Tn(t,e,r){const n=We[t],s=r?n:n.prototype;for(const i of e){const a=s[i];s[i]=function(...o){const c=a(...o);return hn.push(c),c}}}Tn("Manifold",l0,!1);Tn("Manifold",c0,!0);Tn("CrossSection",u0,!1);Tn("CrossSection",f0,!0);for(const t of Mc){const e=We[t];We[t]=function(...r){const n=e(...r);return hn.push(n),n}}let zs=!1;const pn=new Map,ks=new Map,g0=30,Ec={roughness:.2,metallic:1,baseColorFactor:[1,1,0],alpha:1,unlit:!1,animationLength:1,animationMode:"loop"},d0={baseColorFactor:[1,0,0],alpha:.25,roughness:1,metallic:0},m0={baseColorFactor:[.5,.5,.5],alpha:.25,roughness:1,metallic:0},Ut=new Array,gn=new Map,rn=new Map,Vt=new Map,zt=new Map;let Fr=1,tr,Cr,Gn,nn,dn;function v0(){for(const t of hn)if(t instanceof Array)for(const e of t)e.delete();else t.delete();hn.length=0,zs=!1,pn.clear(),ks.clear(),Ut.length=0,gn.clear(),rn.clear(),Vt.clear(),zt.clear(),Fr=1}class x0{_parent;manifold;translation;rotation;scale;material;name;constructor(e){this._parent=e,Ut.push(this)}clone(e){const r={...this};return r._parent=e,Ut.push(r),r}get parent(){return this._parent}}We.GLTFNode=x0;const Dt={...Ec};We.setMaterial=(t,e)=>{const r=t.asOriginal();return gn.set(r.originalID(),e),r};We.setMorphStart=(t,e)=>{const r=zt.get(t);r!=null?r.start=e:zt.set(t,{start:e})};We.setMorphEnd=(t,e)=>{const r=zt.get(t);r!=null?r.end=e:zt.set(t,{end:e})};function Rc(t,e){let r=t.asOriginal();return e.set(r.originalID(),r.getMesh()),r}We.show=t=>Rc(t,pn);We.only=t=>(zs=!0,Rc(t,ks));function Qt(...t){typeof self<"u"&&self.console&&self.console.log(...t)}function wc(t){const{quat:e}=xc,r=Math.PI/180,n=e.create();return e.rotateZ(n,n,r*t[2]),e.rotateY(n,n,r*t[1]),e.rotateX(n,n,r*t[0]),n}function qn(t,e,r,n){const s=r[e];if(s==null)return null;if(typeof s!="function")return s;const i=Cr.getCount(),a=e=="rotation"?4:3,o=new Float32Array(a*i);for(let d=0;d<i;++d){const m=d/(i-1),x=s(Dt.animationMode!=="ping-pong"?m:(1-Math.cos(m*2*Math.PI))/2);o.set(a===4?wc(x):x,a*d)}const c=t.createAccessor(r.name+" "+e+" frames").setBuffer(t.getRoot().listBuffers()[0]).setArray(o).setType(a===4?Y.Type.VEC4:Y.Type.VEC3),u=t.createAnimationSampler().setInput(Cr).setOutput(c).setInterpolation("LINEAR"),h=t.createAnimationChannel().setTargetPath(e).setTargetNode(n).setSampler(u);return tr.addSampler(u),tr.addChannel(h),dn=!0,s(0)}function y0(t,e,r){if(zt.has(r)){const n=t.createAnimationChannel().setTargetPath("weights").setTargetNode(e).setSampler(nn);tr.addChannel(n),dn=!0}}function T0(t,e){const r=[];if(e==null)return r;for(let n=0;n<t.numVert;++n)for(let s=0;s<3;++s)r[n*3+s]=t.vertProperties[n*t.numProp+s];if(e.start)for(let n=0;n<t.numVert;++n){const s=t.vertProperties,i=n*t.numProp,a=r.slice(i,i+3);e.start(a);for(let o=0;o<3;++o)s[i+o]=a[o]}return r}function M0(t,e,r,n,s){s!=null&&(r.setWeights([0]),r.listPrimitives().forEach((i,a)=>{if(s.end)for(let m=0;m<e.numVert;++m){const x=n.slice(3*m,3*(m+1));s.end(x),n.splice(3*m,3,...x)}const o=i.getAttribute("POSITION").getArray(),c=new Float32Array(o.length),u=e.runIndex[a];for(let m=0;m<c.length;++m)c[m]=n[u+m]-o[m];const h=t.createAccessor(r.getName()+" morph target").setBuffer(t.getRoot().listBuffers()[0]).setArray(c).setType(Y.Type.VEC3),d=t.createPrimitiveTarget().setAttribute("POSITION",h);i.addTarget(d)}))}function E0(t,e){const r=t.createNode(e.name),n=qn(t,"translation",e,r);n!=null&&r.setTranslation(n);const s=qn(t,"rotation",e,r);s!=null&&r.setRotation(wc(s));const i=qn(t,"scale",e,r);return i!=null&&r.setScale(i),r}function Ic(t){return t==null?{}:(t.material==null&&(t.material=Ic(t.parent)),t.material)}function R0(t,e={}){const r={...Dt};Object.assign(r,e);const{roughness:n,metallic:s,baseColorFactor:i,alpha:a,unlit:o}=r,c=t.createMaterial(e.name??"");if(o){const u=t.createExtension(_s).createUnlit();c.setExtension("KHR_materials_unlit",u)}return a<1&&c.setAlphaMode(ir.AlphaMode.BLEND).setDoubleSided(!0),c.setRoughnessFactor(n).setMetallicFactor(s).setBaseColorFactor([...i,a])}function mn(t,e){return rn.has(e)||rn.set(e,R0(t,e)),rn.get(e)}function Ac(t,e,r,n,s={}){const i=n.numTri();if(i==0){Qt("Empty manifold, skipping.");return}Qt(`Triangles: ${i.toLocaleString()}`);const a=n.boundingBox(),o=[0,0,0];for(let w=0;w<3;w++)o[w]=Math.round((a.max[w]-a.min[w])*10)/10;Qt(`Bounding Box: X = ${o[0].toLocaleString()} mm, Y = ${o[1].toLocaleString()} mm, Z = ${o[2].toLocaleString()} mm`);const c=Math.round(n.volume()/10);Qt(`Genus: ${n.genus().toLocaleString()}, Volume: ${(c/100).toLocaleString()} cm^3`);const u=n.getMesh(),h=new Map;for(const w of u.runOriginalID){const p=gn.get(w)||s;h.set(w,{material:mn(t,zs?m0:p),attributes:["POSITION",...p.attributes??[]]})}const d=zt.get(n),m=T0(u,d),x=Gi(t,u,h);x.setName(r.getName()),r.setMesh(x),M0(t,u,x,m,d);const M=u.numProp===3?u.vertProperties:new Float32Array(u.numVert*3);if(u.numProp>3)for(let w=0;w<u.numVert;++w)for(let p=0;p<3;++p)M[w*3+p]=u.vertProperties[w*u.numProp+p];Vt.set(n,Fr),e.meshes.push({vertices:M,indices:u.triVerts,id:`${Fr++}`});for(const[w,p]of u.runOriginalID.entries()){const R=pn.has(p),g=R?pn.get(p):ks.get(p);if(g==null)continue;h.get(p).material=mn(t,R?d0:gn.get(p)||s);const y=t.createNode("debug").setMesh(Gi(t,g,h)).setMatrix(u.transform(w));r.addChild(y)}}function bc(t,e){t.setMesh(e.getMesh()),e.listChildren().forEach(r=>{const n=r.clone();t.addChild(n)})}function w0(t,e,r,n,s){bc(e,r);const i=t.createMesh();e.setMesh(i),r.getMesh().listPrimitives().forEach(a=>{const o=a.clone();a.getMaterial()===s&&o.setMaterial(n),i.addPrimitive(o)})}function I0(t,e,r,n){const s=E0(t,r),{manifold:i}=r;if(i!=null){y0(t,s,i);const a=Ic(r),o=n.get(i);if(o==null){Ac(t,e,s,i,a);const c=new Map;c.set(a,s),n.set(i,c)}else{const c=o.get(a);if(c==null){const[u,h]=o.entries().next().value;w0(t,s,h,mn(t,a),mn(t,u)),o.set(a,s)}else bc(s,c)}}return Vt.set(r,Fr),e.components.push({id:`${Fr++}`,name:r.name,children:i==null?[]:[{objectID:`${Vt.get(i)}`}]}),s}async function _c(t,e){Object.assign(Dt,Ec),Object.assign(Dt,t);const r=new ps,n=Math.sqrt(2)/2,s=1/1e3,i=r.createNode("wrapper").setRotation([-n,0,0,n]).setScale([s,s,s]);r.createScene().addChild(i),tr=r.createAnimation(""),dn=!1;const a=Math.round(Dt.animationLength*g0)+1,o=new Float32Array(a),c=new Float32Array(a);for(let R=0;R<a;++R){const g=R/(a-1);o[R]=g*Dt.animationLength,c[R]=Dt.animationMode!=="ping-pong"?g:(1-Math.cos(g*2*Math.PI))/2}Cr=r.createAccessor("animation times").setBuffer(r.createBuffer()).setArray(o).setType(Y.Type.SCALAR),Gn=r.createAccessor("animation weights").setBuffer(r.getRoot().listBuffers()[0]).setArray(c).setType(Y.Type.SCALAR),nn=r.createAnimationSampler().setInput(Cr).setOutput(Gn).setInterpolation("LINEAR"),tr.addSampler(nn);const u={meshes:[],components:[],items:[],precision:7,header:{unit:"millimeter",title:"ManifoldCAD.org model",description:"ManifoldCAD.org model",application:"ManifoldCAD.org"}};if(Ut.length>0){const R=new Map,g=new Map;let y=0;for(const T of Ut)R.set(T,I0(r,u,T,g)),T.manifold&&++y;for(const T of Ut){const I=R.get(T),_={objectID:`${Vt.get(T)}`,transform:I.getMatrix()},{parent:U}=T;U==null?(i.addChild(I),u.items.push(_)):(R.get(U).addChild(I),u.components.find(C=>C.id==`${Vt.get(U)}`).children.push(_))}Qt("Total glTF nodes: ",Ut.length,", Total mesh references: ",y)}else{if(e==null){Qt('No output because "result" is undefined and no "GLTFNode"s were created.');return}const R=r.createNode();Ac(r,u,R,e),i.addChild(R),u.items.push({objectID:`${Vt.get(e)}`})}dn||(Cr.dispose(),Gn.dispose(),nn.dispose(),tr.dispose());const h=await Tc.writeBinary(r),d=new Blob([h],{type:"application/octet-stream"}),m=new $u;m.add3dModel("3D/3dmodel.model");const x=Ou(u),M={};M["3D/3dmodel.model"]=Sr(x),M[Pi.name]=Sr(Pi.content),M[m.name]=Sr(m.content);const w=Xu(M),p=new Blob([w],{type:"application/vnd.ms-package.3dmanufacturing-3dmodel+xml"});return{glbURL:URL.createObjectURL(d),threeMFURL:URL.createObjectURL(p)}}function A0(t){const e={},r={globalDefaults:e,exportModels:_c,glMatrix:xc,module:We,...Object.fromEntries(p0.map(i=>[i,We[i]]))},s=new Function(...Object.keys(r),`resetToCircularDefaults();
`+t+`
 return typeof result === "undefined" ? undefined : result;`)(...Object.values(r));return{globalDefaults:e,manifold:s}}async function b0(t){const{globalDefaults:e,manifold:r}=A0(t);return await _c(e,r)}self.postMessage(null);if(self.console){const t=self.console.log;self.console.log=function(...e){let r="";for(const n of e)n==null?r+="undefined":typeof n=="object"?r+=JSON.stringify(n,null,4):r+=n.toString();self.postMessage({log:r}),t(...e)}}self.onmessage=async t=>{try{const e=await b0(t.data);self.postMessage(e)}catch(e){console.log(e.toString()),self.postMessage({objectURL:null})}finally{v0()}};
//# sourceMappingURL=worker-wrapper-1fdc9088.js.map
